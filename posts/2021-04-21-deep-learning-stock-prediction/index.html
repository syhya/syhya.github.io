<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning | Yue Shui Blog</title>
<meta name=keywords content="Deep learning,AI,RNN,LSTM,BiLSTM,GRU,LightGBM,Neural Networks,Stock Prediction,Financial Modeling,Machine Learning,Quantitative Investment,Portfolio Management,Financial Engineering,Algorithmic Trading,Time Series"><meta name=description content="Abstract
The stock market is a crucial component of the financial market. In recent years, the stock market has flourished, attracting researchers from various fields to study stock price prediction and quantitative investment strategies. With the development of artificial intelligence and machine learning in recent years, scholars have transitioned from traditional statistical models to AI algorithms. Particularly, after the surge of deep learning, neural networks have achieved commendable results in stock price prediction and quantitative investment strategy research. The goal of deep learning is to learn multi-level features by combining low-level features to construct abstract high-level features, thereby mining the distributed feature representations of data and performing complex nonlinear modeling based on this to accomplish prediction tasks. Among these, RNNs are widely applied to sequential data such as natural language and speech. Daily stock prices and trading information are sequential data; therefore, many researchers have previously used RNNs to predict stock prices. However, basic recurrent neural networks suffer from the vanishing gradient problem when the number of layers is too large, a problem that the emergence of LSTM solved. Subsequently, variants of LSTM such as GRU, Peephole LSTM, and BiLSTM appeared. Traditional stock prediction models often overlook the temporal factors or only consider unidirectional temporal relationships. Therefore, this paper employs the BiLSTM model for stock price prediction. From a theoretical perspective, the BiLSTM model fully utilizes the contextual relationships in both forward and backward temporal directions in time series, avoiding the vanishing and exploding gradient problems in long sequences, and better learning information with long-term dependencies."><meta name=author content="Yue Shui"><link rel=canonical href=https://syhya.github.io/posts/2021-04-21-deep-learning-stock-prediction/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.9271b00776af10d7feb512a59a411af859df11a64bb143b10ab1170a4e8da23f.css integrity="sha256-knGwB3avENf+tRKlmkEa+FnfEaZLsUOxCrEXCk6Noj8=" rel="preload stylesheet" as=style><link rel=icon href=https://syhya.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://syhya.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://syhya.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://syhya.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://syhya.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://syhya.github.io/posts/2021-04-21-deep-learning-stock-prediction/><link rel=alternate hreflang=zh href=https://syhya.github.io/zh/posts/2021-04-21-deep-learning-stock-prediction/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.19/dist/katex.min.css integrity=sha384-7lU0muIg/i1plk7MgygDUp3/bNRA65orrBub4/OSWHECgwEsY83HaS1x3bljA/XV crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.19/dist/katex.min.js integrity=sha384-RdymN7NRJ+XoyeRY4185zXaxq9QWOOx3O7beyyrRK4KQZrPlCDQQpCu95FoCGPAE crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.19/dist/contrib/auto-render.min.js integrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-SZ2660B91F"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SZ2660B91F")}</script><meta property="og:url" content="https://syhya.github.io/posts/2021-04-21-deep-learning-stock-prediction/"><meta property="og:site_name" content="Yue Shui Blog"><meta property="og:title" content="Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning"><meta property="og:description" content="Abstract The stock market is a crucial component of the financial market. In recent years, the stock market has flourished, attracting researchers from various fields to study stock price prediction and quantitative investment strategies. With the development of artificial intelligence and machine learning in recent years, scholars have transitioned from traditional statistical models to AI algorithms. Particularly, after the surge of deep learning, neural networks have achieved commendable results in stock price prediction and quantitative investment strategy research. The goal of deep learning is to learn multi-level features by combining low-level features to construct abstract high-level features, thereby mining the distributed feature representations of data and performing complex nonlinear modeling based on this to accomplish prediction tasks. Among these, RNNs are widely applied to sequential data such as natural language and speech. Daily stock prices and trading information are sequential data; therefore, many researchers have previously used RNNs to predict stock prices. However, basic recurrent neural networks suffer from the vanishing gradient problem when the number of layers is too large, a problem that the emergence of LSTM solved. Subsequently, variants of LSTM such as GRU, Peephole LSTM, and BiLSTM appeared. Traditional stock prediction models often overlook the temporal factors or only consider unidirectional temporal relationships. Therefore, this paper employs the BiLSTM model for stock price prediction. From a theoretical perspective, the BiLSTM model fully utilizes the contextual relationships in both forward and backward temporal directions in time series, avoiding the vanishing and exploding gradient problems in long sequences, and better learning information with long-term dependencies."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-04-21T12:00:00+08:00"><meta property="article:modified_time" content="2021-04-21T12:00:00+08:00"><meta property="article:tag" content="Deep Learning"><meta property="article:tag" content="AI"><meta property="article:tag" content="RNN"><meta property="article:tag" content="LSTM"><meta property="article:tag" content="BiLSTM"><meta property="article:tag" content="GRU"><meta property="og:image" content="https://syhya.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://syhya.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning"><meta name=twitter:description content="Abstract
The stock market is a crucial component of the financial market. In recent years, the stock market has flourished, attracting researchers from various fields to study stock price prediction and quantitative investment strategies. With the development of artificial intelligence and machine learning in recent years, scholars have transitioned from traditional statistical models to AI algorithms. Particularly, after the surge of deep learning, neural networks have achieved commendable results in stock price prediction and quantitative investment strategy research. The goal of deep learning is to learn multi-level features by combining low-level features to construct abstract high-level features, thereby mining the distributed feature representations of data and performing complex nonlinear modeling based on this to accomplish prediction tasks. Among these, RNNs are widely applied to sequential data such as natural language and speech. Daily stock prices and trading information are sequential data; therefore, many researchers have previously used RNNs to predict stock prices. However, basic recurrent neural networks suffer from the vanishing gradient problem when the number of layers is too large, a problem that the emergence of LSTM solved. Subsequently, variants of LSTM such as GRU, Peephole LSTM, and BiLSTM appeared. Traditional stock prediction models often overlook the temporal factors or only consider unidirectional temporal relationships. Therefore, this paper employs the BiLSTM model for stock price prediction. From a theoretical perspective, the BiLSTM model fully utilizes the contextual relationships in both forward and backward temporal directions in time series, avoiding the vanishing and exploding gradient problems in long sequences, and better learning information with long-term dependencies."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://syhya.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning","item":"https://syhya.github.io/posts/2021-04-21-deep-learning-stock-prediction/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning","name":"Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning","description":"Abstract The stock market is a crucial component of the financial market. In recent years, the stock market has flourished, attracting researchers from various fields to study stock price prediction and quantitative investment strategies. With the development of artificial intelligence and machine learning in recent years, scholars have transitioned from traditional statistical models to AI algorithms. Particularly, after the surge of deep learning, neural networks have achieved commendable results in stock price prediction and quantitative investment strategy research. The goal of deep learning is to learn multi-level features by combining low-level features to construct abstract high-level features, thereby mining the distributed feature representations of data and performing complex nonlinear modeling based on this to accomplish prediction tasks. Among these, RNNs are widely applied to sequential data such as natural language and speech. Daily stock prices and trading information are sequential data; therefore, many researchers have previously used RNNs to predict stock prices. However, basic recurrent neural networks suffer from the vanishing gradient problem when the number of layers is too large, a problem that the emergence of LSTM solved. Subsequently, variants of LSTM such as GRU, Peephole LSTM, and BiLSTM appeared. Traditional stock prediction models often overlook the temporal factors or only consider unidirectional temporal relationships. Therefore, this paper employs the BiLSTM model for stock price prediction. From a theoretical perspective, the BiLSTM model fully utilizes the contextual relationships in both forward and backward temporal directions in time series, avoiding the vanishing and exploding gradient problems in long sequences, and better learning information with long-term dependencies.\n","keywords":["Deep learning","AI","RNN","LSTM","BiLSTM","GRU","LightGBM","Neural Networks","Stock Prediction","Financial Modeling","Machine Learning","Quantitative Investment","Portfolio Management","Financial Engineering","Algorithmic Trading","Time Series"],"articleBody":"Abstract The stock market is a crucial component of the financial market. In recent years, the stock market has flourished, attracting researchers from various fields to study stock price prediction and quantitative investment strategies. With the development of artificial intelligence and machine learning in recent years, scholars have transitioned from traditional statistical models to AI algorithms. Particularly, after the surge of deep learning, neural networks have achieved commendable results in stock price prediction and quantitative investment strategy research. The goal of deep learning is to learn multi-level features by combining low-level features to construct abstract high-level features, thereby mining the distributed feature representations of data and performing complex nonlinear modeling based on this to accomplish prediction tasks. Among these, RNNs are widely applied to sequential data such as natural language and speech. Daily stock prices and trading information are sequential data; therefore, many researchers have previously used RNNs to predict stock prices. However, basic recurrent neural networks suffer from the vanishing gradient problem when the number of layers is too large, a problem that the emergence of LSTM solved. Subsequently, variants of LSTM such as GRU, Peephole LSTM, and BiLSTM appeared. Traditional stock prediction models often overlook the temporal factors or only consider unidirectional temporal relationships. Therefore, this paper employs the BiLSTM model for stock price prediction. From a theoretical perspective, the BiLSTM model fully utilizes the contextual relationships in both forward and backward temporal directions in time series, avoiding the vanishing and exploding gradient problems in long sequences, and better learning information with long-term dependencies.\nThe first part of this paper’s experiment establishes stock prediction models using LSTM, GRU, and BiLSTM based on stock data from China’s Shanghai Pudong Development Bank and the foreign company IBM, respectively. By comparing the prediction results of these three deep learning models, it was found that the BiLSTM model outperforms the other models on both datasets, achieving higher prediction accuracy. The second part uses stock data from the entire A-share market and first applies the LightGBM model to screen 50 factors, selecting the top 10 most important factors. Subsequently, the BiLSTM model is used to select and combine these factors to establish a quantitative investment strategy. Finally, empirical tests and backtesting demonstrate that this strategy outperforms the market benchmark index, illustrating the practical application value of the BiLSTM model in stock price prediction and quantitative investment.\nKeywords: Quantitative Investment; Deep Learning; Neural Network Models; Multi-Factor Stock Selection; BiLSTM\nChapter 1: Introduction 1.1 Research Background and Significance 1.1.1 Research Background Since its gradual emergence in the 1970s, quantitative investment has entered the view of various investors, initiating a new revolution that changed the previously dominated landscape of passive management and the Efficient Market Hypothesis (EMH) in portfolio management. The EMH posits that under the premise of market efficiency, stock prices reflect all available information, and no excess returns exist. Passive investment management is based on the belief that markets are efficient, focusing more on asset classes. The most common method is purchasing index funds and tracking the performance of published indices. In contrast, active investment management primarily relies on investors’ subjective judgments about the market and individual stocks, using publicly available data and applying mathematical models in the financial field to evaluate stocks and construct investment portfolios to achieve returns. Quantitative investment, which involves statistical processing of large amounts of historical data to uncover investment opportunities and eliminate subjective factors, has been increasingly favored by investors. Since the rise of quantitative investment, various technologies have been employed to predict stock prices better and establish quantitative investment strategies. Early scholars domestically and internationally used statistical methods for modeling stock price prediction, such as the moving average method, multiple regression, and autoregressive integrated moving average (ARIMA) models. However, due to the numerous factors influencing the stock market and the large volume of data, stock prediction is highly challenging, and the predictive performance of these statistical models is often unsatisfactory.\nIn recent years, related technologies like machine learning, deep learning, and neural networks have continuously developed, providing technical support for stock price prediction and the construction of quantitative strategies. Many scholars have achieved breakthroughs using methods such as random forests, neural networks, support vector machines, and convolutional neural networks. The ample historical data in the stock market, combined with diverse technical support, provides favorable conditions for stock price prediction and the construction of quantitative strategies.\n1.1.2 Research Significance From the perspective of the national economic system and the long-term development of financial markets, research on stock price prediction models and quantitative investment strategies is indispensable. China started relatively late, and its financial markets are not yet mature, with insufficient financial instruments and lower market efficiency. However, in recent years, the government has gradually relaxed policies and vigorously developed financial markets, providing a “fertile ground” for the development of quantitative investment and emerging financial technologies. Developing quantitative investment and new financial technologies can offer opportunities for China’s financial markets to achieve leapfrog growth. Moreover, stock price indices, as important economic indicators, act as barometers for China’s economic development.\nFrom the perspective of individual and institutional investors, constructing stock price prediction models and quantitative investment strategy models enhances market efficiency. Individual investors often lack sufficient professional knowledge, leading to somewhat blind investment behaviors. Constructing relevant models to provide references can reduce the probability of judgment errors and change the relatively disadvantaged position of individual investors in the capital market. For institutional investors, rational and objective models combined with personal judgment improve decision accuracy and provide new directions for investment activities.\nIn summary, considering China’s current development status, this paper selects individual stocks for stock price prediction models and the entire A-share market for quantitative strategy research, which holds significant practical research significance.\n1.2 Literature Review White (1988)$^{[1]}$ used BP neural networks to predict IBM’s daily returns. However, due to the BP neural network model being susceptible to gradient explosion, the model could not converge to the global minimum, resulting in inaccurate predictions.\nKimoto (1990)$^{[2]}$ developed a system for forecasting the Tokyo Stock Exchange Prices Indexes (TOPIX) using modular neural network technology. The system not only successfully predicted TOPIX but also achieved a certain level of profitability through simulated stock trading based on the prediction results.\nG. Peter Zhang (2003)$^{[3]}$ conducted a comparative study on the performance of the Autoregressive Integrated Moving Average (ARIMA) model and the Artificial Neural Network (ANN) model in time series forecasting. The results showed that the ANN model significantly outperformed the ARIMA model in time series prediction accuracy.\nRyo Akita (2016)$^{[4]}$ selected consumer price indices, price-earnings ratios, and various events from newspapers as features. Using paragraph vectors and LSTM networks, a financial time series prediction model was constructed. Empirical data from fifty listed companies on the Tokyo Stock Exchange validated the model’s effectiveness in predicting stock opening prices.\nKunihiro Miyazaki (2017)$^{[5]}$ constructed a model for predicting the rise and fall of the Topix Core 30 index and its constituent stocks by extracting daily stock chart images and 30-minute stock price data. The study compared various models, including Logistic Regression (LR), Random Forest (RF), Multilayer Perceptron (MLP), LSTM, CNN, PCA-CNN, and CNN-LSTM. The results indicated that LSTM had the best predictive performance, CNN performed moderately, and hybrid models combining CNN and LSTM could enhance prediction accuracy.\nTaewook Kim (2019)$^{[6]}$ proposed a hybrid LSTM-CNN model that combines features from stock price time series and stock price images to predict the S\u0026P 500 index. The study demonstrated that the LSTM-CNN model outperformed single models in stock price prediction and that such predictions hold practical significance for constructing quantitative investment strategies.\n1.3 Innovations of the Paper This paper presents the following innovations in stock prediction:\nDiverse Market Data Usage: It separately uses data from China’s A-share Shanghai Pudong Development Bank and the foreign stock IBM, avoiding the limitations of studying a single market. Traditional BP models have never considered temporal factors, and models like LSTM only consider unidirectional temporal relationships. Therefore, this paper employs the BiLSTM model for stock price prediction. Theoretically, the BiLSTM model fully utilizes contextual relationships in both forward and backward temporal directions in time series, avoiding the vanishing and exploding gradient problems in long sequences, and better learning information with long-term dependencies. Empirical comparisons with LSTM and GRU models demonstrate its ability to enhance prediction accuracy.\nMulti-Feature Stock Price Prediction: The stock price prediction model trains on multiple features, including opening price, closing price, highest price, and trading volume. Compared to single-feature prediction of closing prices, this approach is theoretically more accurate and better facilitates the comparison of prediction effects among LSTM, GRU, and BiLSTM models.\nIn terms of quantitative strategy research, this paper presents the following innovations:\nCustom Factor Selection: Instead of using commonly available market factors, it employs multiple price and volume factors derived through Genetic Programming (GP) and manual data mining. The LightGBM model is then used to select the top 10 most important factors from an initial set of 50 factors.\nBiLSTM-Based Factor Combination: Traditional quantitative investment models generally use LSTM and CNN models to build investment strategies. This paper utilizes data from the entire A-share market and employs the BiLSTM model for factor combination to establish a quantitative investment strategy. Empirical tests and backtesting show that this strategy outperforms the market benchmark index (CSI All Share Index), indicating the practical application value of the BiLSTM model in stock price prediction and quantitative investment.\n1.4 Research Framework This paper conducts stock price prediction and quantitative strategy research based on deep learning algorithms. The specific research framework is shown in Fig. 1:\nFig. 1. Research Framework.\nThe specific research framework content is as follows:\nChapter 1: Introduction. This chapter first introduces the research significance and background of stock price prediction and quantitative strategy research. It then reviews the current research status, outlines the innovations of this paper compared to existing research, and briefly describes the research framework.\nChapter 2: Theoretical Foundations. This chapter introduces the deep learning models and the fundamental theories of quantitative stock selection involved in this research. The subsection on deep learning models sequentially introduces RNN, LSTM, GRU, and BiLSTM, with a focus on the internal structure of the LSTM model. The subsection on quantitative stock selection theory sequentially introduces the Mean-Variance Model, Capital Asset Pricing Model (CAPM), Arbitrage Pricing Theory (APT), Multi-Factor Models, and the Fama-French Three-Factor and Five-Factor Models. This subsection outlines the development of multi-factor quantitative stock selection from various financial theories and model development trajectories.\nChapter 3: Comparative Study of LSTM, GRU, and BiLSTM in Stock Price Prediction. This chapter first introduces the domestic and foreign stock datasets used in the experiments, followed by data normalization and preprocessing steps. It then describes the network structures, model compilation, and hyperparameter settings of the LSTM, GRU, and BiLSTM models used in this chapter, and presents experimental results. Finally, it analyzes the experimental results and concludes the chapter.\nChapter 4: Research on LightGBM-BiLSTM-Based Quantitative Investment Models. This chapter first provides an overview of the experimental steps, followed by a detailed introduction of the stock and factor data used in the experiments. It then performs factor cleaning steps, including handling missing values, outlier removal, factor normalization, and factor neutralization. Subsequently, it uses the LightGBM model for factor selection and the BiLSTM model for factor combination. Finally, it constructs a quantitative investment strategy based on the obtained models and conducts backtesting.\nChapter 5: Conclusion and Outlook. This chapter summarizes the main research content regarding stock price prediction and quantitative investment strategies. It then discusses the current research limitations and provides prospects for future research directions.\nChapter 2: Theoretical Foundations 2.1 Deep Learning Models 2.1.1 RNN Recurrent Neural Networks (RNNs) are widely applied to sequential data such as natural language and speech. Daily stock prices and trading information are sequential data; therefore, many previous studies have used RNNs to predict stock prices. RNNs employ a simple repetitive module in a chain-like structure, such as a single tanh layer. However, basic RNNs encounter the vanishing gradient problem when the number of layers becomes too large, a problem that the emergence of LSTM resolved. Fig. 2 is the RNN structure diagram.\nFig. 2. RNN Structure Diagram. (Image source: Understanding LSTM Networks)\n2.1.2 LSTM Long Short-Term Memory (LSTM) networks are a special type of RNN capable of learning long-term dependencies. They were proposed by Hochreiter \u0026 Schmidhuber (1997)$^{[7]}$ and have been improved and popularized by many subsequent works. Due to their unique design structure, LSTMs are relatively insensitive to sequence length and solve the vanishing and exploding gradient problems inherent in traditional RNNs. Compared to traditional RNNs and other time series models like Hidden Markov Models (HMMs), LSTMs can better handle and predict significant events in time series with long intervals and delays. Consequently, LSTMs are widely used in machine translation and speech recognition fields.\nLSTMs are explicitly designed to avoid the long-term dependency problem. All recurrent neural networks have a chain-like structure of repeated network modules, whereas LSTMs modify the RNN structure. Instead of using a single neural network layer, LSTMs use a special four-layer structure that interacts in a unique way.\nFig. 3. LSTM Structure Diagram 1. (Image source: Understanding LSTM Networks)\nFig. 4. LSTM Structure Diagram 2. (Image source: Understanding LSTM Networks)\nAs shown in Fig. 3, the black lines represent the transmission of a node’s output vector to another node’s input vector. The Neural Network Layer is a processing module with a $\\sigma$ activation function or tanh activation function; Pointwise Operation represents element-wise multiplication between vectors; Vector Transfer indicates the direction of information transmission; Concatenate and Copy are represented by two black lines merging together and separating, respectively, indicating the merging and copying of information.\nBelow, we detail the structure of an LSTM using the following components:\nForget Gate Fig. 5. Forget Gate Calculation (Image source: Understanding LSTM Networks)\n$$ f_{t} = \\sigma\\left(W_{f} \\cdot \\left[h_{t-1}, x_{t}\\right] + b_{f}\\right) $$Parameter Description:\n$h_{t-1}$: Output from the previous time step $x_{t}$: Input at the current time step $\\sigma$: Sigmoid activation function $W_{f}$: Weight matrix for the forget gate $b_{f}$: Bias vector parameter for the forget gate The first step, as shown in Fig. 5, is the process of deciding which information to discard from the cell state. This is determined by computing $f_{t}$ using the sigmoid function (where $f_{t}$ ranges between 0 and 1, with 0 meaning completely blocked and 1 meaning completely passed) to decide whether to allow the previous cell state $C_{t-1}$ to pass through or be partially allowed.\nInput Gate Fig. 6. Input Gate Calculation (Image source: Understanding LSTM Networks)\n$$ \\begin{aligned} i_{t} \u0026= \\sigma\\left(W_{i} \\cdot \\left[h_{t-1}, x_{t}\\right] + b_{i}\\right) \\\\ \\tilde{C}_{t} \u0026= \\tanh\\left(W_{C} \\cdot \\left[h_{t-1}, x_{t}\\right] + b_{C}\\right) \\end{aligned} $$Parameter Description:\n$h_{t-1}$: Output from the previous time step $x_{t}$: Input at the current time step $\\sigma$: Sigmoid activation function $W_{i}$: Weight matrix for the input gate $b_{i}$: Bias vector parameter for the input gate $W_{C}$: Weight matrix for the cell state $b_{C}$: Bias vector parameter for the cell state $\\tanh$: Tanh activation function The second step, as shown in Fig. 6, involves using the sigmoid function to determine what information to store in the cell state. Subsequently, a $\\tanh$ layer creates the candidate vector $\\tilde{C}_{t}$, which will be added to the cell state.\nFig. 7. Current Cell State Calculation (Image source: Understanding LSTM Networks)\n$$ C_{t} = f_{t} * C_{t-1} + i_{t} * \\tilde{C}_{t} $$Parameter Description:\n$C_{t-1}$: Cell state from the previous time step $\\tilde{C}_{t}$: Candidate cell state $i_{t}$: Value of the input gate $f_{t}$: Value of the forget gate The third step, as shown in Fig. 7, calculates the current cell state $C_t$ by combining the effects of the forget gate and the input gate.\nThe forget gate $f_t$ weights the previous cell state $C_{t-1}$ to discard unnecessary information. The input gate $i_t$ weights the candidate cell state $\\tilde{C}_t$ to determine how much new information to introduce. Finally, the two parts are added together to update the current cell state $C_t$. Output Gate Fig. 8. Output Gate Calculation (Image source: Understanding LSTM Networks)\n$$ \\begin{aligned} o_{t} \u0026= \\sigma\\left(W_{o} \\cdot \\left[h_{t-1}, x_{t}\\right] + b_{o}\\right) \\\\ h_{t} \u0026= o_{t} * \\tanh\\left(C_{t}\\right) \\end{aligned} $$Parameter Description:\n$o_{t}$: Value of the output gate $\\sigma$: Sigmoid activation function $W_{o}$: Weight matrix for the output gate $h_{t-1}$: Output from the previous time step $x_{t}$: Input at the current time step $b_{o}$: Bias vector parameter for the output gate $h_{t}$: Output at the current time step $\\tanh$: Tanh activation function $C_{t}$: Current cell state The fourth step, as shown in Fig. 8, uses the sigmoid function to calculate the output gate’s value. Finally, the cell state $C_t$ at this time step is processed through the tanh activation function and multiplied by the output gate’s value $o_t$ to obtain the current output $h_t$.\n2.1.3 GRU K. Cho (2014)$^{[8]}$ proposed the Gated Recurrent Unit (GRU). GRU primarily simplifies and adjusts LSTM by merging LSTM’s original forget gate, input gate, and output gate into an update gate and a reset gate. Additionally, GRU combines the cell state with the hidden state, reducing model complexity while still achieving performance comparable to LSTM on certain tasks.\nThis model can save considerable time when training on larger datasets and demonstrates better performance on some smaller and less frequent datasets$^{[9][10]}$.\nFig. 9. GRU Structure Diagram (Image source: Understanding LSTM Networks)\n$$ \\begin{aligned} z_{t} \u0026= \\sigma\\left(W_{z} \\cdot \\left[h_{t-1}, x_{t}\\right]\\right) \\\\ r_{t} \u0026= \\sigma\\left(W_{r} \\cdot \\left[h_{t-1}, x_{t}\\right]\\right) \\\\ \\tilde{h}_{t} \u0026= \\tanh\\left(W \\cdot \\left[r_{t} * h_{t-1}, x_{t}\\right]\\right) \\\\ h_{t} \u0026= \\left(1 - z_{t}\\right) * h_{t-1} + z_{t} * \\tilde{h}_{t} \\end{aligned} $$Parameter Description:\n$z_{t}$: Value of the update gate $r_{t}$: Value of the reset gate $W_{z}$: Weight matrix for the update gate $W_{r}$: Weight matrix for the reset gate $\\tilde{h}_{t}$: Candidate hidden state 2.1.4 BiLSTM Bidirectional Long Short-Term Memory (BiLSTM) networks combine forward and backward LSTMs. The BiLSTM model fully utilizes the contextual relationships in both forward and backward temporal directions in time series, enabling the learning of information with long-term dependencies. Compared to unidirectional LSTM, BiLSTM can better consider the reverse influence of future data. Fig. 10 is the BiLSTM structure diagram.\nFig. 10. BiLSTM Structure Diagram. (Image source: Baeldung)\n2.2 Quantitative Stock Selection Theory 2.2.1 Mean-Variance Model The quantitative stock selection strategy originated in the 1950s when Markowitz (1952)$^{[11]}$ proposed the Mean-Variance Model. This model not only laid the foundation for modern portfolio theory by quantifying investment risk but also established a specific model describing risk and expected return. It broke the previous situation of only qualitative analysis of portfolios without quantitative analysis, successfully introducing mathematical models into the financial investment field.\n$$ \\begin{aligned} \\mathrm{E}\\left(R_{p}\\right) \u0026= \\sum_{i=1}^{n} w_{i} \\mathrm{E}\\left(R_{i}\\right) \\\\ \\sigma_{p}^{2} \u0026= \\sum_{i=1}^{n} \\sum_{j=1}^{n} w_{i} w_{j} \\operatorname{Cov}\\left(R_{i}, R_{j}\\right) = \\sum_{i=1}^{n} \\sum_{j=1}^{n} w_{i} w_{j} \\sigma_{i} \\sigma_{j} \\rho_{ij} \\\\ \\sigma_{i} \u0026= \\sqrt{\\operatorname{Var}\\left(R_{i}\\right)}, \\quad \\rho_{ij} = \\operatorname{Corr}\\left(R_{i}, R_{j}\\right) \\end{aligned} $$$$ \\min \\sigma_{p}^{2} \\quad \\text{subject to} \\quad \\sum_{i=1}^{n} \\mathrm{E}\\left(R_{i}\\right) w_{i} = \\mu_{p}, \\quad \\sum_{i=1}^{n} w_{i} = 1 $$$$ \\begin{aligned} \\Omega \u0026= \\begin{pmatrix} \\sigma_{11} \u0026 \\cdots \u0026 \\sigma_{1n} \\\\ \\vdots \u0026 \\ddots \u0026 \\vdots \\\\ \\sigma_{n1} \u0026 \\cdots \u0026 \\sigma_{nn} \\end{pmatrix} = \\begin{pmatrix} \\operatorname{Var}\\left(R_{1}\\right) \u0026 \\cdots \u0026 \\operatorname{Cov}\\left(R_{1}, R_{n}\\right) \\\\ \\vdots \u0026 \\ddots \u0026 \\vdots \\\\ \\operatorname{Cov}\\left(R_{n}, R_{1}\\right) \u0026 \\cdots \u0026 \\operatorname{Var}\\left(R_{n}\\right) \\end{pmatrix} \\\\ \\Omega^{-1} \u0026= \\begin{pmatrix} v_{11} \u0026 \\cdots \u0026 v_{1n} \\\\ \\vdots \u0026 \\ddots \u0026 \\vdots \\\\ v_{n1} \u0026 \\cdots \u0026 v_{nn} \\end{pmatrix} \\\\ w_{i} \u0026= \\frac{1}{D}\\left(\\mu_{p} \\sum_{j=1}^{n} v_{ij}\\left(C \\mathrm{E}\\left(R_{j}\\right) - A\\right) + \\sum_{j=1}^{n} v_{ij}\\left(B - A \\mathrm{E}\\left(R_{j}\\right)\\right)\\right), \\quad i = 1, \\ldots, n \\end{aligned} $$$$ \\begin{aligned} A \u0026= \\sum_{i=1}^{n} \\sum_{j=1}^{n} v_{ij} \\mathrm{E}\\left(R_{j}\\right), \\quad B = \\sum_{i=1}^{n} \\sum_{j=1}^{n} v_{ij} \\mathrm{E}\\left(R_{i}\\right) \\mathrm{E}\\left(R_{j}\\right), \\quad C = \\sum_{i=1}^{n} \\sum_{j=1}^{n} v_{ij}, \\quad D = BC - A^{2} \u003e 0 \\\\ \\sigma_{p}^{2} \u0026= \\frac{C \\mu_{p}^{2} - 2A \\mu_{p} + B}{D} \\end{aligned} $$Where:\n$\\mathrm{E}\\left(R_{p}\\right)$ and $\\mu_{p}$ are the expected return of portfolio $p$ $\\mathrm{E}\\left(R_{i}\\right)$ is the expected return of asset $i$ $\\sigma_{i}$ is the standard deviation of asset $i$ $\\sigma_{j}$ is the standard deviation of asset $j$ $w_{i}$ is the weight of asset $i$ in the portfolio $\\sigma_{p}^{2}$ is the variance of portfolio $p$ $\\rho_{ij}$ is the correlation coefficient between assets $i$ and $j$ Using the above formulas$^{[12]}$, we can construct an investment portfolio that minimizes non-systematic risk under a given expected return condition.\n2.2.2 Capital Asset Pricing Model William Sharpe (1964)$^{[13]}$, John Lintner (1965)$^{[14]}$, and Jan Mossin (1966)$^{[15]}$ proposed the Capital Asset Pricing Model (CAPM). This model posits that the expected return of an asset is related to its risk measure, the $\\beta$ value. The model connects the expected return rate of an asset with market risk through a simple linear relationship, making Markowitz’s (1952) portfolio selection theory more applicable to the real world and laying the theoretical foundation for multi-factor stock selection models.\nAccording to the CAPM, for a given asset $i$, the relationship between its expected return and the expected return of the market portfolio can be expressed as:\n$$ E\\left(r_{i}\\right) = r_{f} + \\beta_{im}\\left[E\\left(r_{m}\\right) - r_{f}\\right] $$Where:\n$E\\left(r_{i}\\right)$ is the expected return of asset $i$ $r_{f}$ is the risk-free rate $\\beta_{im}$ (Beta) is the systematic risk coefficient of asset $i$, $\\beta_{im} = \\frac{\\operatorname{Cov}\\left(r_{i}, r_{m}\\right)}{\\operatorname{Var}\\left(r_{m}\\right)}$ $E\\left(r_{m}\\right)$ is the expected return of the market portfolio $m$ $E\\left(r_{m}\\right) - r_{f}$ is the market risk premium factor 2.2.3 Arbitrage Pricing Theory and Multi-Factor Models Ross (1976)$^{[16]}$ proposed the Arbitrage Pricing Theory (APT). This theory asserts that arbitrage activities are the decisive factor in forming market equilibrium prices. By introducing a series of factors into the process of return formation and constructing linear relationships, APT overcomes the limitations of the Capital Asset Pricing Model (CAPM) and provides important theoretical guidance for subsequent researchers.\nAPT is considered the theoretical foundation of Multi-Factor Models (MFM), an essential component of asset pricing models and one of the cornerstones of asset pricing theory. The general expression of a multi-factor model is:\n$$ r_{j} = a_{j} + \\lambda_{j1} f_{1} + \\lambda_{j2} f_{2} + \\cdots + \\lambda_{jn} f_{n} + \\delta_{j} $$Where:\n$r_{j}$ is the return of asset $j$ $a_{j}$ is the constant term for asset $j$ $f_{n}$ are the systematic factors $\\lambda_{jn}$ are the factor loadings $\\delta_{j}$ is the random error 2.2.4 Fama-French Three-Factor and Five-Factor Models Fama (1992) and French (1992)$^{[17]}$ discovered through cross-sectional regressions combined with time series analysis that a stock’s $\\beta$ value cannot explain the differences in returns among different stocks. However, factors such as a company’s market capitalization, book-to-market ratio, and price-earnings ratio can significantly explain the differences in stock returns. They concluded that excess returns compensate for risk factors not captured by the $\\beta$ in CAPM, leading to the Fama-French Three-Factor Model. These three factors are:\nMarket Risk Premium Factor\nRepresents the overall systematic risk of the market, calculated as the expected return of the market portfolio minus the risk-free rate. Measures the excess return investors expect for taking on systematic risk (risk that cannot be eliminated through diversification). Calculation formula:\n$$ \\text{Market Risk Premium} = E(R_m) - R_f $$ where $E(R_m)$ is the expected return of the market, and $R_f$ is the risk-free rate. Size Factor (SMB: Small Minus Big)\nRepresents the return difference between small-cap and large-cap stocks. Small-cap stocks generally carry higher risk but historically show higher expected returns than large-cap stocks. Calculation formula:\n$$ SMB = R_{\\text{Small}} - R_{\\text{Big}} $$ Reflects the market’s compensation for the additional risk premium of small-cap stocks. Book-to-Market Ratio Factor (HML: High Minus Low)\nReflects the return difference between high book-to-market (value) stocks and low book-to-market (growth) stocks. High book-to-market stocks are typically undervalued by the market but may offer higher returns in the long run. Calculation formula:\n$$ HML = R_{\\text{High}} - R_{\\text{Low}} $$ Low book-to-market stocks may be overvalued due to the market’s overly optimistic expectations. This model specifies the factors in the APT model and concludes that investing in small-cap and high-growth stocks exhibits high-risk and high-return characteristics. The Fama-French Three-Factor Model is widely applied in modern investment behavior analysis and practice.\nSubsequently, Fama (2015) and French (2015)$^{[18]}$ expanded the three-factor model by adding two more factors:\nProfitability Factor (RMW: Robust Minus Weak)\nReflects the return difference between high-profitability and low-profitability companies. Companies with strong profitability (high ROE, net profit margin) are more likely to provide stable and higher returns. Calculation formula:\n$$ RMW = R_{\\text{Robust}} - R_{\\text{Weak}} $$ Investment Factor (CMA: Conservative Minus Aggressive)\nReflects the return difference between conservative and aggressive investment companies. Aggressive companies (rapid expansion, high capital expenditure) usually carry greater operational risks, while conservative companies (steady capital expenditure) exhibit higher stability and returns. Calculation formula:\n$$ CMA = R_{\\text{Conservative}} - R_{\\text{Aggressive}} $$ The Fama-French Three-Factor Model formula is:\n$$ R_i - R_f = \\alpha_i + \\beta_{i,m} \\cdot (R_m - R_f) + \\beta_{i,SMB} \\cdot SMB + \\beta_{i,HML} \\cdot HML + \\epsilon_i $$The Fama-French Five-Factor Model formula is:\n$$ R_i - R_f = \\alpha_i + \\beta_{i,m} \\cdot (R_m - R_f) + \\beta_{i,SMB} \\cdot SMB + \\beta_{i,HML} \\cdot HML + \\beta_{i,RMW} \\cdot RMW + \\beta_{i,CMA} \\cdot CMA + \\epsilon_i $$Where:\n$R_i$: Expected return of stock $i$ $R_f$: Risk-free rate $R_m$: Expected return of the market portfolio $R_m - R_f$: Market risk premium factor $SMB$: Size factor (Small Minus Big) $HML$: Book-to-market ratio factor (High Minus Low) $RMW$: Profitability factor (Robust Minus Weak) $CMA$: Investment factor (Conservative Minus Aggressive) $\\beta_{i,*}$: Sensitivity of stock $i$ to the corresponding factor $\\epsilon_i$: Regression residual 2.2.5 Model Comparison Tables Table 2.1: Comparison of Models The following table summarizes the core content and factor sources of the Mean-Variance Model, Capital Asset Pricing Model (CAPM), Arbitrage Pricing Theory (APT), and Fama-French Models:\nModel Core Content Factor Sources Mean-Variance Model Foundation of portfolio theory, optimizing portfolios through expected returns and covariance matrices. Expected returns and covariance matrices of portfolio assets Capital Asset Pricing Model (CAPM) Explains asset returns through market risk factor ($\\beta$), laying the theoretical foundation for multi-factor models. Market factor $\\beta$ Arbitrage Pricing Theory (APT) Multi-factor framework allowing multiple economic variables (e.g., inflation rate, interest rate) to explain asset returns. Multiple factors (macroeconomic variables like inflation rate, interest rate) Fama-French Three-Factor Model Enhances asset return explanation by adding size and book-to-market ratio factors. Market factor, SMB (Size factor), HML (Book-to-Market ratio factor) Fama-French Five-Factor Model Further improves asset pricing by adding profitability and investment factors on top of the three-factor model. Market factor, SMB, HML, RMW (Profitability factor), CMA (Investment factor) The following table summarizes the advantages and disadvantages of these models:\nTable 2.2: Comparison of Model Advantages and Disadvantages Model Advantages Disadvantages Mean-Variance Model Provides a systematic method for portfolio optimization, laying the foundation for modern investment theory. Optimizes only for returns and variance, without explicitly identifying sources of risk compensation. Capital Asset Pricing Model (CAPM) Simple to use, connects return differences to market risk, providing a theoretical foundation for multi-factor models. Assumes a single factor (market risk) determines returns, ignoring other systematic risk factors. Arbitrage Pricing Theory (APT) Allows multiple factors to explain asset returns, reducing reliance on single-factor assumptions and offering greater flexibility. Does not specify specific factors, making it less practical and only providing a framework. Fama-French Three-Factor Model Significantly improves the explanatory power of asset returns by adding size and book-to-market ratio factors. Ignores other factors such as profitability and investment behaviors. Fama-French Five-Factor Model Further enhances asset pricing by incorporating profitability and investment factors, capturing key variables influencing asset returns more comprehensively. Higher model complexity, greater data requirements, and potential omission of certain latent factors. Chapter 3: Comparative Study of LSTM, GRU, and BiLSTM in Stock Price Prediction 3.1 Introduction of Experimental Data Many domestic and foreign studies focus primarily on their own stock indices, with relatively few studies examining individual stocks from different markets. Moreover, few studies have compared the performance of LSTM, GRU, and BiLSTM models. Therefore, this paper selects China’s A-share Shanghai Pudong Development Bank (Pudong Bank, code 600000) and the US stock International Business Machines Corporation (IBM) for research, enabling a more accurate comparison of the three models used. For Pudong Bank, stock data from January 1, 2008, to December 31, 2020, comprising 3,114 valid data points, were sourced from the Tushare Financial Data Platform. The features selected for this dataset include date, opening price, closing price, highest price, lowest price, and trading volume. Except for the date, which serves as the time series index, the other five features are used as independent variables. For IBM, stock data from January 2, 1990, to November 15, 2018, comprising 7,278 valid data points, were sourced from Yahoo Finance. The features selected for this dataset include date, opening price, highest price, lowest price, closing price, adjusted closing price, and trading volume. Except for the date, which serves as the time series index, the other six features are used as independent variables. In this experiment, the closing price is chosen as the target variable. Tables 3.1 and 3.2 display partial data from the two datasets.\nTable 3.1: Partial Display of Pudong Bank Dataset Date Open Close High Low Volume Code 2008-01-02 9.007 9.101 9.356 8.805 131,583.90 600000 2008-01-03 9.007 8.645 9.101 8.426 211,346.56 600000 2008-01-04 8659 9.009 9.111 8.501 139,249.67 600000 2008-01-07 8.970 9.515 9.593 8.953 228,043.01 600000 2008-01-08 9.551 9.583 9.719 9.517 161,255.31 600000 2008-01-09 9.583 9.663 9.772 9.432 102,510.92 600000 2008-01-10 9.701 9.680 9.836 9.602 217,966.25 600000 2008-01-11 9.670 10.467 10.532 9.670 231,544.21 600000 2008-01-14 10.367 10.059 10.433 10.027 142,918.39 600000 2008-01-15 10.142 10.051 10.389 10.006 161,221.52 600000 Data Source: Tushare\nTable 3.2: Partial Display of IBM Dataset Date Open High Low Close Adj Close Volume 1990-01-02 23.6875 24.5313 23.6250 24.5000 6.590755 7,041,600 1990-01-03 24.6875 24.8750 24.5938 24.7188 6.649599 9,464,000 1990-01-04 24.7500 25.0938 24.7188 25.0000 6.725261 9,674,800 1990-01-05 24.9688 25.4063 24.8750 24.9375 6.708448 7,570,000 1990-01-08 24.8125 25.2188 24.8125 25.0938 6.750481 4,625,200 1990-01-09 25.1250 25.3125 24.8438 24.8438 6.683229 7,048,000 1990-01-10 24.8750 25.0000 24.6563 24.7500 6.658009 5,945,600 1990-01-11 24.8750 25.0938 24.8438 24.9688 6.716855 5,905,600 1990-01-12 24.6563 24.8125 24.4063 24.4688 6.582347 5,390,800 1990-01-15 24.4063 24.5938 24.3125 24.5313 6.599163 4,035,600 Data Source: Yahoo Finance\n3.2 Data Preprocessing 3.2.1 Data Normalization In the experiment, different features have varying units and magnitudes. For example, there is a significant magnitude difference between stock prices and trading volumes, which can impact the final prediction results. Therefore, the MinMaxScaler method from the sklearn.preprocessing library is used to scale the data features to the range of 0 to 1. This not only improves model accuracy but also enhances the model’s convergence speed. The normalization formula is:\n$$ x^{\\prime}=\\frac{x-\\min (x)}{\\max (x)-\\min (x)} $$Where $x^{\\prime}$ is the normalized data, $x$ is the original data, $\\min (x)$ is the minimum value of the original dataset, and $\\max (x)$ is the maximum value of the original dataset. After obtaining the prediction results during the experiment, the data will be denormalized for stock price prediction and model evaluation.\n3.2.2 Data Splitting Here, the entire experimental datasets of Pudong Bank and IBM are input with a timestep of 60 for the recurrent kernels, and the number of input features per timestep is 5 and 6, respectively. This allows the model to input data from the previous 60 trading days to predict the closing price on the 61st day. This ensures that our dataset meets the input requirements of the three neural network models to be compared, namely the number of samples, the timestep length, and the number of input features per timestep. Subsequently, the Pudong Bank dataset is split into training, validation, and testing sets in a ratio of 2,488:311:255 after normalization. The IBM dataset is split into training, validation, and testing sets in a ratio of 6,550:364:304 after normalization. The purpose of the validation set here is to facilitate the adjustment of the model’s hyperparameters to optimize each model before comparison.\n3.3 Model Network Structures Through extensive experimentation, the network structures set for each model are as shown in the table below. Between layers, the default tanh and linear activation functions for recurrent neural networks are used, and Dropout with a dropout rate of 0.2 is added to prevent overfitting. Each recurrent layer in LSTM and GRU models has 50 neurons, while the BiLSTM recurrent layers have 100 neurons. Each LSTM, GRU, and BiLSTM model comprises four recurrent layers and one fully connected layer, with a Dropout layer between each network layer.\nTable 3.3: LSTM Network Structure for IBM Layer(type) Output Shape Param# lstm_1 (LSTM) (None, 60, 50) 11,400 dropout_1 (Dropout) (None, 60, 50) 0 lstm_2 (LSTM) (None, 60, 50) 20,200 dropout_2 (Dropout) (None, 60, 50) 0 lstm_3 (LSTM) (None, 60, 50) 20,200 dropout_3 (Dropout) (None, 60, 50) 0 lstm_4 (LSTM) (None, 50) 20,200 dropout_4 (Dropout) (None, 50) 0 dense_1 (Dense) (None, 1) 51 Total params: 72,051\nTrainable params: 72,051\nNon-trainable params: 0\nTable 3.4: GRU Network Structure for IBM Layer(type) Output Shape Param# gru_1 (GRU) (None, 60, 50) 8,550 dropout_1 (Dropout) (None, 60, 50) 0 gru_2 (GRU) (None, 60, 50) 15,150 dropout_2 (Dropout) (None, 60, 50) 0 gru_3 (GRU) (None, 60, 50) 15,150 dropout_3 (Dropout) (None, 60, 50) 0 gru_4 (GRU) (None, 50) 15,150 dropout_4 (Dropout) (None, 50) 0 dense_1 (Dense) (None, 1) 51 Total params: 54,051\nTrainable params: 54,051\nNon-trainable params: 0\nTable 3.5: BiLSTM Network Structure for IBM Layer(type) Output Shape Param# bidirectional_1 (Bidirectional) (None, 100) 22,400 dropout_1 (Dropout) (None, 100) 0 dense_1 (Dense) (None, 256) 25,856 dropout_2 (Dropout) (None, 256) 0 dense_2 (Dense) (None, 64) 16,448 dense_3 (Dense) (None, 1) 0 Total params: 66,769\nTrainable params: 66,769\nNon-trainable params: 0\n3.4 Model Compilation and Hyperparameter Settings After iterative tuning of hyperparameters aiming to minimize the loss function on the validation set, the following settings are chosen for the three models for Pudong Bank and IBM respectively: epochs=100, batch_size=32 for Pudong Bank models and epochs=50, batch_size=32 for IBM models. The optimizer used is Adaptive Moment Estimation (Adam)$^{[19]}$ with default settings in the keras package: lr=0.001, beta_1=0.9, beta_2=0.999, epsilon=1e-08, and decay=0.0. The loss function is Mean Squared Error (MSE).\nParameter Descriptions:\nlr: Learning rate beta_1: Exponential decay rate for the first moment estimates beta_2: Exponential decay rate for the second moment estimates epsilon: Small constant for numerical stability decay: Learning rate decay per update 3.5 Experimental Results and Analysis First, a brief introduction to the evaluation metrics used for model assessment is provided. The calculation formulas are as follows:\nMean Squared Error (MSE): $$ MSE=\\frac{1}{n} \\sum_{i=1}^{n}\\left(Y_{i}-\\hat{Y}_{i}\\right)^{2} $$ Root Mean Squared Error (RMSE): $$ RMSE=\\sqrt{\\frac{1}{n} \\sum_{i=1}^{n}\\left(Y_{i}-\\hat{Y}_{i}\\right)^{2}} $$ Mean Absolute Error (MAE): $$ MAE=\\frac{1}{n} \\sum_{i=1}^{n}\\left|Y_{i}-\\hat{Y}_{i}\\right| $$ \\( R^2 \\) (R Squared): $$ \\begin{gathered} \\bar{Y}=\\frac{1}{n} \\sum_{i=1}^{n} Y_{i} \\\\ R^{2}=1-\\frac{\\sum_{i=1}^{n}\\left(Y_{i}-\\hat{Y}_{i}\\right)^{2}}{\\sum_{i=1}^{n}\\left(Y_{i}-\\bar{Y}\\right)^{2}} \\end{gathered} $$Where $n$ is the number of samples, $Y$ is the actual closing price, $\\hat{Y}_{i}$ is the predicted closing price, and $\\bar{Y}$ is the average closing price. Lower values of MSE, RMSE, and MAE indicate more accurate models. A higher $R^{2}$ indicates a better fit of the model coefficients.\n3.5.1 Experimental Results for Pudong Bank Table 3.6: Experimental Results for Pudong Bank LSTM GRU BiLSTM MSE 0.059781 0.069323 0.056454 RMSE 0.244501 0.263292 0.237601 MAE 0.186541 0.202665 0.154289 R-squared 0.91788 0.896214 0.929643 Comparing the evaluation metrics of the three models, we observe that on the Pudong Bank test set, the BiLSTM model has lower MSE, RMSE, and MAE than both the LSTM and GRU models, while its $R^2$ is higher than those of LSTM and GRU models. Specifically, the RMSE comparison shows that BiLSTM has a 2.90% performance improvement over LSTM and a 10.81% performance improvement over GRU on the validation set.\n3.5.2 Experimental Results for IBM Table 3.7: Experimental Results for IBM LSTM GRU BiLSTM MSE 18.01311 12.938584 11.057501 RMSE 4.244186 3.597024 3.325282 MAE 3.793223 3.069033 2.732075 R-squared 0.789453 0.851939 0.883334 Comparing the evaluation metrics of the three models, we find that on the IBM test set, the BiLSTM model has lower MSE, RMSE, and MAE than both the LSTM and GRU models, while its $R^2$ is higher than those of LSTM and GRU models. Specifically, the RMSE comparison shows that BiLSTM has a 27.63% performance improvement over LSTM and an 8.17% performance improvement over GRU on the validation set.\n3.6 Chapter Summary This chapter introduced the datasets selected for the experiments—Pudong Bank and IBM—and the chosen features. It then performed data normalization and data splitting as preprocessing steps. The chapter also detailed the network structures and hyperparameter settings of the LSTM, GRU, and BiLSTM models used in the experiments. Finally, it presented the loss function curves and a series of fitting graphs for each model. By comparing multiple evaluation metrics and fitting graphs, it was concluded that the BiLSTM model can better predict stock prices, laying the foundation for the subsequent research on the LightGBM-BiLSTM quantitative investment strategy.\nChapter 4: Research on LightGBM-BiLSTM-Based Quantitative Investment Models 4.1 Experimental Steps Fig. 11. LightGBM-BiLSTM Diagram.\nAs shown in Fig. 11, this experiment first selects 50 factors from the factor library. Subsequently, each factor undergoes outlier removal, normalization, and missing value imputation steps for factor cleaning. The LightGBM model is then used for factor selection, ranking factors based on importance and selecting the top ten most important factors for cross-sectional analysis. Next, the BiLSTM model is used to combine these factors to build a multi-factor model. Finally, the quantitative investment strategy is constructed based on the obtained models and subjected to backtesting analysis.\n4.2 Experimental Data 4.2.1 Stock Data The market data used in this paper are sourced from Tushare. The specific features of the dataset are shown in Table 4.1.\nTable 4.1: Features Included in the Dataset Name Type Description ts_code str Stock code trade_date str Trading date open float Opening price high float Highest price low float Lowest price close float Closing price pre_close float Previous day’s closing price change float Price change pct_chg float Percentage change (unadjusted) vol float Trading volume (in hands) amount float Trading amount (in thousands of yuan) The entire A-share daily market dataset contains 5,872,309 rows of data, representing 5,872,309 samples. As shown in Table 4.2, the A-share daily market dataset has the following 11 features: stock code (ts_code), trading date (trade_date), opening price (open), closing price (close), highest price (high), lowest price (low), previous day’s closing price (pre_close), price change (change), turnover rate (turnover_rate), trading amount (amount), total market value (total_mv), and adjustment factor (adj_factor).\nTable 4.2: Partial Display of A-share Daily Market Dataset ts_code trade_date open high low close pre_close change vol amount 600613.SH 20120104 8.20 8.20 7.84 7.86 8.16 -0.30 4,762.98 3,854.1000 600690.SH 20120104 9.00 9.17 8.78 8.78 8.93 -0.15 142,288.41 127,992.6050 300277.SZ 20120104 22.90 22.98 20.81 20.88 22.68 -1.80 12,212.39 26,797.1370 002403.SZ 20120104 8.87 8.90 8.40 8.40 8.84 -0.441 10,331.97 9,013.4317 300179.SZ 20120104 19.99 20.32 19.20 19.50 19.96 -0.46 1,532.31 3,008.0594 600000.SH 20120104 8.54 8.56 8.39 8.41 8.49 -0.08 342,013.79 290,229.5510 300282.SZ 20120104 22.90 23.33 21.02 21.02 23.35 -2.33 38,408.60 86,216.2356 002319.SZ 20120104 9.74 9.95 9.38 9.41 9.73 -0.32 4,809.74 4,671.4803 601991.SH 20120104 5.17 5.39 5.12 5.25 5.16 0.09 145,268.38 76,547.7490 000780.SZ 20120104 10.42 10.49 10.00 10.00 10.30 -0.30 20,362.30 20,830.1761 [5,872,309 rows x 11 columns]\nThe CSI All Share Index daily dataset contains 5,057 rows of data, representing 5,057 samples. As shown in Table 4.3, the CSI All Share daily dataset has the following 7 features: trading date (trade_date), opening price (open), highest price (high), lowest price (low), closing price (close), trading volume (volume), and previous day’s closing price (pre_close).\nTable 4.3: Partial Display of CSI All Share Daily Dataset trade_date open high low close volume pre_close 2006-11-24 1564.3560 1579.3470 1549.9790 1576.1530 7.521819e+09 1567.0910 2006-11-27 1574.1130 1598.7440 1574.1130 1598.7440 7.212786e+09 1581.1530 2006-11-28 1597.7200 1604.7190 1585.3620 1596.8400 7.025637e+09 1598.7440 2006-11-29 1575.3030 1620.2870 1575.3030 1617.9880 7.250354e+09 1596.8400 2006-11-30 1621.4280 1657.3230 1621.4280 1657.3230 9.656888e+09 1617.9880 … … … … … … … 2020-11-11 5477.8870 5493.5867 5422.9110 5425.8017 5.604086e+10 5494.1042 2020-11-12 5439.2296 5454.3452 5413.9659 5435.1379 4.594251e+10 5425.8017 2020-11-13 5418.2953 5418.3523 5364.2031 5402.7702 4.688916e+10 5435.1379 2020-11-16 5422.3565 5456.7264 5391.9232 5456.7264 5.593672e+10 5402.7702 2020-11-17 5454.0696 5454.0696 5395.6052 5428.0765 5.857009e+10 5456.7264 [5,057 rows x 7 columns]\nBelow is partial data of the original factors. After undergoing the four factor cleaning steps—missing value imputation, outlier removal, factor normalization, and factor neutralization—the cleaned factor data is displayed in the table below.\nTable 4.4: Original Factor Data trade_date sec_code ret factor_0 factor_1 factor_2 factor_3 factor_4 factor_5 factor_6 … 2005-01-04 600874.SH 0.001684 NaN 9.445412 9.445412 9.445408 -1.00 NaN 12651.124023 … 2005-01-04 000411.SZ 0.021073 NaN 5.971262 5.971262 5.971313 0.38 NaN 392.124298 … 2005-01-04 000979.SZ 0.021207 NaN 6.768918 6.768918 6.768815 -1.45 NaN 870.587585 … 2005-01-04 000498.SZ 0.030220 NaN 8.852752 8.852752 8.852755 0.55 NaN 6994.011719 … 2005-01-04 600631.SH 0.015699 NaN 9.589897 9.589897 9.589889 -1.70 NaN 14616.806641 … Table 4.5: Cleaned Factor Data sec_code trade_date ret factor_0 factor_1 factor_2 factor_3 factor_4 factor_5 factor_6 … 000001.SZ 2005-01-04 -1.58653 0.01545 1.38306 1.38306 1.38306 0.13392 0.01545 1.38564 … 000002.SZ 2005-01-04 1.36761 -0.44814 1.69728 1.69728 1.69728 1.04567 -0.44814 1.69728 … 000004.SZ 2005-01-04 0.32966 -1.41654 -0.13907 -0.13907 -0.13907 -0.34769 -1.41654 -0.13650 … 000005.SZ 2005-01-04 0.61297 -1.13066 1.05339 1.05339 1.05339 -1.20020 -1.13066 1.05597 … 000006.SZ 2005-01-04 -0.35542 1.67667 -0.07726 -0.07726 -0.07726 1.55820 1.67667 -0.07469 … 4.3 Factor Cleaning 4.3.1 Handling Missing Values and Outlier Removal Methods for handling missing values in factors include case elimination, mean substitution, regression imputation, etc. This paper adopts the relatively simple mean substitution method to handle missing values, replacing missing data with the factor’s average value. For outlier removal, methods include median trimming, percentile-based trimming, and $3\\sigma$ trimming. This paper uses the $3\\sigma$ trimming method, which applies the statistical $3\\sigma$ principle to transform extreme factor values more than three standard deviations away from the mean to exactly three standard deviations away from the mean. The specific calculation formula is as follows:\n$$ X_i^{\\prime}= \\begin{cases} \\bar{X}+3 \\sigma \u0026 \\text{if } X_i \u003e \\bar{X} + 3 \\sigma \\\\ \\bar{X}-3 \\sigma \u0026 \\text{if } X_i \u003c \\bar{X} - 3 \\sigma \\\\ X_i \u0026 \\text{if } \\bar{X} - 3 \\sigma \u003c X_i \u003c \\bar{X} + 3 \\sigma \\end{cases} $$Where:\n$X_{i}$: Original value of the factor before processing $\\bar{X}$: Mean of the factor series $\\sigma$: Standard deviation of the factor series $X_{i}^{\\prime}$: Value of the factor after outlier removal 4.3.2 Factor Normalization In this experiment, multiple factors with different dimensions are selected, and their units are not entirely consistent. To facilitate comparison and regression, normalization of factors is necessary. Common normalization methods include Min-Max normalization, Z-score normalization, and Decimal scaling normalization. This paper adopts the Z-score normalization method, standardizing data using the mean and standard deviation of the original data. The processed data follow a standard normal distribution with a mean of 0 and a standard deviation of 1, resulting in normalized values that are both positive and negative, forming a standard normal distribution curve.\nThe Z-score normalization formula used in this paper is as follows:\n$$ \\tilde{x}=\\frac{x_{i}-u}{\\sigma} $$Where:\n$x_{i}$: Original value of the factor $u$: Mean of the factor series $\\sigma$: Standard deviation of the factor series $\\tilde{x}$: Normalized factor value 4.3.3 Factor Neutralization Factor neutralization aims to eliminate the influence of other factors on the selected factor, ensuring that the stocks chosen for constructing the quantitative investment strategy are more diversified rather than concentrated in specific industries or market capitalizations. This better distributes investment portfolio risk and addresses multicollinearity issues among factors. Market capitalization and industry are the two main independent variables influencing stock returns; therefore, they must be considered during factor cleaning. In this paper’s empirical study, only industry factors are included, with the market factor incorporated into the industry factors. The single-factor regression model for neutralizing factors is shown in formula (31). The residuals from the following regression model are used as the new, neutralized factor values.\n$$ \\tilde{r}_{j}^{t}=\\sum_{s=1}^{S} X_{j s}^{t} \\tilde{f}_{s}^{t} + X_{j k}^{t} \\tilde{f}_{k}^{t} + \\tilde{u}_{j}^{t} $$Where:\n$\\tilde{r}_{j}^{t}$: Return of stock $j$ in period $t$ $X_{j s}^{t}$: Exposure of stock $j$ to industry $s$ in period $t$ $\\tilde{f}_{s}^{t}$: Return of industry $s$ in period $t$ $X_{j k}^{t}$: Exposure of stock $j$ to factor $k$ in period $t$ $\\tilde{f}_{k}^{t}$: Return of factor $k$ in period $t$ $\\tilde{u}_j^t$: A $0-1$ dummy variable, indicating whether stock $j$ belongs to industry $s$ (1) or not (0) In this paper, the industry assignment is not proportionally split; that is, stock $j$ can belong to only one specific industry $s$, with an exposure of 1 to industry $s$ and 0 to all other industries. This paper uses the Shenwan Hongyuan industry classification standard, categorizing companies into 28 primary industries: Agriculture, Forestry, Animal Husbandry, and Fishery; Mining; Chemicals; Steel; Non-Ferrous Metals; Electronic Components; Home Appliances; Food and Beverage; Textile and Apparel; Light Manufacturing; Pharmaceutical and Biotechnology; Public Utilities; Transportation; Real Estate; Commerce and Trade; Catering and Tourism; Comprehensive; Building Materials; Architectural Decoration; Electrical Equipment; National Defense and Military Industry; Computers; Media; Telecommunications; Banking; Non-Banking Finance; Automobiles; and Machinery Equipment. The table below shows the historical market data of the Shenwan Hongyuan primary industry index as of February 5, 2021.\nTable 4.9: Historical Market Data of Shenwan Hongyuan Primary Industry Index as of February 5, 2021 Index Code Index Name Release Date Opening Index Highest Index Lowest Index Closing Index Trading Volume (Billion) Trading Amount (Hundred Million Yuan) Percentage Change (%) 801010 Agriculture, Forestry, Animal Husbandry, and Fishery 2021/2/5 0:00 4,111.43 4,271.09 4,072.53 4,081.81 1.581 307.82 -0.3 801020 Mining 2021/2/5 0:00 2,344.62 2,357.33 2,288.97 2,289.41 1.806 115.6 -2.25 801030 Chemicals 2021/2/5 0:00 4,087.77 4,097.59 3,910.67 3,910.67 5.578 778.85 -3.95 801040 Steel 2021/2/5 0:00 2,253.78 2,268.17 2,243.48 2,250.81 1.161 48.39 -1.02 801050 Non-Ferrous Metals 2021/2/5 0:00 4,212.10 4,250.59 4,035.99 4,036.74 4.541 593.92 -4.43 801080 Electronic Components 2021/2/5 0:00 4,694.80 4,694.80 4,561.95 4,561.95 5.267 850.79 -2.78 801110 Home Appliances 2021/2/5 0:00 10,033.82 10,171.26 9,968.93 10,096.83 0.855 149.18 0.83 801120 Food and Beverage 2021/2/5 0:00 30,876.33 31,545.02 30,649.57 30,931.69 1.132 657.11 0.47 801130 Textile and Apparel 2021/2/5 0:00 1,614.48 1,633.89 1,604.68 1,607.63 0.628 57.47 -0.39 801140 Light Manufacturing 2021/2/5 0:00 2,782.07 2,791.88 2,735.48 2,737.24 1.528 176.16 -1.35 … … … … … … … … … … Data Source: Shenwan Hongyuan\nBelow is partial data of the original factors. After undergoing the four factor cleaning steps—missing value imputation, outlier removal, factor normalization, and factor neutralization—the cleaned factor data is displayed in the table below.\nTable 4.10: Original Factor Data trade_date sec_code ret factor_0 factor_1 factor_2 factor_3 factor_4 factor_5 factor_6 … 2005-01-04 600874.SH 0.001684 NaN 9.445412 9.445412 9.445408 -1.00 NaN 12651.124023 … 2005-01-04 000411.SZ 0.021073 NaN 5.971262 5.971262 5.971313 0.38 NaN 392.124298 … 2005-01-04 000979.SZ 0.021207 NaN 6.768918 6.768918 6.768815 -1.45 NaN 870.587585 … 2005-01-04 000498.SZ 0.030220 NaN 8.852752 8.852752 8.852755 0.55 NaN 6994.011719 … 2005-01-04 600631.SH 0.015699 NaN 9.589897 9.589897 9.589889 -1.70 NaN 14616.806641 … Table 4.11: Cleaned Factor Data sec_code trade_date ret factor_0 factor_1 factor_2 factor_3 factor_4 factor_5 factor_6 … 000001.SZ 2005-01-04 -1.58653 0.01545 1.38306 1.38306 1.38306 0.13392 0.01545 1.38564 … 000002.SZ 2005-01-04 1.36761 -0.44814 1.69728 1.69728 1.69728 1.04567 -0.44814 1.69728 … 000004.SZ 2005-01-04 0.32966 -1.41654 -0.13907 -0.13907 -0.13907 -0.34769 -1.41654 -0.13650 … 000005.SZ 2005-01-04 0.61297 -1.13066 1.05339 1.05339 1.05339 -1.20020 -1.13066 1.05597 … 000006.SZ 2005-01-04 -0.35542 1.67667 -0.07726 -0.07726 -0.07726 1.55820 1.67667 -0.07469 … 4.4 Factor Selection Based on LightGBM Freeman (2001)$^{[20]}$ proposed Gradient Boosting Decision Trees (GBDT), an iterative regression decision tree method. The main idea is to iteratively add weak classifiers (usually decision trees) to optimize the model, minimizing the loss function. GBDT can be expressed as:\n$$ \\hat{y} = \\sum_{m=1}^{M} \\gamma_m h_m(\\mathbf{x}) $$Where:\n\\( M \\) is the number of iterations \\( \\gamma_m \\) is the weight of the \\( m \\)-th weak classifier \\( h_m(\\mathbf{x}) \\) is the \\( m \\)-th decision tree model The training process of GBDT minimizes the loss function by sequentially fitting in the direction of the negative gradient, with the specific update formula as:\n$$ \\gamma_m = \\arg\\min_\\gamma \\sum_{i=1}^{N} L\\left(y_i, \\hat{y}_{i}^{(m-1)} + \\gamma h_m(\\mathbf{x}_i)\\right) $$Where \\( L \\) is the loss function, \\( y_i \\) is the true value, and \\( \\hat{y}_{i}^{(m-1)} \\) is the prediction after the \\( m-1 \\)-th iteration.\nLight Gradient Boosting Machine (LightGBM)$^{[21]}$ is an efficient implementation framework of the GBDT algorithm, initially developed by Microsoft as a free and open-source distributed gradient boosting framework. LightGBM is based on decision tree algorithms and is widely used in ranking, classification, and other machine learning tasks. Its development focuses on performance and scalability, with major advantages including highly efficient parallel training, faster training speed, lower memory consumption, better accuracy, support for distributed computing, and fast processing of massive data$^{[22]}$.\nThe core algorithm of LightGBM is based on the following optimization objective:\n$$ L = \\sum_{i=1}^{N} l(y_i, \\hat{y}_i) + \\sum_{m=1}^{M} \\Omega(h_m) $$Where \\( l \\) is the loss function, \\( \\Omega \\) is the regularization term controlling model complexity, typically expressed as:\n$$ \\Omega(h_m) = \\gamma T + \\frac{1}{2} \\lambda \\sum_{j=1}^{T} w_j^2 $$Here, \\( T \\) is the number of leaves in the tree, \\( w_j \\) is the weight of the \\( j \\)-th leaf, and \\( \\gamma \\) and \\( \\lambda \\) are regularization parameters.\nLightGBM employs techniques such as Gradient-based One-Side Sampling (GOSS) and Exclusive Feature Bundling (EFB) to significantly enhance training efficiency and model performance.\nIn this study, the loss function used during training is Mean Squared Error (MSE), defined as:\n$$ L(y, \\hat{y}) = \\frac{1}{N} \\sum_{i=1}^{N} (y_i - \\hat{y}_i)^2 $$Where \\( y \\) is the true return, \\( \\hat{y} \\) is the predicted return, and \\( N \\) is the number of samples.\nThe specific algorithm process of this subsection is as follows:\nData Preparation: Use one year’s worth of data for each stock in the A-share market, consisting of 50 factor data points and the historical return for the next month as features.\nModel Training: Utilize Grid Search to optimize the LightGBM model’s hyperparameters and train the model to predict the next month’s returns. The model training process is shown in Fig. 12.\n$$ \\text{Parameter Optimization:} \\quad \\theta^* = \\arg\\min_\\theta \\sum_{i=1}^{N} L(y_i, \\hat{y}_i(\\theta)) $$Where \\( \\theta \\) represents the set of model hyperparameters, and \\( \\theta^* \\) is the optimal set.\nFactor Importance Calculation: Use LightGBM’s feature_importances_ method to calculate the feature importance of each factor. Feature importance is primarily measured using two indicators:\nSplit: The number of times the feature is used for splitting across all trees. Gain: The total gain brought by the feature across all splits (i.e., the reduction in the loss function). The feature importance of factors can be expressed as:\n$$ \\text{Importance}_{\\text{split}}(f) = \\sum_{m=1}^{M} \\sum_{j=1}^{T_m} \\mathbb{I}(f \\text{ used in the split of the } j\\text{-th leaf node of the } m\\text{-th tree}) $$$$ \\text{Importance}_{\\text{gain}}(f) = \\sum_{m=1}^{M} \\sum_{j=1}^{T_m} \\Delta L_{m,j} \\cdot \\mathbb{I}(f \\text{ used in the split of the } j\\text{-th leaf node of the } m\\text{-th tree}) $$Where \\( \\mathbb{I} \\) is the indicator function, and \\( \\Delta L_{m,j} \\) is the loss reduction brought by factor \\( f \\) in the split of the \\( j \\)-th leaf node of the \\( m \\)-th tree.\nFactor Selection: Rank the factors based on their calculated importance and select the top ten most important factors for cross-sectional analysis, as shown in Table 4.9.\nTable 4.9: Partial Factor Importance Ranking Importance Feature Name Trade Date 35 factor_35 2010-08-11 27 factor_27 2010-08-11 33 factor_33 2010-08-11 20 factor_20 2010-08-11 24 factor_24 2010-08-11 45 factor_45 2010-08-11 37 factor_37 2010-08-11 49 factor_49 2010-08-11 19 factor_19 2010-08-11 47 factor_47 2010-08-11 22 factor_22 2010-09-09 20 factor_20 2010-09-09 30 factor_30 2010-09-09 24 factor_24 2010-09-09 Code Implementation Snippet: The following code snippet demonstrates part of the training process used for factor selection. def feature_choice( self, days=21, is_local=False ): if is_local: feature_info = pd.read_hdf(os.path.join(RESULTS, Feature_Info + '.h5')) else: factors = self.get_env().query_data(Factors_Data) factors = factors[ factors[COM_DATE] \u003e= '2010-01-01' ] trade_list = list(set(factors[COM_DATE])) trade_list.sort() if len(trade_list) % days == 0: n = int(len(trade_list) / days) - 7 else: n = int(len(trade_list) / days) - 6 feature_info = pd.DataFrame() begin_index = 147 feature = list(factors.columns) feature.remove(COM_SEC) feature.remove(COM_DATE) feature.remove(Ret) for i in range(n): end_date = days * i + begin_index - 21 begin_date = days * i trade_date = days * i + begin_index print(trade_list[trade_date]) train_data = factors[ (factors[COM_DATE] \u003c= trade_list[end_date]) \u0026 (factors[COM_DATE] \u003e= trade_list[begin_date]) ] model = lgb.LGBMRegressor() model.fit(train_data[feature], train_data[Ret]) feature_info_cell = pd.DataFrame(columns=Info_Fields) feature_info_cell[Importance] = model.feature_importances_ feature_info_cell[Feature_Name] = model.feature_name_ feature_info_cell = feature_info_cell.sort_values(by=Importance).tail(10) feature_info_cell[COM_DATE] = trade_list[trade_date] feature_info = pd.concat( [feature_info, feature_info_cell], axis=0 ) h = pd.HDFStore(os.path.join(RESULTS, Feature_Info + '.h5'), 'w') h['data'] = feature_info h.close() self.get_env().add_data(feature_info, Feature_Info) pass Through the above process, LightGBM efficiently screens out factors that have the most significant impact on predicting future returns, thereby enhancing the model’s predictive capability and interpretability.\n4.5 Factor Combination Based on BiLSTM This subsection uses BiLSTM for factor combination. The specific principles of BiLSTM have been introduced in Chapter 2, so they will not be reiterated here. Below, we describe the specific network structure used. After extensive experimentation, the BiLSTM network structure is set as shown in Table 4.10 and Fig. 12. Between layers, the default tanh and linear activation functions for recurrent neural networks are used. To prevent overfitting, Dropout with a dropout rate of 0.01 is added. However, if the dropout rate is too high, it can lead to underfitting. The BiLSTM recurrent layer has 100 neurons, and the network comprises one BiLSTM layer and three fully connected layers, with a Dropout layer between the BiLSTM layer and the first fully connected layer.\nTable 4.10: BiLSTM Network Structure Layer(type) Output Shape Param# bidirectional_1 (Bidirectional) (None, 100) 22,400 dropout_1 (Dropout) (None, 100) 0 dense_1 (Dense) (None, 256) 25,856 dropout_2 (Dropout) (None, 256) 0 dense_2 (Dense) (None, 64) 16,448 dense_3 (Dense) (None, 1) 0 Total params: 66,769\nTrainable params: 66,769\nNon-trainable params: 0\nDue to the large volume of training data in this experiment, epochs=400 and batch_size=1024 are selected for the BiLSTM model. The loss function used is Mean Squared Error (MSE), and the optimizer chosen is Stochastic Gradient Descent (SGD). Compared to Gradient Descent (GD), SGD has the advantages of more effectively utilizing information in redundant data, excellent performance in early iterations, and suitability for handling large sample datasets$^{[23]}$. Given the large training data volume, using SGD allows for faster training as it updates with one sample at a time, significantly reducing training time. The default settings in the keras package are used: lr=0.01, momentum=0.0, decay=0.0, and nesterov=False.\nParameter Descriptions:\nlr: Learning rate momentum: Momentum parameter decay: Learning rate decay after each update nesterov: Whether to use Nesterov momentum The specific algorithm process of this subsection is as follows:\nData Usage: Use one year’s worth of data for each stock in the A-share market, consisting of 10 factors selected by LightGBM and the historical return for the next month as features. Model Training: Use the BiLSTM model to train with the selected factors to predict the next month’s returns, as shown in Fig. 12. Fig. 12. Rolling Window\nPrediction: Apply the trained BiLSTM model to the out-of-sample data of one month to obtain the expected returns for each stock in the next month. The predicted returns are shown in Table 4.11. Table 4.11: Partial Display of Predicted Returns for Stocks sec_code trade_date y_hat 000001.SZ 2011/5/26 0.0424621 000002.SZ 2011/5/26 -0.1632174 000004.SZ 2011/5/26 -0.0642319 000005.SZ 2011/5/26 0.08154649 000006.SZ 2011/5/26 0.00093213 000007.SZ 2011/5/26 -0.073218 000008.SZ 2011/5/26 -0.0464256 000009.SZ 2011/5/26 -0.091549 000010.SZ 2011/5/26 0.08154649 000011.SZ 2011/5/26 -0.1219943 000012.SZ 2011/5/26 -0.1448984 000014.SZ 2011/5/26 0.09038845 000016.SZ 2011/5/26 -0.11225 Code Implementation Snippet: The following code snippet demonstrates part of the training process used to construct a BiLSTM network. def build_net_blstm(self): model = ks.Sequential() model.add( ks.layers.Bidirectional(ks.layers.LSTM( 50 ),input_shape=(11,10)) ) model.add( ks.layers.Dropout(0.01) ) model.add(ks.layers.Dense(256)) model.add( ks.layers.Dropout(0.01) ) model.add(ks.layers.Dense(64)) model.add(ks.layers.Dense(1)) model.compile(optimizer='sgd', loss='mse') model.summary() self.set_model(model) 4.6 Quantitative Strategy and Strategy Backtesting 4.6.1 Backtesting Metrics Below are common backtesting metrics used to evaluate the strategy. The metrics include Total Rate of Return, Annualized Rate of Return, Annualized Volatility, Sharpe Ratio, Maximum Drawdown (MDD), Annualized Turnover Rate, and Annualized Transaction Cost Rate, assuming 252 trading days in a year and a risk-free rate of 3.5%. The transaction fee is assumed to be 0.2% per trade.\nTotal Rate of Return: Indicates the cumulative return of the strategy. The higher the cumulative return, the better the strategy’s performance. The formula is as follows: $$ \\text{Total Rate of Return} = r_{p} = \\frac{P_{1} - P_{0}}{P_{0}} $$Where:\n$P_{1}$: Total value of stocks and cash at the end $P_{0}$: Total value of stocks and cash at the beginning Annualized Rate of Return: Converts the total cumulative return into a geometric average return on an annual basis. The higher the annualized return, the better the strategy. The formula is as follows: $$ \\text{Annualized Rate of Return} = R_{p} = \\left(1 + r_{p}\\right)^{\\frac{252}{t}} - 1 $$Where:\n$r_{p}$: Total rate of return $t$: Number of trading days the strategy is executed Annualized Volatility: Defined as the standard deviation of the logarithm of the asset’s annual return rates. It measures the risk of the strategy, with higher volatility indicating higher risk. The formula is as follows: $$ \\begin{aligned} \\text{Annualized volatility} = \\sigma_{p} \u0026= \\sqrt{\\frac{252}{t-1} \\sum_{i=1}^{t}\\left(r_{d} - \\bar{r}_{d}\\right)^{2}} \\\\ \\bar{r}_{d} \u0026= \\frac{1}{t} \\sum_{i=1}^{t} r_{d_{i}} \\end{aligned} $$Where:\n$r_{d_{i}}$: Daily return on the $i$-th day $\\bar{r}_{d}$: Daily average return $t$: Number of trading days the strategy is executed Sharpe Ratio: Proposed by Sharpe (1966)$^{[24]}$, it represents the excess return per unit of risk. Here, the annualized Sharpe ratio is calculated as follows: $$ S = \\frac{R_{p} - R_{f}}{\\sigma_{p}} $$Where:\n$R_{p}$: Annualized rate of return $R_{f}$: Risk-free rate $\\sigma_{p}$: Annualized volatility Maximum Drawdown (MDD): Represents the maximum decline in the total value of stocks and cash during the strategy’s execution period. It measures the most extreme potential loss scenario of the strategy. $$ MDD = \\frac{\\max \\left(V_{x} - V_{y}\\right)}{V_{x}} $$Where:\n$V_{x}$ and $V_{y}$ are the total values of stocks and cash on day $x$ and day $y$, respectively, with $x \u003c y$. Annualized Turnover Rate: Measures the frequency of buying and selling stocks within the investment portfolio. A higher turnover rate indicates more frequent rebalancing and higher transaction costs. $$ \\text{Change} = \\frac{N \\times 252}{t} $$Where:\n$t$: Number of trading days the strategy is executed $N$: Total number of buy and sell operations Annualized Transaction Cost Rate: Measures the transaction costs of the investment portfolio strategy, with higher values indicating higher transaction costs. $$ c = \\left(1 + \\text{commission}\\right)^{\\text{change}} - 1 $$Where:\nChange: Annualized turnover rate Commission: Transaction fee rate 4.6.2 Strategy and Backtesting Results This paper adopts a quantitative trading strategy that rebalances the portfolio every month (i.e., a rebalancing period of 28 trading days). Each rebalance involves equally weighting the top 25 stocks with the highest expected returns predicted by BiLSTM and selling the previously held stocks. The backtesting period and rules are as follows:\nBacktesting Period: From January 2012 to October 2020. Backtesting Stock Pool: All A-share stocks, excluding Special Treatment (ST) stocks. Transaction Fees: A trading commission of 0.2% is paid to brokers upon buying and selling, with a minimum commission of 5 yuan per trade if the calculated fee is less than 5 yuan. Trading Rules: Stocks hitting the daily limit-up cannot be bought, and stocks hitting the daily limit-down cannot be sold on the same day. Table 4.12: Strategy Backtesting Results Total Rate of Return Annualized Rate of Return Annualized Volatility Sharpe Ratio Maximum Drawdown Annualized Turnover Rate Annualized Transaction Cost Rate Strategy 701.00% 29.18% 33.44% 0.77 51.10% 51.10% 11.35% Benchmark 110.40% 9.70% 26.01% 0.24 58.49% 58.49% 0.00% Fig. 22. Net Profit Curve\nThe backtesting results are shown in Table 4.12 and Fig. 22. The strategy employed is the LightGBM-BiLSTM quantitative strategy introduced in this chapter. The benchmark used is the CSI All Share Index (000985). From the results, the strategy achieves a cumulative return of 701.00%, significantly higher than the benchmark’s 110.40%. The annualized return is 29.18%, far exceeding the benchmark’s 9.70%. The Sharpe ratio is 0.77, which is higher than the benchmark’s 0.24. These three backtesting metrics indicate that the LightGBM-BiLSTM quantitative strategy indeed provides greater returns to investors, demonstrating the effectiveness of using deep learning to construct quantitative investment strategies. The strategy’s annualized volatility is 33.44%, higher than the benchmark’s 26.01%, and the maximum drawdown is 51.10%, lower than the benchmark’s 58.49%. These two metrics indicate that the LightGBM-BiLSTM quantitative strategy carries certain risks, particularly in resisting systemic risk shocks. The annualized turnover rate is 11.35%, and the annualized transaction cost rate is 2.29%, indicating that the strategy is not a high-frequency trading strategy with relatively low transaction costs. The return curve shows that the LightGBM-BiLSTM quantitative strategy’s returns were similar to the benchmark in the first two years without notable advantages. However, starting around April 2015, the strategy’s returns clearly outperformed the benchmark. Overall, the LightGBM-BiLSTM quantitative strategy delivers substantial returns but still carries certain risks.\nChapter 5: Conclusion and Outlook 5.1 Conclusion This paper first introduced the research background and significance of deep learning-based stock price prediction and quantitative investment strategy research. It then reviewed the current domestic and international research status of stock price prediction and quantitative investment strategies, outlined the innovations of this paper, and presented the research framework. Next, the theoretical foundations chapter briefly introduced the deep learning models and the development history of quantitative investment used in this paper, with a focus on the basic structures, principles, and characteristics of LSTM, GRU, and BiLSTM models.\nSubsequently, using daily data from Pudong Bank and IBM, the paper conducted a series of data processing steps and feature extraction for data preprocessing. It then detailed the network structures and hyperparameter settings of the LSTM, GRU, and BiLSTM models used in the experiments. The study used LSTM, GRU, and BiLSTM to predict the closing prices of the two stocks and compared the models’ performance. The experimental results showed that the BiLSTM model achieved higher prediction accuracy for both stocks.\nFinally, to further demonstrate BiLSTM’s application value in finance, this paper constructed a LightGBM-BiLSTM-based quantitative investment model. It selected and cleaned multiple factors from the entire A-share market data, employed LightGBM for factor selection, and used BiLSTM for factor combination. The paper then constructed a quantitative investment strategy based on the model and compared it against the CSI All Share Index using metrics such as cumulative return, annualized return, annualized volatility, and Sharpe ratio. The comparison showed that the LightGBM-BiLSTM quantitative investment model achieved better returns, indicating the effectiveness of using deep learning to build quantitative investment strategies.\n5.2 Outlook Although this paper compared the performance of LSTM, GRU, and BiLSTM models in predicting stock closing prices and achieved certain results with the LightGBM-BiLSTM quantitative investment strategy, there are still some shortcomings. Based on the research outcomes of this paper, the following areas can be further explored and improved:\nDiverse Prediction Targets: This paper focuses on predicting stock closing prices, which, while intuitive, is challenging and less interpretable under the Random Walk Hypothesis (RWH) proposed by Bachelier (1900)$^{[26]}$, which posits that stock prices follow a random walk and are unpredictable. Although behavioral economists have shown that this hypothesis is not entirely correct, it indicates that simply predicting stock closing prices is difficult and less interpretable$^{[27][28]}$. Therefore, future research can explore predicting stock volatility, stock price movements (up or down), and stock returns.\nDiverse Model Comparisons: This paper compared LSTM, GRU, and BiLSTM models in predicting stock prices, demonstrating that BiLSTM achieves better accuracy. However, it lacks comparisons with other diverse models. Future research can delve into comparing single or hybrid models like ARIMA, Convolutional Neural Networks (CNN), Deep Neural Networks (DNN), CNN-LSTM, Transformer, and TimeGPT.\nDiverse Factor Selection: The factors used in constructing the quantitative investment strategy in this paper are primarily technical price and volume factors, with a limited variety. Future research can incorporate financial factors, sentiment factors, growth factors, and other types of factors to enhance the strategy’s performance. Additionally, incorporating timing strategies—such as increasing positions when the market is predicted to rise and decreasing positions when the market is predicted to fall—can capture beta ($\\beta$) returns.\nInvestment Portfolio Optimization: The factor combination process in this paper remains imperfect. Future research can utilize quadratic programming methods to optimize the investment portfolio.\nHigh-Frequency Trading Strategy Research: The quantitative investment strategy in this paper adopts a low-frequency trading approach. Future research can leverage tick data to explore high-frequency and ultra-high-frequency trading strategies.\nReferences [1] White, H. “Economic prediction using neural networks: The case of IBM daily stock returns.” Proc. of ICNN. 1988, 2: 451-458.\n[2] Kimoto, T., Asakawa, K., Yoda, M., et al. “Stock market prediction system with modular neural networks.” Proc. of 1990 IJCNN International Joint Conference on Neural Networks. IEEE, 1990: 1-6.\n[3] Zhang, G. P. “Time series forecasting using a hybrid ARIMA and neural network model.” Neurocomputing. 2003, 50: 159-175.\n[4] Akita, R., Yoshihara, A., Matsubara, T., et al. “Deep learning for stock prediction using numerical and textual information.” Proc. of 2016 IEEE/ACIS 15th International Conference on Computer and Information Science (ICIS). IEEE, 2016: 1-6.\n[5] 宮崎邦洋, 松尾豊. “Deep Learning を用いた株価予測の分析.” 人工知能学会全国大会論文集 第31回全国大会. 一般社団法人 人工知能学会, 2017: 2D3OS19a3-2D3OS19a3.\n[6] Kim, T., Kim, H. Y. “Forecasting stock prices with a feature fusion LSTM-CNN model using different representations of the same data.” PLoS ONE. 2019, 14(2): e0212320.\n[7] Hochreiter, S., Schmidhuber, J. “Long short-term memory.” Neural Computation. 1997, 9(8): 1735-1780.\n[8] Cho, K., Van Merriënboer, B., Gulcehre, C., et al. “Learning phrase representations using RNN encoder-decoder for statistical machine translation.” arXiv preprint arXiv:1406.1078. 2014.\n[9] Chung, J., Gulcehre, C., Cho, K. H., et al. “Empirical evaluation of gated recurrent neural networks on sequence modeling.” arXiv preprint arXiv:1412.3555. 2014.\n[10] Gruber, N., Jockisch, A. “Are GRU cells more specific and LSTM cells more sensitive in motive classification of text?” Frontiers in Artificial Intelligence. 2020, 3(40): 1-6.\n[11] Markowitz, H. “Portfolio Selection.” The Journal of Finance. 1952, 7(1): 77-91. doi:10.2307/2975974.\n[12] Merton, R. C. “An analytic derivation of the efficient portfolio frontier.” Journal of Financial and Quantitative Analysis. 1972: 1851-1872.\n[13] Sharpe, W. F. “Capital asset prices: A theory of market equilibrium under conditions of risk.” The Journal of Finance. 1964, 19(3): 425-442.\n[14] Lintner, J. “The Valuation of Risk Assets and the Selection of Risky Investments in Stock Portfolios and Capital Budgets.” Review of Economics and Statistics. 1965, 47(1): 13-37.\n[15] Mossin, J. “Equilibrium in a capital asset market.” Econometrica: Journal of the Econometric Society. 1966: 768-783.\n[16] Ross, S. A. “The arbitrage theory of capital asset pricing.” Journal of Economic Theory. 1976, 13(3): 341-60.\n[17] Fama, E. F., French, K. R. “Common risk factors in the returns on stocks and bonds.” Journal of Financial Economics. 1993, 33(1): 3-56.\n[18] Fama, E. F., French, K. R. “A five-factor asset pricing model.” Journal of Financial Economics. 2015, 116(1): 1-22.\n[19] Kingma, D. P., Ba, J. “Adam: A method for stochastic optimization.” arXiv preprint arXiv:1412.6980. 2014.\n[20] Friedman, J. H. “Greedy function approximation: A gradient boosting machine.” Annals of Statistics. 2001: 1189-1232.\n[21] Kopitar, L., Kocbek, P., Cilar, L., et al. “Early detection of type 2 diabetes mellitus using machine learning-based prediction models.” Scientific Reports. 2020, 10(1): 1-12.\n[22] Ke, G., Meng, Q., Finley, T., et al. “Lightgbm: A highly efficient gradient boosting decision tree.” Advances in Neural Information Processing Systems. 2017, 30: 3146-3154.\n[23] Bottou, L., Curtis, F. E., Nocedal, J. “Optimization methods for large-scale machine learning.” SIAM Review. 2018, 60(2): 223-311.\n[24] Sharpe, W. F. “Mutual fund performance.” The Journal of Business. 1966, 39(1): 119-138.\n[25] Sharpe, W. F. “The sharpe ratio.” Journal of Portfolio Management. 1994, 21(1): 49-58.\n[26] Bachelier, L. “Théorie de la spéculation.” Annales Scientifiques de l’École Normale Supérieure. 1900, 17: 21-86.\n[27] Fromlet, H. “Behavioral finance-theory and practical application: Systematic analysis of departures from the homo oeconomicus paradigm are essential for realistic financial research and analysis.” Business Economics. 2001: 63-69.\n[28] Lo, A. W. “The adaptive markets hypothesis.” The Journal of Portfolio Management. 2004, 30(5): 15-29.\nReference Blogs Colah’s Blog. (2015, August 27). Understanding LSTM Networks. Citation Citation: If you wish to share or reference this content, please credit the original author and source.\nCited as:\nYue Shui. (Apr 2021). Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning.\nhttps://syhya.github.io/posts/2021-04-21-deep-learning-stock-prediction/\nOr\n@article{syhya2021stockprediction, title = \"Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning\", author = \"Yue Shui\", journal = \"syhya.github.io\", year = \"2021\", month = \"Apr\", url = \"https://syhya.github.io/posts/2021-04-21-deep-learning-stock-prediction/\" } ","wordCount":"11238","inLanguage":"en","image":"https://syhya.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2021-04-21T12:00:00+08:00","dateModified":"2021-04-21T12:00:00+08:00","author":{"@type":"Person","name":"Yue Shui"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://syhya.github.io/posts/2021-04-21-deep-learning-stock-prediction/"},"publisher":{"@type":"Organization","name":"Yue Shui Blog","logo":{"@type":"ImageObject","url":"https://syhya.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://syhya.github.io/ accesskey=h title="Home (Alt + H)"><img src=https://syhya.github.io/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://syhya.github.io/zh/ title=简体中文 aria-label=简体中文>Zh</a></li></ul></div></div><ul id=menu><li><a href=https://syhya.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://syhya.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://syhya.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://syhya.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://syhya.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning</h1><div class=post-meta><span title='2021-04-21 12:00:00 +0800 +0800'>2021-04-21</span>&nbsp;·&nbsp;53 min&nbsp;·&nbsp;11238 words&nbsp;·&nbsp;Yue Shui&nbsp;|&nbsp;Translations:<ul class=i18n_list><li><a href=https://syhya.github.io/zh/posts/2021-04-21-deep-learning-stock-prediction/>Zh</a></li></ul></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#abstract>Abstract</a></li><li><a href=#chapter-1-introduction>Chapter 1: Introduction</a><ul><li><a href=#11-research-background-and-significance>1.1 Research Background and Significance</a></li><li><a href=#12-literature-review>1.2 Literature Review</a></li><li><a href=#13-innovations-of-the-paper>1.3 Innovations of the Paper</a></li><li><a href=#14-research-framework>1.4 Research Framework</a></li></ul></li><li><a href=#chapter-2-theoretical-foundations>Chapter 2: Theoretical Foundations</a><ul><li><a href=#21-deep-learning-models>2.1 Deep Learning Models</a></li><li><a href=#22-quantitative-stock-selection-theory>2.2 Quantitative Stock Selection Theory</a></li></ul></li><li><a href=#chapter-3-comparative-study-of-lstm-gru-and-bilstm-in-stock-price-prediction>Chapter 3: Comparative Study of LSTM, GRU, and BiLSTM in Stock Price Prediction</a><ul><li><a href=#31-introduction-of-experimental-data>3.1 Introduction of Experimental Data</a></li><li><a href=#32-data-preprocessing>3.2 Data Preprocessing</a></li><li><a href=#33-model-network-structures>3.3 Model Network Structures</a></li><li><a href=#34-model-compilation-and-hyperparameter-settings>3.4 Model Compilation and Hyperparameter Settings</a></li><li><a href=#35-experimental-results-and-analysis>3.5 Experimental Results and Analysis</a></li><li><a href=#36-chapter-summary>3.6 Chapter Summary</a></li></ul></li><li><a href=#chapter-4-research-on-lightgbm-bilstm-based-quantitative-investment-models>Chapter 4: Research on LightGBM-BiLSTM-Based Quantitative Investment Models</a><ul><li><a href=#41-experimental-steps>4.1 Experimental Steps</a></li><li><a href=#42-experimental-data>4.2 Experimental Data</a></li><li><a href=#43-factor-cleaning>4.3 Factor Cleaning</a></li><li><a href=#44-factor-selection-based-on-lightgbm>4.4 Factor Selection Based on LightGBM</a></li><li><a href=#45-factor-combination-based-on-bilstm>4.5 Factor Combination Based on BiLSTM</a></li><li><a href=#46-quantitative-strategy-and-strategy-backtesting>4.6 Quantitative Strategy and Strategy Backtesting</a></li></ul></li><li><a href=#chapter-5-conclusion-and-outlook>Chapter 5: Conclusion and Outlook</a><ul><li><a href=#51-conclusion>5.1 Conclusion</a></li><li><a href=#52-outlook>5.2 Outlook</a></li></ul></li><li><a href=#references>References</a><ul><li><a href=#reference-blogs>Reference Blogs</a></li></ul></li><li><a href=#citation>Citation</a></li></ul></nav></div></details></div><div class=post-content><h2 id=abstract>Abstract<a hidden class=anchor aria-hidden=true href=#abstract>#</a></h2><p>The stock market is a crucial component of the financial market. In recent years, the stock market has flourished, attracting researchers from various fields to study stock price prediction and quantitative investment strategies. With the development of artificial intelligence and machine learning in recent years, scholars have transitioned from traditional statistical models to AI algorithms. Particularly, after the surge of deep learning, neural networks have achieved commendable results in stock price prediction and quantitative investment strategy research. The goal of deep learning is to learn multi-level features by combining low-level features to construct abstract high-level features, thereby mining the distributed feature representations of data and performing complex nonlinear modeling based on this to accomplish prediction tasks. Among these, RNNs are widely applied to sequential data such as natural language and speech. Daily stock prices and trading information are sequential data; therefore, many researchers have previously used RNNs to predict stock prices. However, basic recurrent neural networks suffer from the vanishing gradient problem when the number of layers is too large, a problem that the emergence of LSTM solved. Subsequently, variants of LSTM such as GRU, Peephole LSTM, and BiLSTM appeared. Traditional stock prediction models often overlook the temporal factors or only consider unidirectional temporal relationships. Therefore, this paper employs the BiLSTM model for stock price prediction. From a theoretical perspective, the BiLSTM model fully utilizes the contextual relationships in both forward and backward temporal directions in time series, avoiding the vanishing and exploding gradient problems in long sequences, and better learning information with long-term dependencies.</p><p>The first part of this paper&rsquo;s experiment establishes stock prediction models using LSTM, GRU, and BiLSTM based on stock data from China’s Shanghai Pudong Development Bank and the foreign company IBM, respectively. By comparing the prediction results of these three deep learning models, it was found that the BiLSTM model outperforms the other models on both datasets, achieving higher prediction accuracy. The second part uses stock data from the entire A-share market and first applies the LightGBM model to screen 50 factors, selecting the top 10 most important factors. Subsequently, the BiLSTM model is used to select and combine these factors to establish a quantitative investment strategy. Finally, empirical tests and backtesting demonstrate that this strategy outperforms the market benchmark index, illustrating the practical application value of the BiLSTM model in stock price prediction and quantitative investment.</p><p><strong>Keywords</strong>: Quantitative Investment; Deep Learning; Neural Network Models; Multi-Factor Stock Selection; BiLSTM</p><h2 id=chapter-1-introduction>Chapter 1: Introduction<a hidden class=anchor aria-hidden=true href=#chapter-1-introduction>#</a></h2><h3 id=11-research-background-and-significance>1.1 Research Background and Significance<a hidden class=anchor aria-hidden=true href=#11-research-background-and-significance>#</a></h3><h4 id=111-research-background>1.1.1 Research Background<a hidden class=anchor aria-hidden=true href=#111-research-background>#</a></h4><p>Since its gradual emergence in the 1970s, quantitative investment has entered the view of various investors, initiating a new revolution that changed the previously dominated landscape of passive management and the Efficient Market Hypothesis (EMH) in portfolio management. The EMH posits that under the premise of market efficiency, stock prices reflect all available information, and no excess returns exist. Passive investment management is based on the belief that markets are efficient, focusing more on asset classes. The most common method is purchasing index funds and tracking the performance of published indices. In contrast, active investment management primarily relies on investors&rsquo; subjective judgments about the market and individual stocks, using publicly available data and applying mathematical models in the financial field to evaluate stocks and construct investment portfolios to achieve returns. Quantitative investment, which involves statistical processing of large amounts of historical data to uncover investment opportunities and eliminate subjective factors, has been increasingly favored by investors. Since the rise of quantitative investment, various technologies have been employed to predict stock prices better and establish quantitative investment strategies. Early scholars domestically and internationally used statistical methods for modeling stock price prediction, such as the moving average method, multiple regression, and autoregressive integrated moving average (ARIMA) models. However, due to the numerous factors influencing the stock market and the large volume of data, stock prediction is highly challenging, and the predictive performance of these statistical models is often unsatisfactory.</p><p>In recent years, related technologies like machine learning, deep learning, and neural networks have continuously developed, providing technical support for stock price prediction and the construction of quantitative strategies. Many scholars have achieved breakthroughs using methods such as random forests, neural networks, support vector machines, and convolutional neural networks. The ample historical data in the stock market, combined with diverse technical support, provides favorable conditions for stock price prediction and the construction of quantitative strategies.</p><h4 id=112-research-significance>1.1.2 Research Significance<a hidden class=anchor aria-hidden=true href=#112-research-significance>#</a></h4><p>From the perspective of the national economic system and the long-term development of financial markets, research on stock price prediction models and quantitative investment strategies is indispensable. China started relatively late, and its financial markets are not yet mature, with insufficient financial instruments and lower market efficiency. However, in recent years, the government has gradually relaxed policies and vigorously developed financial markets, providing a &ldquo;fertile ground&rdquo; for the development of quantitative investment and emerging financial technologies. Developing quantitative investment and new financial technologies can offer opportunities for China&rsquo;s financial markets to achieve leapfrog growth. Moreover, stock price indices, as important economic indicators, act as barometers for China&rsquo;s economic development.</p><p>From the perspective of individual and institutional investors, constructing stock price prediction models and quantitative investment strategy models enhances market efficiency. Individual investors often lack sufficient professional knowledge, leading to somewhat blind investment behaviors. Constructing relevant models to provide references can reduce the probability of judgment errors and change the relatively disadvantaged position of individual investors in the capital market. For institutional investors, rational and objective models combined with personal judgment improve decision accuracy and provide new directions for investment activities.</p><p>In summary, considering China&rsquo;s current development status, this paper selects individual stocks for stock price prediction models and the entire A-share market for quantitative strategy research, which holds significant practical research significance.</p><h3 id=12-literature-review>1.2 Literature Review<a hidden class=anchor aria-hidden=true href=#12-literature-review>#</a></h3><p><a href=https://pages.cs.wisc.edu/~dyer/cs540/handouts/deep-learning-nature2015.pdf>White (1988)</a>$^{[1]}$ used BP neural networks to predict IBM’s daily returns. However, due to the BP neural network model being susceptible to gradient explosion, the model could not converge to the global minimum, resulting in inaccurate predictions.</p><p><a href=https://web.ist.utl.pt/adriano.simoes/tese/referencias/Papers%20-%20Adriano/NN.pdf>Kimoto (1990)</a>$^{[2]}$ developed a system for forecasting the Tokyo Stock Exchange Prices Indexes (TOPIX) using modular neural network technology. The system not only successfully predicted TOPIX but also achieved a certain level of profitability through simulated stock trading based on the prediction results.</p><p><a href=https://dl.icdst.org/pdfs/files/2c442c738bd6bc178e715f400bec5d5f.pdf>G. Peter Zhang (2003)</a>$^{[3]}$ conducted a comparative study on the performance of the Autoregressive Integrated Moving Average (ARIMA) model and the Artificial Neural Network (ANN) model in time series forecasting. The results showed that the ANN model significantly outperformed the ARIMA model in time series prediction accuracy.</p><p><a href=https://ieeexplore.ieee.org/document/7550882>Ryo Akita (2016)</a>$^{[4]}$ selected consumer price indices, price-earnings ratios, and various events from newspapers as features. Using paragraph vectors and LSTM networks, a financial time series prediction model was constructed. Empirical data from fifty listed companies on the Tokyo Stock Exchange validated the model&rsquo;s effectiveness in predicting stock opening prices.</p><p><a href=https://www.ai-gakkai.or.jp/jsai2017/webprogram/2017/pdf/1112.pdf>Kunihiro Miyazaki (2017)</a>$^{[5]}$ constructed a model for predicting the rise and fall of the Topix Core 30 index and its constituent stocks by extracting daily stock chart images and 30-minute stock price data. The study compared various models, including Logistic Regression (LR), Random Forest (RF), Multilayer Perceptron (MLP), LSTM, CNN, PCA-CNN, and CNN-LSTM. The results indicated that LSTM had the best predictive performance, CNN performed moderately, and hybrid models combining CNN and LSTM could enhance prediction accuracy.</p><p><a href="https://journals.plos.org/plosone/article/file?id=10.1371/journal.pone.0212320&amp;type=printable">Taewook Kim (2019)</a>$^{[6]}$ proposed a hybrid LSTM-CNN model that combines features from stock price time series and stock price images to predict the S&amp;P 500 index. The study demonstrated that the LSTM-CNN model outperformed single models in stock price prediction and that such predictions hold practical significance for constructing quantitative investment strategies.</p><h3 id=13-innovations-of-the-paper>1.3 Innovations of the Paper<a hidden class=anchor aria-hidden=true href=#13-innovations-of-the-paper>#</a></h3><p>This paper presents the following innovations in stock prediction:</p><ol><li><p><strong>Diverse Market Data Usage</strong>: It separately uses data from China’s A-share Shanghai Pudong Development Bank and the foreign stock IBM, avoiding the limitations of studying a single market. Traditional BP models have never considered temporal factors, and models like LSTM only consider unidirectional temporal relationships. Therefore, this paper employs the BiLSTM model for stock price prediction. Theoretically, the BiLSTM model fully utilizes contextual relationships in both forward and backward temporal directions in time series, avoiding the vanishing and exploding gradient problems in long sequences, and better learning information with long-term dependencies. Empirical comparisons with LSTM and GRU models demonstrate its ability to enhance prediction accuracy.</p></li><li><p><strong>Multi-Feature Stock Price Prediction</strong>: The stock price prediction model trains on multiple features, including opening price, closing price, highest price, and trading volume. Compared to single-feature prediction of closing prices, this approach is theoretically more accurate and better facilitates the comparison of prediction effects among LSTM, GRU, and BiLSTM models.</p></li></ol><p>In terms of quantitative strategy research, this paper presents the following innovations:</p><ol><li><p><strong>Custom Factor Selection</strong>: Instead of using commonly available market factors, it employs multiple price and volume factors derived through Genetic Programming (GP) and manual data mining. The LightGBM model is then used to select the top 10 most important factors from an initial set of 50 factors.</p></li><li><p><strong>BiLSTM-Based Factor Combination</strong>: Traditional quantitative investment models generally use LSTM and CNN models to build investment strategies. This paper utilizes data from the entire A-share market and employs the BiLSTM model for factor combination to establish a quantitative investment strategy. Empirical tests and backtesting show that this strategy outperforms the market benchmark index (CSI All Share Index), indicating the practical application value of the BiLSTM model in stock price prediction and quantitative investment.</p></li></ol><h3 id=14-research-framework>1.4 Research Framework<a hidden class=anchor aria-hidden=true href=#14-research-framework>#</a></h3><p>This paper conducts stock price prediction and quantitative strategy research based on deep learning algorithms. The specific research framework is shown in Fig. 1:</p><figure class=align-center><img loading=lazy src=Research%20Framework.svg#center alt="Fig. 1. Research Framework."><figcaption><p>Fig. 1. Research Framework.</p></figcaption></figure><p>The specific research framework content is as follows:</p><ul><li><p><strong>Chapter 1: Introduction</strong>. This chapter first introduces the research significance and background of stock price prediction and quantitative strategy research. It then reviews the current research status, outlines the innovations of this paper compared to existing research, and briefly describes the research framework.</p></li><li><p><strong>Chapter 2: Theoretical Foundations</strong>. This chapter introduces the deep learning models and the fundamental theories of quantitative stock selection involved in this research. The subsection on deep learning models sequentially introduces RNN, LSTM, GRU, and BiLSTM, with a focus on the internal structure of the LSTM model. The subsection on quantitative stock selection theory sequentially introduces the Mean-Variance Model, Capital Asset Pricing Model (CAPM), Arbitrage Pricing Theory (APT), Multi-Factor Models, and the Fama-French Three-Factor and Five-Factor Models. This subsection outlines the development of multi-factor quantitative stock selection from various financial theories and model development trajectories.</p></li><li><p><strong>Chapter 3: Comparative Study of LSTM, GRU, and BiLSTM in Stock Price Prediction</strong>. This chapter first introduces the domestic and foreign stock datasets used in the experiments, followed by data normalization and preprocessing steps. It then describes the network structures, model compilation, and hyperparameter settings of the LSTM, GRU, and BiLSTM models used in this chapter, and presents experimental results. Finally, it analyzes the experimental results and concludes the chapter.</p></li><li><p><strong>Chapter 4: Research on LightGBM-BiLSTM-Based Quantitative Investment Models</strong>. This chapter first provides an overview of the experimental steps, followed by a detailed introduction of the stock and factor data used in the experiments. It then performs factor cleaning steps, including handling missing values, outlier removal, factor normalization, and factor neutralization. Subsequently, it uses the LightGBM model for factor selection and the BiLSTM model for factor combination. Finally, it constructs a quantitative investment strategy based on the obtained models and conducts backtesting.</p></li><li><p><strong>Chapter 5: Conclusion and Outlook</strong>. This chapter summarizes the main research content regarding stock price prediction and quantitative investment strategies. It then discusses the current research limitations and provides prospects for future research directions.</p></li></ul><h2 id=chapter-2-theoretical-foundations>Chapter 2: Theoretical Foundations<a hidden class=anchor aria-hidden=true href=#chapter-2-theoretical-foundations>#</a></h2><h3 id=21-deep-learning-models>2.1 Deep Learning Models<a hidden class=anchor aria-hidden=true href=#21-deep-learning-models>#</a></h3><h4 id=211-rnn>2.1.1 RNN<a hidden class=anchor aria-hidden=true href=#211-rnn>#</a></h4><p>Recurrent Neural Networks (RNNs) are widely applied to sequential data such as natural language and speech. Daily stock prices and trading information are sequential data; therefore, many previous studies have used RNNs to predict stock prices. RNNs employ a simple repetitive module in a chain-like structure, such as a single tanh layer. However, basic RNNs encounter the vanishing gradient problem when the number of layers becomes too large, a problem that the emergence of LSTM resolved. Fig. 2 is the RNN structure diagram.</p><figure class=align-center><img loading=lazy src=RNN.png#center alt="Fig. 2. RNN Structure Diagram. (Image source: Understanding LSTM Networks)"><figcaption><p>Fig. 2. RNN Structure Diagram. (Image source: <a href=http://colah.github.io/posts/2015-08-Understanding-LSTMs/>Understanding LSTM Networks</a>)</p></figcaption></figure><h4 id=212-lstm>2.1.2 LSTM<a hidden class=anchor aria-hidden=true href=#212-lstm>#</a></h4><p>Long Short-Term Memory (LSTM) networks are a special type of RNN capable of learning long-term dependencies. They were proposed by <a href=https://www.bioinf.jku.at/publications/older/2604.pdf>Hochreiter & Schmidhuber (1997)</a>$^{[7]}$ and have been improved and popularized by many subsequent works. Due to their unique design structure, LSTMs are relatively insensitive to sequence length and solve the vanishing and exploding gradient problems inherent in traditional RNNs. Compared to traditional RNNs and other time series models like Hidden Markov Models (HMMs), LSTMs can better handle and predict significant events in time series with long intervals and delays. Consequently, LSTMs are widely used in machine translation and speech recognition fields.</p><p>LSTMs are explicitly designed to avoid the long-term dependency problem. All recurrent neural networks have a chain-like structure of repeated network modules, whereas LSTMs modify the RNN structure. Instead of using a single neural network layer, LSTMs use a special four-layer structure that interacts in a unique way.</p><figure class=align-center><img loading=lazy src=LSTM.png#center alt="Fig. 3. LSTM Structure Diagram 1. (Image source: Understanding LSTM Networks)"><figcaption><p>Fig. 3. LSTM Structure Diagram 1. (Image source: <a href=http://colah.github.io/posts/2015-08-Understanding-LSTMs/>Understanding LSTM Networks</a>)</p></figcaption></figure><figure class=align-center><img loading=lazy src=LSTM2.png#center alt="Fig. 4. LSTM Structure Diagram 2. (Image source: Understanding LSTM Networks)"><figcaption><p>Fig. 4. LSTM Structure Diagram 2. (Image source: <a href=http://colah.github.io/posts/2015-08-Understanding-LSTMs/>Understanding LSTM Networks</a>)</p></figcaption></figure><p>As shown in Fig. 3, the black lines represent the transmission of a node&rsquo;s output vector to another node&rsquo;s input vector. The Neural Network Layer is a processing module with a $\sigma$ activation function or tanh activation function; Pointwise Operation represents element-wise multiplication between vectors; Vector Transfer indicates the direction of information transmission; Concatenate and Copy are represented by two black lines merging together and separating, respectively, indicating the merging and copying of information.</p><p>Below, we detail the structure of an LSTM using the following components:</p><ol><li><strong>Forget Gate</strong></li></ol><figure class=align-center><img loading=lazy src=forget_gate.png#center alt="Fig. 5. Forget Gate Calculation (Image source: Understanding LSTM Networks)"><figcaption><p>Fig. 5. Forget Gate Calculation (Image source: <a href=http://colah.github.io/posts/2015-08-Understanding-LSTMs/>Understanding LSTM Networks</a>)</p></figcaption></figure>$$
f_{t} = \sigma\left(W_{f} \cdot \left[h_{t-1}, x_{t}\right] + b_{f}\right)
$$<p><strong>Parameter Description:</strong></p><ul><li>$h_{t-1}$: Output from the previous time step</li><li>$x_{t}$: Input at the current time step</li><li>$\sigma$: Sigmoid activation function</li><li>$W_{f}$: Weight matrix for the forget gate</li><li>$b_{f}$: Bias vector parameter for the forget gate</li></ul><p>The first step, as shown in Fig. 5, is the process of deciding which information to discard from the cell state. This is determined by computing $f_{t}$ using the sigmoid function (where $f_{t}$ ranges between 0 and 1, with 0 meaning completely blocked and 1 meaning completely passed) to decide whether to allow the previous cell state $C_{t-1}$ to pass through or be partially allowed.</p><ol start=2><li><strong>Input Gate</strong></li></ol><figure class=align-center><img loading=lazy src=input_gate1.png#center alt="Fig. 6. Input Gate Calculation (Image source: Understanding LSTM Networks)"><figcaption><p>Fig. 6. Input Gate Calculation (Image source: <a href=http://colah.github.io/posts/2015-08-Understanding-LSTMs/>Understanding LSTM Networks</a>)</p></figcaption></figure>$$
\begin{aligned}
i_{t} &= \sigma\left(W_{i} \cdot \left[h_{t-1}, x_{t}\right] + b_{i}\right) \\
\tilde{C}_{t} &= \tanh\left(W_{C} \cdot \left[h_{t-1}, x_{t}\right] + b_{C}\right)
\end{aligned}
$$<p><strong>Parameter Description:</strong></p><ul><li>$h_{t-1}$: Output from the previous time step</li><li>$x_{t}$: Input at the current time step</li><li>$\sigma$: Sigmoid activation function</li><li>$W_{i}$: Weight matrix for the input gate</li><li>$b_{i}$: Bias vector parameter for the input gate</li><li>$W_{C}$: Weight matrix for the cell state</li><li>$b_{C}$: Bias vector parameter for the cell state</li><li>$\tanh$: Tanh activation function</li></ul><p>The second step, as shown in Fig. 6, involves using the sigmoid function to determine what information to store in the cell state. Subsequently, a $\tanh$ layer creates the candidate vector $\tilde{C}_{t}$, which will be added to the cell state.</p><figure class=align-center><img loading=lazy src=input_gate2.png#center alt="Fig. 7. Current Cell State Calculation (Image source: Understanding LSTM Networks)"><figcaption><p>Fig. 7. Current Cell State Calculation (Image source: <a href=http://colah.github.io/posts/2015-08-Understanding-LSTMs/>Understanding LSTM Networks</a>)</p></figcaption></figure>$$
C_{t} = f_{t} * C_{t-1} + i_{t} * \tilde{C}_{t}
$$<p><strong>Parameter Description:</strong></p><ul><li>$C_{t-1}$: Cell state from the previous time step</li><li>$\tilde{C}_{t}$: Candidate cell state</li><li>$i_{t}$: Value of the input gate</li><li>$f_{t}$: Value of the forget gate</li></ul><p>The third step, as shown in Fig. 7, calculates the current cell state $C_t$ by combining the effects of the forget gate and the input gate.</p><ul><li>The forget gate $f_t$ weights the previous cell state $C_{t-1}$ to discard unnecessary information.</li><li>The input gate $i_t$ weights the candidate cell state $\tilde{C}_t$ to determine how much new information to introduce.
Finally, the two parts are added together to update the current cell state $C_t$.</li></ul><ol start=3><li><strong>Output Gate</strong></li></ol><figure class=align-center><img loading=lazy src=output_gate.png#center alt="Fig. 8. Output Gate Calculation (Image source: Understanding LSTM Networks)"><figcaption><p>Fig. 8. Output Gate Calculation (Image source: <a href=http://colah.github.io/posts/2015-08-Understanding-LSTMs/>Understanding LSTM Networks</a>)</p></figcaption></figure>$$
\begin{aligned}
o_{t} &= \sigma\left(W_{o} \cdot \left[h_{t-1}, x_{t}\right] + b_{o}\right) \\
h_{t} &= o_{t} * \tanh\left(C_{t}\right)
\end{aligned}
$$<p><strong>Parameter Description:</strong></p><ul><li>$o_{t}$: Value of the output gate</li><li>$\sigma$: Sigmoid activation function</li><li>$W_{o}$: Weight matrix for the output gate</li><li>$h_{t-1}$: Output from the previous time step</li><li>$x_{t}$: Input at the current time step</li><li>$b_{o}$: Bias vector parameter for the output gate</li><li>$h_{t}$: Output at the current time step</li><li>$\tanh$: Tanh activation function</li><li>$C_{t}$: Current cell state</li></ul><p>The fourth step, as shown in Fig. 8, uses the sigmoid function to calculate the output gate&rsquo;s value. Finally, the cell state $C_t$ at this time step is processed through the tanh activation function and multiplied by the output gate&rsquo;s value $o_t$ to obtain the current output $h_t$.</p><h4 id=213-gru>2.1.3 GRU<a hidden class=anchor aria-hidden=true href=#213-gru>#</a></h4><p><a href=https://arxiv.org/abs/1406.1078>K. Cho (2014)</a>$^{[8]}$ proposed the Gated Recurrent Unit (GRU). GRU primarily simplifies and adjusts LSTM by merging LSTM&rsquo;s original forget gate, input gate, and output gate into an update gate and a reset gate. Additionally, GRU combines the cell state with the hidden state, reducing model complexity while still achieving performance comparable to LSTM on certain tasks.</p><p>This model can save considerable time when training on larger datasets and demonstrates better performance on some smaller and less frequent datasets$^{[9][10]}$.</p><figure class=align-center><img loading=lazy src=GRU.png#center alt="Fig. 9. GRU Structure Diagram (Image source: Understanding LSTM Networks)"><figcaption><p>Fig. 9. GRU Structure Diagram (Image source: <a href=http://colah.github.io/posts/2015-08-Understanding-LSTMs/>Understanding LSTM Networks</a>)</p></figcaption></figure>$$
\begin{aligned}
z_{t} &= \sigma\left(W_{z} \cdot \left[h_{t-1}, x_{t}\right]\right) \\
r_{t} &= \sigma\left(W_{r} \cdot \left[h_{t-1}, x_{t}\right]\right) \\
\tilde{h}_{t} &= \tanh\left(W \cdot \left[r_{t} * h_{t-1}, x_{t}\right]\right) \\
h_{t} &= \left(1 - z_{t}\right) * h_{t-1} + z_{t} * \tilde{h}_{t}
\end{aligned}
$$<p><strong>Parameter Description:</strong></p><ul><li>$z_{t}$: Value of the update gate</li><li>$r_{t}$: Value of the reset gate</li><li>$W_{z}$: Weight matrix for the update gate</li><li>$W_{r}$: Weight matrix for the reset gate</li><li>$\tilde{h}_{t}$: Candidate hidden state</li></ul><h4 id=214-bilstm>2.1.4 BiLSTM<a hidden class=anchor aria-hidden=true href=#214-bilstm>#</a></h4><p>Bidirectional Long Short-Term Memory (BiLSTM) networks combine forward and backward LSTMs. The BiLSTM model fully utilizes the contextual relationships in both forward and backward temporal directions in time series, enabling the learning of information with long-term dependencies. Compared to unidirectional LSTM, BiLSTM can better consider the reverse influence of future data. Fig. 10 is the BiLSTM structure diagram.</p><figure class=align-center><img loading=lazy src=BiLSTM.png#center alt="Fig. 10. BiLSTM Structure Diagram. (Image source: Baeldung)"><figcaption><p>Fig. 10. BiLSTM Structure Diagram. (Image source: <a href=https://www.baeldung.com/cs/bidirectional-vs-unidirectional-lstm>Baeldung</a>)</p></figcaption></figure><h3 id=22-quantitative-stock-selection-theory>2.2 Quantitative Stock Selection Theory<a hidden class=anchor aria-hidden=true href=#22-quantitative-stock-selection-theory>#</a></h3><h4 id=221-mean-variance-model>2.2.1 Mean-Variance Model<a hidden class=anchor aria-hidden=true href=#221-mean-variance-model>#</a></h4><p>The quantitative stock selection strategy originated in the 1950s when <a href=https://www.jstor.org/stable/2975974>Markowitz (1952)</a>$^{[11]}$ proposed the Mean-Variance Model. This model not only laid the foundation for modern portfolio theory by quantifying investment risk but also established a specific model describing risk and expected return. It broke the previous situation of only qualitative analysis of portfolios without quantitative analysis, successfully introducing mathematical models into the financial investment field.</p>$$
\begin{aligned}
\mathrm{E}\left(R_{p}\right) &= \sum_{i=1}^{n} w_{i} \mathrm{E}\left(R_{i}\right) \\
\sigma_{p}^{2} &= \sum_{i=1}^{n} \sum_{j=1}^{n} w_{i} w_{j} \operatorname{Cov}\left(R_{i}, R_{j}\right) = \sum_{i=1}^{n} \sum_{j=1}^{n} w_{i} w_{j} \sigma_{i} \sigma_{j} \rho_{ij} \\
\sigma_{i} &= \sqrt{\operatorname{Var}\left(R_{i}\right)}, \quad \rho_{ij} = \operatorname{Corr}\left(R_{i}, R_{j}\right)
\end{aligned}
$$$$
\min \sigma_{p}^{2} \quad \text{subject to} \quad \sum_{i=1}^{n} \mathrm{E}\left(R_{i}\right) w_{i} = \mu_{p}, \quad \sum_{i=1}^{n} w_{i} = 1
$$$$
\begin{aligned}
\Omega &= \begin{pmatrix}
\sigma_{11} & \cdots & \sigma_{1n} \\
\vdots & \ddots & \vdots \\
\sigma_{n1} & \cdots & \sigma_{nn}
\end{pmatrix} = \begin{pmatrix}
\operatorname{Var}\left(R_{1}\right) & \cdots & \operatorname{Cov}\left(R_{1}, R_{n}\right) \\
\vdots & \ddots & \vdots \\
\operatorname{Cov}\left(R_{n}, R_{1}\right) & \cdots & \operatorname{Var}\left(R_{n}\right)
\end{pmatrix} \\
\Omega^{-1} &= \begin{pmatrix}
v_{11} & \cdots & v_{1n} \\
\vdots & \ddots & \vdots \\
v_{n1} & \cdots & v_{nn}
\end{pmatrix} \\
w_{i} &= \frac{1}{D}\left(\mu_{p} \sum_{j=1}^{n} v_{ij}\left(C \mathrm{E}\left(R_{j}\right) - A\right) + \sum_{j=1}^{n} v_{ij}\left(B - A \mathrm{E}\left(R_{j}\right)\right)\right), \quad i = 1, \ldots, n
\end{aligned}
$$$$
\begin{aligned}
A &= \sum_{i=1}^{n} \sum_{j=1}^{n} v_{ij} \mathrm{E}\left(R_{j}\right), \quad B = \sum_{i=1}^{n} \sum_{j=1}^{n} v_{ij} \mathrm{E}\left(R_{i}\right) \mathrm{E}\left(R_{j}\right), \quad C = \sum_{i=1}^{n} \sum_{j=1}^{n} v_{ij}, \quad D = BC - A^{2} > 0 \\
\sigma_{p}^{2} &= \frac{C \mu_{p}^{2} - 2A \mu_{p} + B}{D}
\end{aligned}
$$<p><strong>Where:</strong></p><ul><li>$\mathrm{E}\left(R_{p}\right)$ and $\mu_{p}$ are the expected return of portfolio $p$</li><li>$\mathrm{E}\left(R_{i}\right)$ is the expected return of asset $i$</li><li>$\sigma_{i}$ is the standard deviation of asset $i$</li><li>$\sigma_{j}$ is the standard deviation of asset $j$</li><li>$w_{i}$ is the weight of asset $i$ in the portfolio</li><li>$\sigma_{p}^{2}$ is the variance of portfolio $p$</li><li>$\rho_{ij}$ is the correlation coefficient between assets $i$ and $j$</li></ul><p>Using the above formulas$^{[12]}$, we can construct an investment portfolio that minimizes non-systematic risk under a given expected return condition.</p><h4 id=222-capital-asset-pricing-model>2.2.2 Capital Asset Pricing Model<a hidden class=anchor aria-hidden=true href=#222-capital-asset-pricing-model>#</a></h4><p><a href=https://www.jstor.org/stable/2977928>William Sharpe (1964)</a>$^{[13]}$, <a href=https://www.jstor.org/stable/1924119>John Lintner (1965)</a>$^{[14]}$, and <a href=https://www.jstor.org/stable/1910098>Jan Mossin (1966)</a>$^{[15]}$ proposed the Capital Asset Pricing Model (CAPM). This model posits that the expected return of an asset is related to its risk measure, the $\beta$ value. The model connects the expected return rate of an asset with market risk through a simple linear relationship, making Markowitz&rsquo;s (1952) portfolio selection theory more applicable to the real world and laying the theoretical foundation for multi-factor stock selection models.</p><p>According to the CAPM, for a given asset $i$, the relationship between its expected return and the expected return of the market portfolio can be expressed as:</p>$$
E\left(r_{i}\right) = r_{f} + \beta_{im}\left[E\left(r_{m}\right) - r_{f}\right]
$$<p><strong>Where:</strong></p><ul><li>$E\left(r_{i}\right)$ is the expected return of asset $i$</li><li>$r_{f}$ is the risk-free rate</li><li>$\beta_{im}$ (Beta) is the systematic risk coefficient of asset $i$, $\beta_{im} = \frac{\operatorname{Cov}\left(r_{i}, r_{m}\right)}{\operatorname{Var}\left(r_{m}\right)}$</li><li>$E\left(r_{m}\right)$ is the expected return of the market portfolio $m$</li><li>$E\left(r_{m}\right) - r_{f}$ is the market risk premium factor</li></ul><h4 id=223-arbitrage-pricing-theory-and-multi-factor-models>2.2.3 Arbitrage Pricing Theory and Multi-Factor Models<a hidden class=anchor aria-hidden=true href=#223-arbitrage-pricing-theory-and-multi-factor-models>#</a></h4><p><a href=https://www.top1000funds.com/wp-content/uploads/2014/05/The-Arbitrage-Theory-of-Capital-Asset-Pricing.pdf>Ross (1976)</a>$^{[16]}$ proposed the Arbitrage Pricing Theory (APT). This theory asserts that arbitrage activities are the decisive factor in forming market equilibrium prices. By introducing a series of factors into the process of return formation and constructing linear relationships, APT overcomes the limitations of the Capital Asset Pricing Model (CAPM) and provides important theoretical guidance for subsequent researchers.</p><p>APT is considered the theoretical foundation of Multi-Factor Models (MFM), an essential component of asset pricing models and one of the cornerstones of asset pricing theory. The general expression of a multi-factor model is:</p>$$
r_{j} = a_{j} + \lambda_{j1} f_{1} + \lambda_{j2} f_{2} + \cdots + \lambda_{jn} f_{n} + \delta_{j}
$$<p><strong>Where:</strong></p><ul><li>$r_{j}$ is the return of asset $j$</li><li>$a_{j}$ is the constant term for asset $j$</li><li>$f_{n}$ are the systematic factors</li><li>$\lambda_{jn}$ are the factor loadings</li><li>$\delta_{j}$ is the random error</li></ul><h4 id=224-fama-french-three-factor-and-five-factor-models>2.2.4 Fama-French Three-Factor and Five-Factor Models<a hidden class=anchor aria-hidden=true href=#224-fama-french-three-factor-and-five-factor-models>#</a></h4><p><a href=https://www.bauer.uh.edu/rsusmel/phd/Fama-French_JFE93.pdf>Fama (1992) and French (1992)</a>$^{[17]}$ discovered through cross-sectional regressions combined with time series analysis that a stock’s $\beta$ value cannot explain the differences in returns among different stocks. However, factors such as a company’s market capitalization, book-to-market ratio, and price-earnings ratio can significantly explain the differences in stock returns. They concluded that excess returns compensate for risk factors not captured by the $\beta$ in CAPM, leading to the Fama-French Three-Factor Model. These three factors are:</p><ul><li><p><strong>Market Risk Premium Factor</strong></p><ul><li>Represents the overall systematic risk of the market, calculated as the expected return of the market portfolio minus the risk-free rate.</li><li>Measures the excess return investors expect for taking on systematic risk (risk that cannot be eliminated through diversification).</li><li>Calculation formula:<br>$$
\text{Market Risk Premium} = E(R_m) - R_f
$$
where $E(R_m)$ is the expected return of the market, and $R_f$ is the risk-free rate.</li></ul></li><li><p><strong>Size Factor (SMB: Small Minus Big)</strong></p><ul><li>Represents the return difference between small-cap and large-cap stocks.</li><li>Small-cap stocks generally carry higher risk but historically show higher expected returns than large-cap stocks.</li><li>Calculation formula:<br>$$
SMB = R_{\text{Small}} - R_{\text{Big}}
$$
Reflects the market’s compensation for the additional risk premium of small-cap stocks.</li></ul></li><li><p><strong>Book-to-Market Ratio Factor (HML: High Minus Low)</strong></p><ul><li>Reflects the return difference between high book-to-market (value) stocks and low book-to-market (growth) stocks.</li><li>High book-to-market stocks are typically undervalued by the market but may offer higher returns in the long run.</li><li>Calculation formula:<br>$$
HML = R_{\text{High}} - R_{\text{Low}}
$$
Low book-to-market stocks may be overvalued due to the market’s overly optimistic expectations.</li></ul></li></ul><p>This model specifies the factors in the APT model and concludes that investing in small-cap and high-growth stocks exhibits high-risk and high-return characteristics. The Fama-French Three-Factor Model is widely applied in modern investment behavior analysis and practice.</p><p>Subsequently, <a href=https://tevgeniou.github.io/EquityRiskFactors/bibliography/FiveFactor.pdf>Fama (2015) and French (2015)</a>$^{[18]}$ expanded the three-factor model by adding two more factors:</p><ul><li><p><strong>Profitability Factor (RMW: Robust Minus Weak)</strong></p><ul><li>Reflects the return difference between high-profitability and low-profitability companies.</li><li>Companies with strong profitability (high ROE, net profit margin) are more likely to provide stable and higher returns.</li><li>Calculation formula:<br>$$
RMW = R_{\text{Robust}} - R_{\text{Weak}}
$$</li></ul></li><li><p><strong>Investment Factor (CMA: Conservative Minus Aggressive)</strong></p><ul><li>Reflects the return difference between conservative and aggressive investment companies.</li><li>Aggressive companies (rapid expansion, high capital expenditure) usually carry greater operational risks, while conservative companies (steady capital expenditure) exhibit higher stability and returns.</li><li>Calculation formula:<br>$$
CMA = R_{\text{Conservative}} - R_{\text{Aggressive}}
$$</li></ul></li></ul><p>The Fama-French Three-Factor Model formula is:</p>$$
R_i - R_f = \alpha_i + \beta_{i,m} \cdot (R_m - R_f) + \beta_{i,SMB} \cdot SMB + \beta_{i,HML} \cdot HML + \epsilon_i
$$<p>The Fama-French Five-Factor Model formula is:</p>$$
R_i - R_f = \alpha_i + \beta_{i,m} \cdot (R_m - R_f) + \beta_{i,SMB} \cdot SMB + \beta_{i,HML} \cdot HML + \beta_{i,RMW} \cdot RMW + \beta_{i,CMA} \cdot CMA + \epsilon_i
$$<p><strong>Where:</strong></p><ul><li>$R_i$: Expected return of stock $i$</li><li>$R_f$: Risk-free rate</li><li>$R_m$: Expected return of the market portfolio</li><li>$R_m - R_f$: Market risk premium factor</li><li>$SMB$: Size factor (Small Minus Big)</li><li>$HML$: Book-to-market ratio factor (High Minus Low)</li><li>$RMW$: Profitability factor (Robust Minus Weak)</li><li>$CMA$: Investment factor (Conservative Minus Aggressive)</li><li>$\beta_{i,*}$: Sensitivity of stock $i$ to the corresponding factor</li><li>$\epsilon_i$: Regression residual</li></ul><h4 id=225-model-comparison-tables>2.2.5 Model Comparison Tables<a hidden class=anchor aria-hidden=true href=#225-model-comparison-tables>#</a></h4><h5 id=table-21-comparison-of-models>Table 2.1: Comparison of Models<a hidden class=anchor aria-hidden=true href=#table-21-comparison-of-models>#</a></h5><p>The following table summarizes the core content and factor sources of the <strong>Mean-Variance Model</strong>, <strong>Capital Asset Pricing Model (CAPM)</strong>, <strong>Arbitrage Pricing Theory (APT)</strong>, and <strong>Fama-French Models</strong>:</p><table><thead><tr><th><strong>Model</strong></th><th><strong>Core Content</strong></th><th><strong>Factor Sources</strong></th></tr></thead><tbody><tr><td><strong>Mean-Variance Model</strong></td><td>Foundation of portfolio theory, optimizing portfolios through expected returns and covariance matrices.</td><td>Expected returns and covariance matrices of portfolio assets</td></tr><tr><td><strong>Capital Asset Pricing Model (CAPM)</strong></td><td>Explains asset returns through market risk factor ($\beta$), laying the theoretical foundation for multi-factor models.</td><td>Market factor $\beta$</td></tr><tr><td><strong>Arbitrage Pricing Theory (APT)</strong></td><td>Multi-factor framework allowing multiple economic variables (e.g., inflation rate, interest rate) to explain asset returns.</td><td>Multiple factors (macroeconomic variables like inflation rate, interest rate)</td></tr><tr><td><strong>Fama-French Three-Factor Model</strong></td><td>Enhances asset return explanation by adding size and book-to-market ratio factors.</td><td>Market factor, SMB (Size factor), HML (Book-to-Market ratio factor)</td></tr><tr><td><strong>Fama-French Five-Factor Model</strong></td><td>Further improves asset pricing by adding profitability and investment factors on top of the three-factor model.</td><td>Market factor, SMB, HML, RMW (Profitability factor), CMA (Investment factor)</td></tr></tbody></table><p>The following table summarizes the advantages and disadvantages of these models:</p><h5 id=table-22-comparison-of-model-advantages-and-disadvantages>Table 2.2: Comparison of Model Advantages and Disadvantages<a hidden class=anchor aria-hidden=true href=#table-22-comparison-of-model-advantages-and-disadvantages>#</a></h5><table><thead><tr><th><strong>Model</strong></th><th><strong>Advantages</strong></th><th><strong>Disadvantages</strong></th></tr></thead><tbody><tr><td><strong>Mean-Variance Model</strong></td><td>Provides a systematic method for portfolio optimization, laying the foundation for modern investment theory.</td><td>Optimizes only for returns and variance, without explicitly identifying sources of risk compensation.</td></tr><tr><td><strong>Capital Asset Pricing Model (CAPM)</strong></td><td>Simple to use, connects return differences to market risk, providing a theoretical foundation for multi-factor models.</td><td>Assumes a single factor (market risk) determines returns, ignoring other systematic risk factors.</td></tr><tr><td><strong>Arbitrage Pricing Theory (APT)</strong></td><td>Allows multiple factors to explain asset returns, reducing reliance on single-factor assumptions and offering greater flexibility.</td><td>Does not specify specific factors, making it less practical and only providing a framework.</td></tr><tr><td><strong>Fama-French Three-Factor Model</strong></td><td>Significantly improves the explanatory power of asset returns by adding size and book-to-market ratio factors.</td><td>Ignores other factors such as profitability and investment behaviors.</td></tr><tr><td><strong>Fama-French Five-Factor Model</strong></td><td>Further enhances asset pricing by incorporating profitability and investment factors, capturing key variables influencing asset returns more comprehensively.</td><td>Higher model complexity, greater data requirements, and potential omission of certain latent factors.</td></tr></tbody></table><h2 id=chapter-3-comparative-study-of-lstm-gru-and-bilstm-in-stock-price-prediction>Chapter 3: Comparative Study of LSTM, GRU, and BiLSTM in Stock Price Prediction<a hidden class=anchor aria-hidden=true href=#chapter-3-comparative-study-of-lstm-gru-and-bilstm-in-stock-price-prediction>#</a></h2><h3 id=31-introduction-of-experimental-data>3.1 Introduction of Experimental Data<a hidden class=anchor aria-hidden=true href=#31-introduction-of-experimental-data>#</a></h3><p>Many domestic and foreign studies focus primarily on their own stock indices, with relatively few studies examining individual stocks from different markets. Moreover, few studies have compared the performance of LSTM, GRU, and BiLSTM models. Therefore, this paper selects China&rsquo;s A-share Shanghai Pudong Development Bank (Pudong Bank, code 600000) and the US stock International Business Machines Corporation (IBM) for research, enabling a more accurate comparison of the three models used. For Pudong Bank, stock data from January 1, 2008, to December 31, 2020, comprising 3,114 valid data points, were sourced from the Tushare Financial Data Platform. The features selected for this dataset include date, opening price, closing price, highest price, lowest price, and trading volume. Except for the date, which serves as the time series index, the other five features are used as independent variables. For IBM, stock data from January 2, 1990, to November 15, 2018, comprising 7,278 valid data points, were sourced from Yahoo Finance. The features selected for this dataset include date, opening price, highest price, lowest price, closing price, adjusted closing price, and trading volume. Except for the date, which serves as the time series index, the other six features are used as independent variables. In this experiment, the closing price is chosen as the target variable. Tables 3.1 and 3.2 display partial data from the two datasets.</p><h4 id=table-31-partial-display-of-pudong-bank-dataset>Table 3.1: Partial Display of Pudong Bank Dataset<a hidden class=anchor aria-hidden=true href=#table-31-partial-display-of-pudong-bank-dataset>#</a></h4><table><thead><tr><th>Date</th><th>Open</th><th>Close</th><th>High</th><th>Low</th><th>Volume</th><th>Code</th></tr></thead><tbody><tr><td>2008-01-02</td><td>9.007</td><td>9.101</td><td>9.356</td><td>8.805</td><td>131,583.90</td><td>600000</td></tr><tr><td>2008-01-03</td><td>9.007</td><td>8.645</td><td>9.101</td><td>8.426</td><td>211,346.56</td><td>600000</td></tr><tr><td>2008-01-04</td><td>8659</td><td>9.009</td><td>9.111</td><td>8.501</td><td>139,249.67</td><td>600000</td></tr><tr><td>2008-01-07</td><td>8.970</td><td>9.515</td><td>9.593</td><td>8.953</td><td>228,043.01</td><td>600000</td></tr><tr><td>2008-01-08</td><td>9.551</td><td>9.583</td><td>9.719</td><td>9.517</td><td>161,255.31</td><td>600000</td></tr><tr><td>2008-01-09</td><td>9.583</td><td>9.663</td><td>9.772</td><td>9.432</td><td>102,510.92</td><td>600000</td></tr><tr><td>2008-01-10</td><td>9.701</td><td>9.680</td><td>9.836</td><td>9.602</td><td>217,966.25</td><td>600000</td></tr><tr><td>2008-01-11</td><td>9.670</td><td>10.467</td><td>10.532</td><td>9.670</td><td>231,544.21</td><td>600000</td></tr><tr><td>2008-01-14</td><td>10.367</td><td>10.059</td><td>10.433</td><td>10.027</td><td>142,918.39</td><td>600000</td></tr><tr><td>2008-01-15</td><td>10.142</td><td>10.051</td><td>10.389</td><td>10.006</td><td>161,221.52</td><td>600000</td></tr></tbody></table><p><strong>Data Source</strong>: <a href=https://github.com/waditu/tushare>Tushare</a></p><h4 id=table-32-partial-display-of-ibm-dataset>Table 3.2: Partial Display of IBM Dataset<a hidden class=anchor aria-hidden=true href=#table-32-partial-display-of-ibm-dataset>#</a></h4><table><thead><tr><th>Date</th><th>Open</th><th>High</th><th>Low</th><th>Close</th><th>Adj Close</th><th>Volume</th></tr></thead><tbody><tr><td>1990-01-02</td><td>23.6875</td><td>24.5313</td><td>23.6250</td><td>24.5000</td><td>6.590755</td><td>7,041,600</td></tr><tr><td>1990-01-03</td><td>24.6875</td><td>24.8750</td><td>24.5938</td><td>24.7188</td><td>6.649599</td><td>9,464,000</td></tr><tr><td>1990-01-04</td><td>24.7500</td><td>25.0938</td><td>24.7188</td><td>25.0000</td><td>6.725261</td><td>9,674,800</td></tr><tr><td>1990-01-05</td><td>24.9688</td><td>25.4063</td><td>24.8750</td><td>24.9375</td><td>6.708448</td><td>7,570,000</td></tr><tr><td>1990-01-08</td><td>24.8125</td><td>25.2188</td><td>24.8125</td><td>25.0938</td><td>6.750481</td><td>4,625,200</td></tr><tr><td>1990-01-09</td><td>25.1250</td><td>25.3125</td><td>24.8438</td><td>24.8438</td><td>6.683229</td><td>7,048,000</td></tr><tr><td>1990-01-10</td><td>24.8750</td><td>25.0000</td><td>24.6563</td><td>24.7500</td><td>6.658009</td><td>5,945,600</td></tr><tr><td>1990-01-11</td><td>24.8750</td><td>25.0938</td><td>24.8438</td><td>24.9688</td><td>6.716855</td><td>5,905,600</td></tr><tr><td>1990-01-12</td><td>24.6563</td><td>24.8125</td><td>24.4063</td><td>24.4688</td><td>6.582347</td><td>5,390,800</td></tr><tr><td>1990-01-15</td><td>24.4063</td><td>24.5938</td><td>24.3125</td><td>24.5313</td><td>6.599163</td><td>4,035,600</td></tr></tbody></table><p><strong>Data Source</strong>: <a href=https://finance.yahoo.com/quote/IBM/history/>Yahoo Finance</a></p><h3 id=32-data-preprocessing>3.2 Data Preprocessing<a hidden class=anchor aria-hidden=true href=#32-data-preprocessing>#</a></h3><h4 id=321-data-normalization>3.2.1 Data Normalization<a hidden class=anchor aria-hidden=true href=#321-data-normalization>#</a></h4><p>In the experiment, different features have varying units and magnitudes. For example, there is a significant magnitude difference between stock prices and trading volumes, which can impact the final prediction results. Therefore, the <code>MinMaxScaler</code> method from the <code>sklearn.preprocessing</code> library is used to scale the data features to the range of 0 to 1. This not only improves model accuracy but also enhances the model’s convergence speed. The normalization formula is:</p>$$
x^{\prime}=\frac{x-\min (x)}{\max (x)-\min (x)}
$$<p>Where $x^{\prime}$ is the normalized data, $x$ is the original data, $\min (x)$ is the minimum value of the original dataset, and $\max (x)$ is the maximum value of the original dataset. After obtaining the prediction results during the experiment, the data will be denormalized for stock price prediction and model evaluation.</p><h4 id=322-data-splitting>3.2.2 Data Splitting<a hidden class=anchor aria-hidden=true href=#322-data-splitting>#</a></h4><p>Here, the entire experimental datasets of Pudong Bank and IBM are input with a timestep of 60 for the recurrent kernels, and the number of input features per timestep is 5 and 6, respectively. This allows the model to input data from the previous 60 trading days to predict the closing price on the 61st day. This ensures that our dataset meets the input requirements of the three neural network models to be compared, namely the number of samples, the timestep length, and the number of input features per timestep. Subsequently, the Pudong Bank dataset is split into training, validation, and testing sets in a ratio of 2,488:311:255 after normalization. The IBM dataset is split into training, validation, and testing sets in a ratio of 6,550:364:304 after normalization. The purpose of the validation set here is to facilitate the adjustment of the model’s hyperparameters to optimize each model before comparison.</p><h3 id=33-model-network-structures>3.3 Model Network Structures<a hidden class=anchor aria-hidden=true href=#33-model-network-structures>#</a></h3><p>Through extensive experimentation, the network structures set for each model are as shown in the table below. Between layers, the default tanh and linear activation functions for recurrent neural networks are used, and Dropout with a dropout rate of 0.2 is added to prevent overfitting. Each recurrent layer in LSTM and GRU models has 50 neurons, while the BiLSTM recurrent layers have 100 neurons. Each LSTM, GRU, and BiLSTM model comprises four recurrent layers and one fully connected layer, with a Dropout layer between each network layer.</p><h4 id=table-33-lstm-network-structure-for-ibm>Table 3.3: LSTM Network Structure for IBM<a hidden class=anchor aria-hidden=true href=#table-33-lstm-network-structure-for-ibm>#</a></h4><table><thead><tr><th>Layer(type)</th><th>Output Shape</th><th>Param#</th></tr></thead><tbody><tr><td>lstm_1 (LSTM)</td><td>(None, 60, 50)</td><td>11,400</td></tr><tr><td>dropout_1 (Dropout)</td><td>(None, 60, 50)</td><td>0</td></tr><tr><td>lstm_2 (LSTM)</td><td>(None, 60, 50)</td><td>20,200</td></tr><tr><td>dropout_2 (Dropout)</td><td>(None, 60, 50)</td><td>0</td></tr><tr><td>lstm_3 (LSTM)</td><td>(None, 60, 50)</td><td>20,200</td></tr><tr><td>dropout_3 (Dropout)</td><td>(None, 60, 50)</td><td>0</td></tr><tr><td>lstm_4 (LSTM)</td><td>(None, 50)</td><td>20,200</td></tr><tr><td>dropout_4 (Dropout)</td><td>(None, 50)</td><td>0</td></tr><tr><td>dense_1 (Dense)</td><td>(None, 1)</td><td>51</td></tr></tbody></table><p><strong>Total params</strong>: 72,051<br><strong>Trainable params</strong>: 72,051<br><strong>Non-trainable params</strong>: 0</p><hr><h4 id=table-34-gru-network-structure-for-ibm>Table 3.4: GRU Network Structure for IBM<a hidden class=anchor aria-hidden=true href=#table-34-gru-network-structure-for-ibm>#</a></h4><table><thead><tr><th>Layer(type)</th><th>Output Shape</th><th>Param#</th></tr></thead><tbody><tr><td>gru_1 (GRU)</td><td>(None, 60, 50)</td><td>8,550</td></tr><tr><td>dropout_1 (Dropout)</td><td>(None, 60, 50)</td><td>0</td></tr><tr><td>gru_2 (GRU)</td><td>(None, 60, 50)</td><td>15,150</td></tr><tr><td>dropout_2 (Dropout)</td><td>(None, 60, 50)</td><td>0</td></tr><tr><td>gru_3 (GRU)</td><td>(None, 60, 50)</td><td>15,150</td></tr><tr><td>dropout_3 (Dropout)</td><td>(None, 60, 50)</td><td>0</td></tr><tr><td>gru_4 (GRU)</td><td>(None, 50)</td><td>15,150</td></tr><tr><td>dropout_4 (Dropout)</td><td>(None, 50)</td><td>0</td></tr><tr><td>dense_1 (Dense)</td><td>(None, 1)</td><td>51</td></tr></tbody></table><p><strong>Total params</strong>: 54,051<br><strong>Trainable params</strong>: 54,051<br><strong>Non-trainable params</strong>: 0</p><hr><h4 id=table-35-bilstm-network-structure-for-ibm>Table 3.5: BiLSTM Network Structure for IBM<a hidden class=anchor aria-hidden=true href=#table-35-bilstm-network-structure-for-ibm>#</a></h4><table><thead><tr><th>Layer(type)</th><th>Output Shape</th><th>Param#</th></tr></thead><tbody><tr><td>bidirectional_1 (Bidirectional)</td><td>(None, 100)</td><td>22,400</td></tr><tr><td>dropout_1 (Dropout)</td><td>(None, 100)</td><td>0</td></tr><tr><td>dense_1 (Dense)</td><td>(None, 256)</td><td>25,856</td></tr><tr><td>dropout_2 (Dropout)</td><td>(None, 256)</td><td>0</td></tr><tr><td>dense_2 (Dense)</td><td>(None, 64)</td><td>16,448</td></tr><tr><td>dense_3 (Dense)</td><td>(None, 1)</td><td>0</td></tr></tbody></table><p><strong>Total params</strong>: 66,769<br><strong>Trainable params</strong>: 66,769<br><strong>Non-trainable params</strong>: 0</p><h3 id=34-model-compilation-and-hyperparameter-settings>3.4 Model Compilation and Hyperparameter Settings<a hidden class=anchor aria-hidden=true href=#34-model-compilation-and-hyperparameter-settings>#</a></h3><p>After iterative tuning of hyperparameters aiming to minimize the loss function on the validation set, the following settings are chosen for the three models for Pudong Bank and IBM respectively: <code>epochs=100</code>, <code>batch_size=32</code> for Pudong Bank models and <code>epochs=50</code>, <code>batch_size=32</code> for IBM models. The optimizer used is Adaptive Moment Estimation (Adam)$^{[19]}$ with default settings in the <code>keras</code> package: <code>lr=0.001</code>, <code>beta_1=0.9</code>, <code>beta_2=0.999</code>, <code>epsilon=1e-08</code>, and <code>decay=0.0</code>. The loss function is Mean Squared Error (MSE).</p><p><strong>Parameter Descriptions:</strong></p><ul><li><code>lr</code>: Learning rate</li><li><code>beta_1</code>: Exponential decay rate for the first moment estimates</li><li><code>beta_2</code>: Exponential decay rate for the second moment estimates</li><li><code>epsilon</code>: Small constant for numerical stability</li><li><code>decay</code>: Learning rate decay per update</li></ul><h3 id=35-experimental-results-and-analysis>3.5 Experimental Results and Analysis<a hidden class=anchor aria-hidden=true href=#35-experimental-results-and-analysis>#</a></h3><p>First, a brief introduction to the evaluation metrics used for model assessment is provided. The calculation formulas are as follows:</p><ol><li><strong>Mean Squared Error (MSE)</strong>:</li></ol>$$
MSE=\frac{1}{n} \sum_{i=1}^{n}\left(Y_{i}-\hat{Y}_{i}\right)^{2}
$$<ol start=2><li><strong>Root Mean Squared Error (RMSE)</strong>:</li></ol>$$
RMSE=\sqrt{\frac{1}{n} \sum_{i=1}^{n}\left(Y_{i}-\hat{Y}_{i}\right)^{2}}
$$<ol start=3><li><strong>Mean Absolute Error (MAE)</strong>:</li></ol>$$
MAE=\frac{1}{n} \sum_{i=1}^{n}\left|Y_{i}-\hat{Y}_{i}\right|
$$<ol start=4><li><strong>\( R^2 \) (R Squared)</strong>:</li></ol>$$
\begin{gathered}
\bar{Y}=\frac{1}{n} \sum_{i=1}^{n} Y_{i} \\
R^{2}=1-\frac{\sum_{i=1}^{n}\left(Y_{i}-\hat{Y}_{i}\right)^{2}}{\sum_{i=1}^{n}\left(Y_{i}-\bar{Y}\right)^{2}}
\end{gathered}
$$<p>Where $n$ is the number of samples, $Y$ is the actual closing price, $\hat{Y}_{i}$ is the predicted closing price, and $\bar{Y}$ is the average closing price. Lower values of MSE, RMSE, and MAE indicate more accurate models. A higher $R^{2}$ indicates a better fit of the model coefficients.</p><h4 id=351-experimental-results-for-pudong-bank>3.5.1 Experimental Results for Pudong Bank<a hidden class=anchor aria-hidden=true href=#351-experimental-results-for-pudong-bank>#</a></h4><h5 id=table-36-experimental-results-for-pudong-bank>Table 3.6: Experimental Results for Pudong Bank<a hidden class=anchor aria-hidden=true href=#table-36-experimental-results-for-pudong-bank>#</a></h5><table><thead><tr><th></th><th>LSTM</th><th>GRU</th><th>BiLSTM</th></tr></thead><tbody><tr><td><strong>MSE</strong></td><td>0.059781</td><td>0.069323</td><td>0.056454</td></tr><tr><td><strong>RMSE</strong></td><td>0.244501</td><td>0.263292</td><td>0.237601</td></tr><tr><td><strong>MAE</strong></td><td>0.186541</td><td>0.202665</td><td>0.154289</td></tr><tr><td><strong>R-squared</strong></td><td>0.91788</td><td>0.896214</td><td>0.929643</td></tr></tbody></table><p>Comparing the evaluation metrics of the three models, we observe that on the Pudong Bank test set, the BiLSTM model has lower MSE, RMSE, and MAE than both the LSTM and GRU models, while its $R^2$ is higher than those of LSTM and GRU models. Specifically, the RMSE comparison shows that BiLSTM has a 2.90% performance improvement over LSTM and a 10.81% performance improvement over GRU on the validation set.</p><h4 id=352-experimental-results-for-ibm>3.5.2 Experimental Results for IBM<a hidden class=anchor aria-hidden=true href=#352-experimental-results-for-ibm>#</a></h4><h5 id=table-37-experimental-results-for-ibm>Table 3.7: Experimental Results for IBM<a hidden class=anchor aria-hidden=true href=#table-37-experimental-results-for-ibm>#</a></h5><table><thead><tr><th></th><th>LSTM</th><th>GRU</th><th>BiLSTM</th></tr></thead><tbody><tr><td><strong>MSE</strong></td><td>18.01311</td><td>12.938584</td><td>11.057501</td></tr><tr><td><strong>RMSE</strong></td><td>4.244186</td><td>3.597024</td><td>3.325282</td></tr><tr><td><strong>MAE</strong></td><td>3.793223</td><td>3.069033</td><td>2.732075</td></tr><tr><td><strong>R-squared</strong></td><td>0.789453</td><td>0.851939</td><td>0.883334</td></tr></tbody></table><p>Comparing the evaluation metrics of the three models, we find that on the IBM test set, the BiLSTM model has lower MSE, RMSE, and MAE than both the LSTM and GRU models, while its $R^2$ is higher than those of LSTM and GRU models. Specifically, the RMSE comparison shows that BiLSTM has a 27.63% performance improvement over LSTM and an 8.17% performance improvement over GRU on the validation set.</p><h3 id=36-chapter-summary>3.6 Chapter Summary<a hidden class=anchor aria-hidden=true href=#36-chapter-summary>#</a></h3><p>This chapter introduced the datasets selected for the experiments—Pudong Bank and IBM—and the chosen features. It then performed data normalization and data splitting as preprocessing steps. The chapter also detailed the network structures and hyperparameter settings of the LSTM, GRU, and BiLSTM models used in the experiments. Finally, it presented the loss function curves and a series of fitting graphs for each model. By comparing multiple evaluation metrics and fitting graphs, it was concluded that the BiLSTM model can better predict stock prices, laying the foundation for the subsequent research on the LightGBM-BiLSTM quantitative investment strategy.</p><hr><h2 id=chapter-4-research-on-lightgbm-bilstm-based-quantitative-investment-models>Chapter 4: Research on LightGBM-BiLSTM-Based Quantitative Investment Models<a hidden class=anchor aria-hidden=true href=#chapter-4-research-on-lightgbm-bilstm-based-quantitative-investment-models>#</a></h2><h3 id=41-experimental-steps>4.1 Experimental Steps<a hidden class=anchor aria-hidden=true href=#41-experimental-steps>#</a></h3><figure class=align-center><img loading=lazy src=LightGBM_BiLSTM_Flow.png#center alt="Fig. 11. LightGBM-BiLSTM Diagram."><figcaption><p>Fig. 11. LightGBM-BiLSTM Diagram.</p></figcaption></figure><p>As shown in Fig. 11, this experiment first selects 50 factors from the factor library. Subsequently, each factor undergoes outlier removal, normalization, and missing value imputation steps for factor cleaning. The LightGBM model is then used for factor selection, ranking factors based on importance and selecting the top ten most important factors for cross-sectional analysis. Next, the BiLSTM model is used to combine these factors to build a multi-factor model. Finally, the quantitative investment strategy is constructed based on the obtained models and subjected to backtesting analysis.</p><h3 id=42-experimental-data>4.2 Experimental Data<a hidden class=anchor aria-hidden=true href=#42-experimental-data>#</a></h3><h4 id=421-stock-data>4.2.1 Stock Data<a hidden class=anchor aria-hidden=true href=#421-stock-data>#</a></h4><p>The market data used in this paper are sourced from <a href=https://github.com/waditu/tushare>Tushare</a>. The specific features of the dataset are shown in Table 4.1.</p><h5 id=table-41-features-included-in-the-dataset>Table 4.1: Features Included in the Dataset<a hidden class=anchor aria-hidden=true href=#table-41-features-included-in-the-dataset>#</a></h5><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>ts_code</td><td>str</td><td>Stock code</td></tr><tr><td>trade_date</td><td>str</td><td>Trading date</td></tr><tr><td>open</td><td>float</td><td>Opening price</td></tr><tr><td>high</td><td>float</td><td>Highest price</td></tr><tr><td>low</td><td>float</td><td>Lowest price</td></tr><tr><td>close</td><td>float</td><td>Closing price</td></tr><tr><td>pre_close</td><td>float</td><td>Previous day&rsquo;s closing price</td></tr><tr><td>change</td><td>float</td><td>Price change</td></tr><tr><td>pct_chg</td><td>float</td><td>Percentage change (unadjusted)</td></tr><tr><td>vol</td><td>float</td><td>Trading volume (in hands)</td></tr><tr><td>amount</td><td>float</td><td>Trading amount (in thousands of yuan)</td></tr></tbody></table><p>The entire A-share daily market dataset contains 5,872,309 rows of data, representing 5,872,309 samples. As shown in Table 4.2, the A-share daily market dataset has the following 11 features: stock code (ts_code), trading date (trade_date), opening price (open), closing price (close), highest price (high), lowest price (low), previous day&rsquo;s closing price (pre_close), price change (change), turnover rate (turnover_rate), trading amount (amount), total market value (total_mv), and adjustment factor (adj_factor).</p><h5 id=table-42-partial-display-of-a-share-daily-market-dataset>Table 4.2: Partial Display of A-share Daily Market Dataset<a hidden class=anchor aria-hidden=true href=#table-42-partial-display-of-a-share-daily-market-dataset>#</a></h5><table><thead><tr><th>ts_code</th><th>trade_date</th><th>open</th><th>high</th><th>low</th><th>close</th><th>pre_close</th><th>change</th><th>vol</th><th>amount</th></tr></thead><tbody><tr><td>600613.SH</td><td>20120104</td><td>8.20</td><td>8.20</td><td>7.84</td><td>7.86</td><td>8.16</td><td>-0.30</td><td>4,762.98</td><td>3,854.1000</td></tr><tr><td>600690.SH</td><td>20120104</td><td>9.00</td><td>9.17</td><td>8.78</td><td>8.78</td><td>8.93</td><td>-0.15</td><td>142,288.41</td><td>127,992.6050</td></tr><tr><td>300277.SZ</td><td>20120104</td><td>22.90</td><td>22.98</td><td>20.81</td><td>20.88</td><td>22.68</td><td>-1.80</td><td>12,212.39</td><td>26,797.1370</td></tr><tr><td>002403.SZ</td><td>20120104</td><td>8.87</td><td>8.90</td><td>8.40</td><td>8.40</td><td>8.84</td><td>-0.441</td><td>10,331.97</td><td>9,013.4317</td></tr><tr><td>300179.SZ</td><td>20120104</td><td>19.99</td><td>20.32</td><td>19.20</td><td>19.50</td><td>19.96</td><td>-0.46</td><td>1,532.31</td><td>3,008.0594</td></tr><tr><td>600000.SH</td><td>20120104</td><td>8.54</td><td>8.56</td><td>8.39</td><td>8.41</td><td>8.49</td><td>-0.08</td><td>342,013.79</td><td>290,229.5510</td></tr><tr><td>300282.SZ</td><td>20120104</td><td>22.90</td><td>23.33</td><td>21.02</td><td>21.02</td><td>23.35</td><td>-2.33</td><td>38,408.60</td><td>86,216.2356</td></tr><tr><td>002319.SZ</td><td>20120104</td><td>9.74</td><td>9.95</td><td>9.38</td><td>9.41</td><td>9.73</td><td>-0.32</td><td>4,809.74</td><td>4,671.4803</td></tr><tr><td>601991.SH</td><td>20120104</td><td>5.17</td><td>5.39</td><td>5.12</td><td>5.25</td><td>5.16</td><td>0.09</td><td>145,268.38</td><td>76,547.7490</td></tr><tr><td>000780.SZ</td><td>20120104</td><td>10.42</td><td>10.49</td><td>10.00</td><td>10.00</td><td>10.30</td><td>-0.30</td><td>20,362.30</td><td>20,830.1761</td></tr></tbody></table><p><strong>[5,872,309 rows x 11 columns]</strong></p><p>The CSI All Share Index daily dataset contains 5,057 rows of data, representing 5,057 samples. As shown in Table 4.3, the CSI All Share daily dataset has the following 7 features: trading date (trade_date), opening price (open), highest price (high), lowest price (low), closing price (close), trading volume (volume), and previous day&rsquo;s closing price (pre_close).</p><h5 id=table-43-partial-display-of-csi-all-share-daily-dataset>Table 4.3: Partial Display of CSI All Share Daily Dataset<a hidden class=anchor aria-hidden=true href=#table-43-partial-display-of-csi-all-share-daily-dataset>#</a></h5><table><thead><tr><th>trade_date</th><th>open</th><th>high</th><th>low</th><th>close</th><th>volume</th><th>pre_close</th></tr></thead><tbody><tr><td>2006-11-24</td><td>1564.3560</td><td>1579.3470</td><td>1549.9790</td><td>1576.1530</td><td>7.521819e+09</td><td>1567.0910</td></tr><tr><td>2006-11-27</td><td>1574.1130</td><td>1598.7440</td><td>1574.1130</td><td>1598.7440</td><td>7.212786e+09</td><td>1581.1530</td></tr><tr><td>2006-11-28</td><td>1597.7200</td><td>1604.7190</td><td>1585.3620</td><td>1596.8400</td><td>7.025637e+09</td><td>1598.7440</td></tr><tr><td>2006-11-29</td><td>1575.3030</td><td>1620.2870</td><td>1575.3030</td><td>1617.9880</td><td>7.250354e+09</td><td>1596.8400</td></tr><tr><td>2006-11-30</td><td>1621.4280</td><td>1657.3230</td><td>1621.4280</td><td>1657.3230</td><td>9.656888e+09</td><td>1617.9880</td></tr><tr><td>&mldr;</td><td>&mldr;</td><td>&mldr;</td><td>&mldr;</td><td>&mldr;</td><td>&mldr;</td><td>&mldr;</td></tr><tr><td>2020-11-11</td><td>5477.8870</td><td>5493.5867</td><td>5422.9110</td><td>5425.8017</td><td>5.604086e+10</td><td>5494.1042</td></tr><tr><td>2020-11-12</td><td>5439.2296</td><td>5454.3452</td><td>5413.9659</td><td>5435.1379</td><td>4.594251e+10</td><td>5425.8017</td></tr><tr><td>2020-11-13</td><td>5418.2953</td><td>5418.3523</td><td>5364.2031</td><td>5402.7702</td><td>4.688916e+10</td><td>5435.1379</td></tr><tr><td>2020-11-16</td><td>5422.3565</td><td>5456.7264</td><td>5391.9232</td><td>5456.7264</td><td>5.593672e+10</td><td>5402.7702</td></tr><tr><td>2020-11-17</td><td>5454.0696</td><td>5454.0696</td><td>5395.6052</td><td>5428.0765</td><td>5.857009e+10</td><td>5456.7264</td></tr></tbody></table><p><strong>[5,057 rows x 7 columns]</strong></p><p>Below is partial data of the original factors. After undergoing the four factor cleaning steps—missing value imputation, outlier removal, factor normalization, and factor neutralization—the cleaned factor data is displayed in the table below.</p><h5 id=table-44-original-factor-data>Table 4.4: Original Factor Data<a hidden class=anchor aria-hidden=true href=#table-44-original-factor-data>#</a></h5><table><thead><tr><th>trade_date</th><th>sec_code</th><th>ret</th><th>factor_0</th><th>factor_1</th><th>factor_2</th><th>factor_3</th><th>factor_4</th><th>factor_5</th><th>factor_6</th><th>&mldr;</th></tr></thead><tbody><tr><td>2005-01-04</td><td>600874.SH</td><td>0.001684</td><td>NaN</td><td>9.445412</td><td>9.445412</td><td>9.445408</td><td>-1.00</td><td>NaN</td><td>12651.124023</td><td>&mldr;</td></tr><tr><td>2005-01-04</td><td>000411.SZ</td><td>0.021073</td><td>NaN</td><td>5.971262</td><td>5.971262</td><td>5.971313</td><td>0.38</td><td>NaN</td><td>392.124298</td><td>&mldr;</td></tr><tr><td>2005-01-04</td><td>000979.SZ</td><td>0.021207</td><td>NaN</td><td>6.768918</td><td>6.768918</td><td>6.768815</td><td>-1.45</td><td>NaN</td><td>870.587585</td><td>&mldr;</td></tr><tr><td>2005-01-04</td><td>000498.SZ</td><td>0.030220</td><td>NaN</td><td>8.852752</td><td>8.852752</td><td>8.852755</td><td>0.55</td><td>NaN</td><td>6994.011719</td><td>&mldr;</td></tr><tr><td>2005-01-04</td><td>600631.SH</td><td>0.015699</td><td>NaN</td><td>9.589897</td><td>9.589897</td><td>9.589889</td><td>-1.70</td><td>NaN</td><td>14616.806641</td><td>&mldr;</td></tr></tbody></table><h5 id=table-45-cleaned-factor-data>Table 4.5: Cleaned Factor Data<a hidden class=anchor aria-hidden=true href=#table-45-cleaned-factor-data>#</a></h5><table><thead><tr><th>sec_code</th><th>trade_date</th><th>ret</th><th>factor_0</th><th>factor_1</th><th>factor_2</th><th>factor_3</th><th>factor_4</th><th>factor_5</th><th>factor_6</th><th>&mldr;</th></tr></thead><tbody><tr><td>000001.SZ</td><td>2005-01-04</td><td>-1.58653</td><td>0.01545</td><td>1.38306</td><td>1.38306</td><td>1.38306</td><td>0.13392</td><td>0.01545</td><td>1.38564</td><td>&mldr;</td></tr><tr><td>000002.SZ</td><td>2005-01-04</td><td>1.36761</td><td>-0.44814</td><td>1.69728</td><td>1.69728</td><td>1.69728</td><td>1.04567</td><td>-0.44814</td><td>1.69728</td><td>&mldr;</td></tr><tr><td>000004.SZ</td><td>2005-01-04</td><td>0.32966</td><td>-1.41654</td><td>-0.13907</td><td>-0.13907</td><td>-0.13907</td><td>-0.34769</td><td>-1.41654</td><td>-0.13650</td><td>&mldr;</td></tr><tr><td>000005.SZ</td><td>2005-01-04</td><td>0.61297</td><td>-1.13066</td><td>1.05339</td><td>1.05339</td><td>1.05339</td><td>-1.20020</td><td>-1.13066</td><td>1.05597</td><td>&mldr;</td></tr><tr><td>000006.SZ</td><td>2005-01-04</td><td>-0.35542</td><td>1.67667</td><td>-0.07726</td><td>-0.07726</td><td>-0.07726</td><td>1.55820</td><td>1.67667</td><td>-0.07469</td><td>&mldr;</td></tr></tbody></table><h3 id=43-factor-cleaning>4.3 Factor Cleaning<a hidden class=anchor aria-hidden=true href=#43-factor-cleaning>#</a></h3><h4 id=431-handling-missing-values-and-outlier-removal>4.3.1 Handling Missing Values and Outlier Removal<a hidden class=anchor aria-hidden=true href=#431-handling-missing-values-and-outlier-removal>#</a></h4><p>Methods for handling missing values in factors include case elimination, mean substitution, regression imputation, etc. This paper adopts the relatively simple mean substitution method to handle missing values, replacing missing data with the factor’s average value. For outlier removal, methods include median trimming, percentile-based trimming, and $3\sigma$ trimming. This paper uses the $3\sigma$ trimming method, which applies the statistical $3\sigma$ principle to transform extreme factor values more than three standard deviations away from the mean to exactly three standard deviations away from the mean. The specific calculation formula is as follows:</p>$$
X_i^{\prime}= \begin{cases} \bar{X}+3 \sigma & \text{if } X_i > \bar{X} + 3 \sigma \\ \bar{X}-3 \sigma & \text{if } X_i < \bar{X} - 3 \sigma \\ X_i & \text{if } \bar{X} - 3 \sigma < X_i < \bar{X} + 3 \sigma \end{cases}
$$<p>Where:</p><ul><li>$X_{i}$: Original value of the factor before processing</li><li>$\bar{X}$: Mean of the factor series</li><li>$\sigma$: Standard deviation of the factor series</li><li>$X_{i}^{\prime}$: Value of the factor after outlier removal</li></ul><h4 id=432-factor-normalization>4.3.2 Factor Normalization<a hidden class=anchor aria-hidden=true href=#432-factor-normalization>#</a></h4><p>In this experiment, multiple factors with different dimensions are selected, and their units are not entirely consistent. To facilitate comparison and regression, normalization of factors is necessary. Common normalization methods include Min-Max normalization, Z-score normalization, and Decimal scaling normalization. This paper adopts the Z-score normalization method, standardizing data using the mean and standard deviation of the original data. The processed data follow a standard normal distribution with a mean of 0 and a standard deviation of 1, resulting in normalized values that are both positive and negative, forming a standard normal distribution curve.</p><p>The Z-score normalization formula used in this paper is as follows:</p>$$
\tilde{x}=\frac{x_{i}-u}{\sigma}
$$<p>Where:</p><ul><li>$x_{i}$: Original value of the factor</li><li>$u$: Mean of the factor series</li><li>$\sigma$: Standard deviation of the factor series</li><li>$\tilde{x}$: Normalized factor value</li></ul><h4 id=433-factor-neutralization>4.3.3 Factor Neutralization<a hidden class=anchor aria-hidden=true href=#433-factor-neutralization>#</a></h4><p>Factor neutralization aims to eliminate the influence of other factors on the selected factor, ensuring that the stocks chosen for constructing the quantitative investment strategy are more diversified rather than concentrated in specific industries or market capitalizations. This better distributes investment portfolio risk and addresses multicollinearity issues among factors. Market capitalization and industry are the two main independent variables influencing stock returns; therefore, they must be considered during factor cleaning. In this paper&rsquo;s empirical study, only industry factors are included, with the market factor incorporated into the industry factors. The single-factor regression model for neutralizing factors is shown in formula (31). The residuals from the following regression model are used as the new, neutralized factor values.</p>$$
\tilde{r}_{j}^{t}=\sum_{s=1}^{S} X_{j s}^{t} \tilde{f}_{s}^{t} + X_{j k}^{t} \tilde{f}_{k}^{t} + \tilde{u}_{j}^{t}
$$<p>Where:</p><ul><li>$\tilde{r}_{j}^{t}$: Return of stock $j$ in period $t$</li><li>$X_{j s}^{t}$: Exposure of stock $j$ to industry $s$ in period $t$</li><li>$\tilde{f}_{s}^{t}$: Return of industry $s$ in period $t$</li><li>$X_{j k}^{t}$: Exposure of stock $j$ to factor $k$ in period $t$</li><li>$\tilde{f}_{k}^{t}$: Return of factor $k$ in period $t$</li><li>$\tilde{u}_j^t$: A $0-1$ dummy variable, indicating whether stock $j$ belongs to industry $s$ (1) or not (0)</li></ul><p>In this paper, the industry assignment is not proportionally split; that is, stock $j$ can belong to only one specific industry $s$, with an exposure of 1 to industry $s$ and 0 to all other industries. This paper uses the Shenwan Hongyuan industry classification standard, categorizing companies into 28 primary industries: Agriculture, Forestry, Animal Husbandry, and Fishery; Mining; Chemicals; Steel; Non-Ferrous Metals; Electronic Components; Home Appliances; Food and Beverage; Textile and Apparel; Light Manufacturing; Pharmaceutical and Biotechnology; Public Utilities; Transportation; Real Estate; Commerce and Trade; Catering and Tourism; Comprehensive; Building Materials; Architectural Decoration; Electrical Equipment; National Defense and Military Industry; Computers; Media; Telecommunications; Banking; Non-Banking Finance; Automobiles; and Machinery Equipment. The table below shows the historical market data of the Shenwan Hongyuan primary industry index as of February 5, 2021.</p><h5 id=table-49-historical-market-data-of-shenwan-hongyuan-primary-industry-index-as-of-february-5-2021>Table 4.9: Historical Market Data of Shenwan Hongyuan Primary Industry Index as of February 5, 2021<a hidden class=anchor aria-hidden=true href=#table-49-historical-market-data-of-shenwan-hongyuan-primary-industry-index-as-of-february-5-2021>#</a></h5><table><thead><tr><th>Index Code</th><th>Index Name</th><th>Release Date</th><th>Opening Index</th><th>Highest Index</th><th>Lowest Index</th><th>Closing Index</th><th>Trading Volume (Billion)</th><th>Trading Amount (Hundred Million Yuan)</th><th>Percentage Change (%)</th></tr></thead><tbody><tr><td>801010</td><td>Agriculture, Forestry, Animal Husbandry, and Fishery</td><td>2021/2/5 0:00</td><td>4,111.43</td><td>4,271.09</td><td>4,072.53</td><td>4,081.81</td><td>1.581</td><td>307.82</td><td>-0.3</td></tr><tr><td>801020</td><td>Mining</td><td>2021/2/5 0:00</td><td>2,344.62</td><td>2,357.33</td><td>2,288.97</td><td>2,289.41</td><td>1.806</td><td>115.6</td><td>-2.25</td></tr><tr><td>801030</td><td>Chemicals</td><td>2021/2/5 0:00</td><td>4,087.77</td><td>4,097.59</td><td>3,910.67</td><td>3,910.67</td><td>5.578</td><td>778.85</td><td>-3.95</td></tr><tr><td>801040</td><td>Steel</td><td>2021/2/5 0:00</td><td>2,253.78</td><td>2,268.17</td><td>2,243.48</td><td>2,250.81</td><td>1.161</td><td>48.39</td><td>-1.02</td></tr><tr><td>801050</td><td>Non-Ferrous Metals</td><td>2021/2/5 0:00</td><td>4,212.10</td><td>4,250.59</td><td>4,035.99</td><td>4,036.74</td><td>4.541</td><td>593.92</td><td>-4.43</td></tr><tr><td>801080</td><td>Electronic Components</td><td>2021/2/5 0:00</td><td>4,694.80</td><td>4,694.80</td><td>4,561.95</td><td>4,561.95</td><td>5.267</td><td>850.79</td><td>-2.78</td></tr><tr><td>801110</td><td>Home Appliances</td><td>2021/2/5 0:00</td><td>10,033.82</td><td>10,171.26</td><td>9,968.93</td><td>10,096.83</td><td>0.855</td><td>149.18</td><td>0.83</td></tr><tr><td>801120</td><td>Food and Beverage</td><td>2021/2/5 0:00</td><td>30,876.33</td><td>31,545.02</td><td>30,649.57</td><td>30,931.69</td><td>1.132</td><td>657.11</td><td>0.47</td></tr><tr><td>801130</td><td>Textile and Apparel</td><td>2021/2/5 0:00</td><td>1,614.48</td><td>1,633.89</td><td>1,604.68</td><td>1,607.63</td><td>0.628</td><td>57.47</td><td>-0.39</td></tr><tr><td>801140</td><td>Light Manufacturing</td><td>2021/2/5 0:00</td><td>2,782.07</td><td>2,791.88</td><td>2,735.48</td><td>2,737.24</td><td>1.528</td><td>176.16</td><td>-1.35</td></tr><tr><td>&mldr;</td><td>&mldr;</td><td>&mldr;</td><td>&mldr;</td><td>&mldr;</td><td>&mldr;</td><td>&mldr;</td><td>&mldr;</td><td>&mldr;</td><td>&mldr;</td></tr></tbody></table><p><strong>Data Source</strong>: Shenwan Hongyuan</p><p>Below is partial data of the original factors. After undergoing the four factor cleaning steps—missing value imputation, outlier removal, factor normalization, and factor neutralization—the cleaned factor data is displayed in the table below.</p><h5 id=table-410-original-factor-data>Table 4.10: Original Factor Data<a hidden class=anchor aria-hidden=true href=#table-410-original-factor-data>#</a></h5><table><thead><tr><th>trade_date</th><th>sec_code</th><th>ret</th><th>factor_0</th><th>factor_1</th><th>factor_2</th><th>factor_3</th><th>factor_4</th><th>factor_5</th><th>factor_6</th><th>&mldr;</th></tr></thead><tbody><tr><td>2005-01-04</td><td>600874.SH</td><td>0.001684</td><td>NaN</td><td>9.445412</td><td>9.445412</td><td>9.445408</td><td>-1.00</td><td>NaN</td><td>12651.124023</td><td>&mldr;</td></tr><tr><td>2005-01-04</td><td>000411.SZ</td><td>0.021073</td><td>NaN</td><td>5.971262</td><td>5.971262</td><td>5.971313</td><td>0.38</td><td>NaN</td><td>392.124298</td><td>&mldr;</td></tr><tr><td>2005-01-04</td><td>000979.SZ</td><td>0.021207</td><td>NaN</td><td>6.768918</td><td>6.768918</td><td>6.768815</td><td>-1.45</td><td>NaN</td><td>870.587585</td><td>&mldr;</td></tr><tr><td>2005-01-04</td><td>000498.SZ</td><td>0.030220</td><td>NaN</td><td>8.852752</td><td>8.852752</td><td>8.852755</td><td>0.55</td><td>NaN</td><td>6994.011719</td><td>&mldr;</td></tr><tr><td>2005-01-04</td><td>600631.SH</td><td>0.015699</td><td>NaN</td><td>9.589897</td><td>9.589897</td><td>9.589889</td><td>-1.70</td><td>NaN</td><td>14616.806641</td><td>&mldr;</td></tr></tbody></table><h5 id=table-411-cleaned-factor-data>Table 4.11: Cleaned Factor Data<a hidden class=anchor aria-hidden=true href=#table-411-cleaned-factor-data>#</a></h5><table><thead><tr><th>sec_code</th><th>trade_date</th><th>ret</th><th>factor_0</th><th>factor_1</th><th>factor_2</th><th>factor_3</th><th>factor_4</th><th>factor_5</th><th>factor_6</th><th>&mldr;</th></tr></thead><tbody><tr><td>000001.SZ</td><td>2005-01-04</td><td>-1.58653</td><td>0.01545</td><td>1.38306</td><td>1.38306</td><td>1.38306</td><td>0.13392</td><td>0.01545</td><td>1.38564</td><td>&mldr;</td></tr><tr><td>000002.SZ</td><td>2005-01-04</td><td>1.36761</td><td>-0.44814</td><td>1.69728</td><td>1.69728</td><td>1.69728</td><td>1.04567</td><td>-0.44814</td><td>1.69728</td><td>&mldr;</td></tr><tr><td>000004.SZ</td><td>2005-01-04</td><td>0.32966</td><td>-1.41654</td><td>-0.13907</td><td>-0.13907</td><td>-0.13907</td><td>-0.34769</td><td>-1.41654</td><td>-0.13650</td><td>&mldr;</td></tr><tr><td>000005.SZ</td><td>2005-01-04</td><td>0.61297</td><td>-1.13066</td><td>1.05339</td><td>1.05339</td><td>1.05339</td><td>-1.20020</td><td>-1.13066</td><td>1.05597</td><td>&mldr;</td></tr><tr><td>000006.SZ</td><td>2005-01-04</td><td>-0.35542</td><td>1.67667</td><td>-0.07726</td><td>-0.07726</td><td>-0.07726</td><td>1.55820</td><td>1.67667</td><td>-0.07469</td><td>&mldr;</td></tr></tbody></table><h3 id=44-factor-selection-based-on-lightgbm>4.4 Factor Selection Based on LightGBM<a hidden class=anchor aria-hidden=true href=#44-factor-selection-based-on-lightgbm>#</a></h3><p><a href=https://www.jstor.org/stable/2699986>Freeman (2001)</a>$^{[20]}$ proposed Gradient Boosting Decision Trees (GBDT), an iterative regression decision tree method. The main idea is to iteratively add weak classifiers (usually decision trees) to optimize the model, minimizing the loss function. GBDT can be expressed as:</p>$$
\hat{y} = \sum_{m=1}^{M} \gamma_m h_m(\mathbf{x})
$$<p>Where:</p><ul><li>\( M \) is the number of iterations</li><li>\( \gamma_m \) is the weight of the \( m \)-th weak classifier</li><li>\( h_m(\mathbf{x}) \) is the \( m \)-th decision tree model</li></ul><p>The training process of GBDT minimizes the loss function by sequentially fitting in the direction of the negative gradient, with the specific update formula as:</p>$$
\gamma_m = \arg\min_\gamma \sum_{i=1}^{N} L\left(y_i, \hat{y}_{i}^{(m-1)} + \gamma h_m(\mathbf{x}_i)\right)
$$<p>Where \( L \) is the loss function, \( y_i \) is the true value, and \( \hat{y}_{i}^{(m-1)} \) is the prediction after the \( m-1 \)-th iteration.</p><p><a href=https://proceedings.neurips.cc/paper_files/paper/2017/file/6449f44a102fde848669bdd9eb6b76fa-Paper.pdf>Light Gradient Boosting Machine (LightGBM)</a>$^{[21]}$ is an efficient implementation framework of the GBDT algorithm, initially developed by Microsoft as a free and open-source distributed gradient boosting framework. LightGBM is based on decision tree algorithms and is widely used in ranking, classification, and other machine learning tasks. Its development focuses on performance and scalability, with major advantages including highly efficient parallel training, faster training speed, lower memory consumption, better accuracy, support for distributed computing, and fast processing of massive data$^{[22]}$.</p><p>The core algorithm of LightGBM is based on the following optimization objective:</p>$$
L = \sum_{i=1}^{N} l(y_i, \hat{y}_i) + \sum_{m=1}^{M} \Omega(h_m)
$$<p>Where \( l \) is the loss function, \( \Omega \) is the regularization term controlling model complexity, typically expressed as:</p>$$
\Omega(h_m) = \gamma T + \frac{1}{2} \lambda \sum_{j=1}^{T} w_j^2
$$<p>Here, \( T \) is the number of leaves in the tree, \( w_j \) is the weight of the \( j \)-th leaf, and \( \gamma \) and \( \lambda \) are regularization parameters.</p><p>LightGBM employs techniques such as Gradient-based One-Side Sampling (GOSS) and Exclusive Feature Bundling (EFB) to significantly enhance training efficiency and model performance.</p><p>In this study, the loss function used during training is Mean Squared Error (MSE), defined as:</p>$$
L(y, \hat{y}) = \frac{1}{N} \sum_{i=1}^{N} (y_i - \hat{y}_i)^2
$$<p>Where \( y \) is the true return, \( \hat{y} \) is the predicted return, and \( N \) is the number of samples.</p><p>The specific algorithm process of this subsection is as follows:</p><ol><li><p><strong>Data Preparation</strong>: Use one year&rsquo;s worth of data for each stock in the A-share market, consisting of 50 factor data points and the historical return for the next month as features.</p></li><li><p><strong>Model Training</strong>: Utilize Grid Search to optimize the LightGBM model’s hyperparameters and train the model to predict the next month&rsquo;s returns. The model training process is shown in Fig. 12.</p>$$
\text{Parameter Optimization:} \quad \theta^* = \arg\min_\theta \sum_{i=1}^{N} L(y_i, \hat{y}_i(\theta))
$$<p>Where \( \theta \) represents the set of model hyperparameters, and \( \theta^* \) is the optimal set.</p></li><li><p><strong>Factor Importance Calculation</strong>: Use LightGBM&rsquo;s <code>feature_importances_</code> method to calculate the feature importance of each factor. Feature importance is primarily measured using two indicators:</p><ul><li><strong>Split</strong>: The number of times the feature is used for splitting across all trees.</li><li><strong>Gain</strong>: The total gain brought by the feature across all splits (i.e., the reduction in the loss function).</li></ul><p>The feature importance of factors can be expressed as:</p>$$
\text{Importance}_{\text{split}}(f) = \sum_{m=1}^{M} \sum_{j=1}^{T_m} \mathbb{I}(f \text{ used in the split of the } j\text{-th leaf node of the } m\text{-th tree})
$$$$
\text{Importance}_{\text{gain}}(f) = \sum_{m=1}^{M} \sum_{j=1}^{T_m} \Delta L_{m,j} \cdot \mathbb{I}(f \text{ used in the split of the } j\text{-th leaf node of the } m\text{-th tree})
$$<p>Where \( \mathbb{I} \) is the indicator function, and \( \Delta L_{m,j} \) is the loss reduction brought by factor \( f \) in the split of the \( j \)-th leaf node of the \( m \)-th tree.</p></li><li><p><strong>Factor Selection</strong>: Rank the factors based on their calculated importance and select the top ten most important factors for cross-sectional analysis, as shown in Table 4.9.</p></li></ol><h5 id=table-49-partial-factor-importance-ranking>Table 4.9: Partial Factor Importance Ranking<a hidden class=anchor aria-hidden=true href=#table-49-partial-factor-importance-ranking>#</a></h5><table><thead><tr><th>Importance</th><th>Feature Name</th><th>Trade Date</th></tr></thead><tbody><tr><td>35</td><td>factor_35</td><td>2010-08-11</td></tr><tr><td>27</td><td>factor_27</td><td>2010-08-11</td></tr><tr><td>33</td><td>factor_33</td><td>2010-08-11</td></tr><tr><td>20</td><td>factor_20</td><td>2010-08-11</td></tr><tr><td>24</td><td>factor_24</td><td>2010-08-11</td></tr><tr><td>45</td><td>factor_45</td><td>2010-08-11</td></tr><tr><td>37</td><td>factor_37</td><td>2010-08-11</td></tr><tr><td>49</td><td>factor_49</td><td>2010-08-11</td></tr><tr><td>19</td><td>factor_19</td><td>2010-08-11</td></tr><tr><td>47</td><td>factor_47</td><td>2010-08-11</td></tr><tr><td>22</td><td>factor_22</td><td>2010-09-09</td></tr><tr><td>20</td><td>factor_20</td><td>2010-09-09</td></tr><tr><td>30</td><td>factor_30</td><td>2010-09-09</td></tr><tr><td>24</td><td>factor_24</td><td>2010-09-09</td></tr></tbody></table><ol start=5><li>Code Implementation Snippet: The following code snippet demonstrates part of the training process used for factor selection.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>feature_choice</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>days</span><span class=o>=</span><span class=mi>21</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>is_local</span><span class=o>=</span><span class=kc>False</span>
</span></span><span class=line><span class=cl><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>is_local</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>feature_info</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_hdf</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>RESULTS</span><span class=p>,</span> <span class=n>Feature_Info</span> <span class=o>+</span> <span class=s1>&#39;.h5&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>factors</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>get_env</span><span class=p>()</span><span class=o>.</span><span class=n>query_data</span><span class=p>(</span><span class=n>Factors_Data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>factors</span> <span class=o>=</span> <span class=n>factors</span><span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=n>factors</span><span class=p>[</span><span class=n>COM_DATE</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=s1>&#39;2010-01-01&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>trade_list</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>factors</span><span class=p>[</span><span class=n>COM_DATE</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>        <span class=n>trade_list</span><span class=o>.</span><span class=n>sort</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>trade_list</span><span class=p>)</span> <span class=o>%</span> <span class=n>days</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>n</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>trade_list</span><span class=p>)</span> <span class=o>/</span> <span class=n>days</span><span class=p>)</span> <span class=o>-</span> <span class=mi>7</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>n</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>trade_list</span><span class=p>)</span> <span class=o>/</span> <span class=n>days</span><span class=p>)</span> <span class=o>-</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>        <span class=n>feature_info</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>begin_index</span> <span class=o>=</span> <span class=mi>147</span>
</span></span><span class=line><span class=cl>        <span class=n>feature</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>factors</span><span class=o>.</span><span class=n>columns</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>feature</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>COM_SEC</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>feature</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>COM_DATE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>feature</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>Ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>end_date</span> <span class=o>=</span> <span class=n>days</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=n>begin_index</span> <span class=o>-</span> <span class=mi>21</span>
</span></span><span class=line><span class=cl>            <span class=n>begin_date</span> <span class=o>=</span> <span class=n>days</span> <span class=o>*</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>            <span class=n>trade_date</span> <span class=o>=</span> <span class=n>days</span> <span class=o>*</span> <span class=n>i</span> <span class=o>+</span> <span class=n>begin_index</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>trade_list</span><span class=p>[</span><span class=n>trade_date</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>train_data</span> <span class=o>=</span> <span class=n>factors</span><span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=n>factors</span><span class=p>[</span><span class=n>COM_DATE</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>trade_list</span><span class=p>[</span><span class=n>end_date</span><span class=p>])</span> <span class=o>&amp;</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=n>factors</span><span class=p>[</span><span class=n>COM_DATE</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>trade_list</span><span class=p>[</span><span class=n>begin_date</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>model</span> <span class=o>=</span> <span class=n>lgb</span><span class=o>.</span><span class=n>LGBMRegressor</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>train_data</span><span class=p>[</span><span class=n>feature</span><span class=p>],</span> <span class=n>train_data</span><span class=p>[</span><span class=n>Ret</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=n>feature_info_cell</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=n>Info_Fields</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>feature_info_cell</span><span class=p>[</span><span class=n>Importance</span><span class=p>]</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>feature_importances_</span>
</span></span><span class=line><span class=cl>            <span class=n>feature_info_cell</span><span class=p>[</span><span class=n>Feature_Name</span><span class=p>]</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>feature_name_</span>
</span></span><span class=line><span class=cl>            <span class=n>feature_info_cell</span> <span class=o>=</span> <span class=n>feature_info_cell</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=n>by</span><span class=o>=</span><span class=n>Importance</span><span class=p>)</span><span class=o>.</span><span class=n>tail</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>feature_info_cell</span><span class=p>[</span><span class=n>COM_DATE</span><span class=p>]</span> <span class=o>=</span> <span class=n>trade_list</span><span class=p>[</span><span class=n>trade_date</span><span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=n>feature_info</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span><span class=n>feature_info</span><span class=p>,</span> <span class=n>feature_info_cell</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=n>axis</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl>            <span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>h</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>HDFStore</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>RESULTS</span><span class=p>,</span> <span class=n>Feature_Info</span> <span class=o>+</span> <span class=s1>&#39;.h5&#39;</span><span class=p>),</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>h</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>feature_info</span>
</span></span><span class=line><span class=cl>        <span class=n>h</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>get_env</span><span class=p>()</span><span class=o>.</span><span class=n>add_data</span><span class=p>(</span><span class=n>feature_info</span><span class=p>,</span> <span class=n>Feature_Info</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span></code></pre></div><p>Through the above process, LightGBM efficiently screens out factors that have the most significant impact on predicting future returns, thereby enhancing the model’s predictive capability and interpretability.</p><h3 id=45-factor-combination-based-on-bilstm>4.5 Factor Combination Based on BiLSTM<a hidden class=anchor aria-hidden=true href=#45-factor-combination-based-on-bilstm>#</a></h3><p>This subsection uses BiLSTM for factor combination. The specific principles of BiLSTM have been introduced in Chapter 2, so they will not be reiterated here. Below, we describe the specific network structure used. After extensive experimentation, the BiLSTM network structure is set as shown in Table 4.10 and Fig. 12. Between layers, the default tanh and linear activation functions for recurrent neural networks are used. To prevent overfitting, Dropout with a dropout rate of 0.01 is added. However, if the dropout rate is too high, it can lead to underfitting. The BiLSTM recurrent layer has 100 neurons, and the network comprises one BiLSTM layer and three fully connected layers, with a Dropout layer between the BiLSTM layer and the first fully connected layer.</p><h4 id=table-410-bilstm-network-structure>Table 4.10: BiLSTM Network Structure<a hidden class=anchor aria-hidden=true href=#table-410-bilstm-network-structure>#</a></h4><table><thead><tr><th>Layer(type)</th><th>Output Shape</th><th>Param#</th></tr></thead><tbody><tr><td>bidirectional_1 (Bidirectional)</td><td>(None, 100)</td><td>22,400</td></tr><tr><td>dropout_1 (Dropout)</td><td>(None, 100)</td><td>0</td></tr><tr><td>dense_1 (Dense)</td><td>(None, 256)</td><td>25,856</td></tr><tr><td>dropout_2 (Dropout)</td><td>(None, 256)</td><td>0</td></tr><tr><td>dense_2 (Dense)</td><td>(None, 64)</td><td>16,448</td></tr><tr><td>dense_3 (Dense)</td><td>(None, 1)</td><td>0</td></tr></tbody></table><p><strong>Total params</strong>: 66,769<br><strong>Trainable params</strong>: 66,769<br><strong>Non-trainable params</strong>: 0</p><p>Due to the large volume of training data in this experiment, <code>epochs=400</code> and <code>batch_size=1024</code> are selected for the BiLSTM model. The loss function used is Mean Squared Error (MSE), and the optimizer chosen is Stochastic Gradient Descent (SGD). Compared to Gradient Descent (GD), SGD has the advantages of more effectively utilizing information in redundant data, excellent performance in early iterations, and suitability for handling large sample datasets$^{[23]}$. Given the large training data volume, using SGD allows for faster training as it updates with one sample at a time, significantly reducing training time. The default settings in the <code>keras</code> package are used: <code>lr=0.01</code>, <code>momentum=0.0</code>, <code>decay=0.0</code>, and <code>nesterov=False</code>.</p><p><strong>Parameter Descriptions:</strong></p><ul><li><code>lr</code>: Learning rate</li><li><code>momentum</code>: Momentum parameter</li><li><code>decay</code>: Learning rate decay after each update</li><li><code>nesterov</code>: Whether to use Nesterov momentum</li></ul><p>The specific algorithm process of this subsection is as follows:</p><ol><li><strong>Data Usage</strong>: Use one year&rsquo;s worth of data for each stock in the A-share market, consisting of 10 factors selected by LightGBM and the historical return for the next month as features.</li><li><strong>Model Training</strong>: Use the BiLSTM model to train with the selected factors to predict the next month&rsquo;s returns, as shown in Fig. 12.</li></ol><figure class=align-center><img loading=lazy src=Rolling_Window.png#center alt="Fig. 12. Rolling Window"><figcaption><p>Fig. 12. Rolling Window</p></figcaption></figure><ol start=3><li><strong>Prediction</strong>: Apply the trained BiLSTM model to the out-of-sample data of one month to obtain the expected returns for each stock in the next month. The predicted returns are shown in Table 4.11.</li></ol><h5 id=table-411-partial-display-of-predicted-returns-for-stocks>Table 4.11: Partial Display of Predicted Returns for Stocks<a hidden class=anchor aria-hidden=true href=#table-411-partial-display-of-predicted-returns-for-stocks>#</a></h5><table><thead><tr><th>sec_code</th><th>trade_date</th><th>y_hat</th></tr></thead><tbody><tr><td>000001.SZ</td><td>2011/5/26</td><td>0.0424621</td></tr><tr><td>000002.SZ</td><td>2011/5/26</td><td>-0.1632174</td></tr><tr><td>000004.SZ</td><td>2011/5/26</td><td>-0.0642319</td></tr><tr><td>000005.SZ</td><td>2011/5/26</td><td>0.08154649</td></tr><tr><td>000006.SZ</td><td>2011/5/26</td><td>0.00093213</td></tr><tr><td>000007.SZ</td><td>2011/5/26</td><td>-0.073218</td></tr><tr><td>000008.SZ</td><td>2011/5/26</td><td>-0.0464256</td></tr><tr><td>000009.SZ</td><td>2011/5/26</td><td>-0.091549</td></tr><tr><td>000010.SZ</td><td>2011/5/26</td><td>0.08154649</td></tr><tr><td>000011.SZ</td><td>2011/5/26</td><td>-0.1219943</td></tr><tr><td>000012.SZ</td><td>2011/5/26</td><td>-0.1448984</td></tr><tr><td>000014.SZ</td><td>2011/5/26</td><td>0.09038845</td></tr><tr><td>000016.SZ</td><td>2011/5/26</td><td>-0.11225</td></tr></tbody></table><ol start=4><li>Code Implementation Snippet: The following code snippet demonstrates part of the training process used to construct a BiLSTM network.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>build_net_blstm</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span> <span class=o>=</span> <span class=n>ks</span><span class=o>.</span><span class=n>Sequential</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>ks</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Bidirectional</span><span class=p>(</span><span class=n>ks</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>LSTM</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=mi>50</span>
</span></span><span class=line><span class=cl>        <span class=p>),</span><span class=n>input_shape</span><span class=o>=</span><span class=p>(</span><span class=mi>11</span><span class=p>,</span><span class=mi>10</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>ks</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dropout</span><span class=p>(</span><span class=mf>0.01</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>ks</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dense</span><span class=p>(</span><span class=mi>256</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>ks</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dropout</span><span class=p>(</span><span class=mf>0.01</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>ks</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dense</span><span class=p>(</span><span class=mi>64</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>ks</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dense</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>optimizer</span><span class=o>=</span><span class=s1>&#39;sgd&#39;</span><span class=p>,</span> <span class=n>loss</span><span class=o>=</span><span class=s1>&#39;mse&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=n>summary</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>set_model</span><span class=p>(</span><span class=n>model</span><span class=p>)</span>  
</span></span></code></pre></div><h3 id=46-quantitative-strategy-and-strategy-backtesting>4.6 Quantitative Strategy and Strategy Backtesting<a hidden class=anchor aria-hidden=true href=#46-quantitative-strategy-and-strategy-backtesting>#</a></h3><h4 id=461-backtesting-metrics>4.6.1 Backtesting Metrics<a hidden class=anchor aria-hidden=true href=#461-backtesting-metrics>#</a></h4><p>Below are common backtesting metrics used to evaluate the strategy. The metrics include Total Rate of Return, Annualized Rate of Return, Annualized Volatility, Sharpe Ratio, Maximum Drawdown (MDD), Annualized Turnover Rate, and Annualized Transaction Cost Rate, assuming 252 trading days in a year and a risk-free rate of 3.5%. The transaction fee is assumed to be 0.2% per trade.</p><ol><li><strong>Total Rate of Return</strong>: Indicates the cumulative return of the strategy. The higher the cumulative return, the better the strategy&rsquo;s performance. The formula is as follows:</li></ol>$$
\text{Total Rate of Return} = r_{p} = \frac{P_{1} - P_{0}}{P_{0}}
$$<p>Where:</p><ul><li>$P_{1}$: Total value of stocks and cash at the end</li><li>$P_{0}$: Total value of stocks and cash at the beginning</li></ul><ol start=2><li><strong>Annualized Rate of Return</strong>: Converts the total cumulative return into a geometric average return on an annual basis. The higher the annualized return, the better the strategy. The formula is as follows:</li></ol>$$
\text{Annualized Rate of Return} = R_{p} = \left(1 + r_{p}\right)^{\frac{252}{t}} - 1
$$<p>Where:</p><ul><li>$r_{p}$: Total rate of return</li><li>$t$: Number of trading days the strategy is executed</li></ul><ol start=3><li><strong>Annualized Volatility</strong>: Defined as the standard deviation of the logarithm of the asset’s annual return rates. It measures the risk of the strategy, with higher volatility indicating higher risk. The formula is as follows:</li></ol>$$
\begin{aligned}
\text{Annualized volatility} = \sigma_{p} &= \sqrt{\frac{252}{t-1} \sum_{i=1}^{t}\left(r_{d} - \bar{r}_{d}\right)^{2}} \\
\bar{r}_{d} &= \frac{1}{t} \sum_{i=1}^{t} r_{d_{i}}
\end{aligned}
$$<p>Where:</p><ul><li>$r_{d_{i}}$: Daily return on the $i$-th day</li><li>$\bar{r}_{d}$: Daily average return</li><li>$t$: Number of trading days the strategy is executed</li></ul><ol start=4><li><strong>Sharpe Ratio</strong>: Proposed by <a href=https://doi.org/10.2307/2328485>Sharpe (1966)</a>$^{[24]}$, it represents the excess return per unit of risk. Here, the annualized Sharpe ratio is calculated as follows:</li></ol>$$
S = \frac{R_{p} - R_{f}}{\sigma_{p}}
$$<p>Where:</p><ul><li>$R_{p}$: Annualized rate of return</li><li>$R_{f}$: Risk-free rate</li><li>$\sigma_{p}$: Annualized volatility</li></ul><ol start=5><li><strong>Maximum Drawdown (MDD)</strong>: Represents the maximum decline in the total value of stocks and cash during the strategy’s execution period. It measures the most extreme potential loss scenario of the strategy.</li></ol>$$
MDD = \frac{\max \left(V_{x} - V_{y}\right)}{V_{x}}
$$<p>Where:</p><ul><li>$V_{x}$ and $V_{y}$ are the total values of stocks and cash on day $x$ and day $y$, respectively, with $x &lt; y$.</li></ul><ol start=6><li><strong>Annualized Turnover Rate</strong>: Measures the frequency of buying and selling stocks within the investment portfolio. A higher turnover rate indicates more frequent rebalancing and higher transaction costs.</li></ol>$$
\text{Change} = \frac{N \times 252}{t}
$$<p>Where:</p><ul><li>$t$: Number of trading days the strategy is executed</li><li>$N$: Total number of buy and sell operations</li></ul><ol start=7><li><strong>Annualized Transaction Cost Rate</strong>: Measures the transaction costs of the investment portfolio strategy, with higher values indicating higher transaction costs.</li></ol>$$
c = \left(1 + \text{commission}\right)^{\text{change}} - 1
$$<p>Where:</p><ul><li>Change: Annualized turnover rate</li><li>Commission: Transaction fee rate</li></ul><h4 id=462-strategy-and-backtesting-results>4.6.2 Strategy and Backtesting Results<a hidden class=anchor aria-hidden=true href=#462-strategy-and-backtesting-results>#</a></h4><p>This paper adopts a quantitative trading strategy that rebalances the portfolio every month (i.e., a rebalancing period of 28 trading days). Each rebalance involves equally weighting the top 25 stocks with the highest expected returns predicted by BiLSTM and selling the previously held stocks. The backtesting period and rules are as follows:</p><ol><li><strong>Backtesting Period</strong>: From January 2012 to October 2020.</li><li><strong>Backtesting Stock Pool</strong>: All A-share stocks, excluding Special Treatment (ST) stocks.</li><li><strong>Transaction Fees</strong>: A trading commission of 0.2% is paid to brokers upon buying and selling, with a minimum commission of 5 yuan per trade if the calculated fee is less than 5 yuan.</li><li><strong>Trading Rules</strong>: Stocks hitting the daily limit-up cannot be bought, and stocks hitting the daily limit-down cannot be sold on the same day.</li></ol><h5 id=table-412-strategy-backtesting-results>Table 4.12: Strategy Backtesting Results<a hidden class=anchor aria-hidden=true href=#table-412-strategy-backtesting-results>#</a></h5><table><thead><tr><th></th><th>Total Rate of Return</th><th>Annualized Rate of Return</th><th>Annualized Volatility</th><th>Sharpe Ratio</th><th>Maximum Drawdown</th><th>Annualized Turnover Rate</th><th>Annualized Transaction Cost Rate</th></tr></thead><tbody><tr><td><strong>Strategy</strong></td><td>701.00%</td><td>29.18%</td><td>33.44%</td><td>0.77</td><td>51.10%</td><td>51.10%</td><td>11.35%</td></tr><tr><td><strong>Benchmark</strong></td><td>110.40%</td><td>9.70%</td><td>26.01%</td><td>0.24</td><td>58.49%</td><td>58.49%</td><td>0.00%</td></tr></tbody></table><figure class=align-center><img loading=lazy src=res.png#center alt="Fig. 22. Net Profit Curve"><figcaption><p>Fig. 22. Net Profit Curve</p></figcaption></figure><p>The backtesting results are shown in Table 4.12 and Fig. 22. The strategy employed is the LightGBM-BiLSTM quantitative strategy introduced in this chapter. The benchmark used is the CSI All Share Index (000985). From the results, the strategy achieves a cumulative return of 701.00%, significantly higher than the benchmark’s 110.40%. The annualized return is 29.18%, far exceeding the benchmark’s 9.70%. The Sharpe ratio is 0.77, which is higher than the benchmark’s 0.24. These three backtesting metrics indicate that the LightGBM-BiLSTM quantitative strategy indeed provides greater returns to investors, demonstrating the effectiveness of using deep learning to construct quantitative investment strategies. The strategy’s annualized volatility is 33.44%, higher than the benchmark’s 26.01%, and the maximum drawdown is 51.10%, lower than the benchmark’s 58.49%. These two metrics indicate that the LightGBM-BiLSTM quantitative strategy carries certain risks, particularly in resisting systemic risk shocks. The annualized turnover rate is 11.35%, and the annualized transaction cost rate is 2.29%, indicating that the strategy is not a high-frequency trading strategy with relatively low transaction costs. The return curve shows that the LightGBM-BiLSTM quantitative strategy’s returns were similar to the benchmark in the first two years without notable advantages. However, starting around April 2015, the strategy’s returns clearly outperformed the benchmark. Overall, the LightGBM-BiLSTM quantitative strategy delivers substantial returns but still carries certain risks.</p><h2 id=chapter-5-conclusion-and-outlook>Chapter 5: Conclusion and Outlook<a hidden class=anchor aria-hidden=true href=#chapter-5-conclusion-and-outlook>#</a></h2><h3 id=51-conclusion>5.1 Conclusion<a hidden class=anchor aria-hidden=true href=#51-conclusion>#</a></h3><p>This paper first introduced the research background and significance of deep learning-based stock price prediction and quantitative investment strategy research. It then reviewed the current domestic and international research status of stock price prediction and quantitative investment strategies, outlined the innovations of this paper, and presented the research framework. Next, the theoretical foundations chapter briefly introduced the deep learning models and the development history of quantitative investment used in this paper, with a focus on the basic structures, principles, and characteristics of LSTM, GRU, and BiLSTM models.</p><p>Subsequently, using daily data from Pudong Bank and IBM, the paper conducted a series of data processing steps and feature extraction for data preprocessing. It then detailed the network structures and hyperparameter settings of the LSTM, GRU, and BiLSTM models used in the experiments. The study used LSTM, GRU, and BiLSTM to predict the closing prices of the two stocks and compared the models’ performance. The experimental results showed that the BiLSTM model achieved higher prediction accuracy for both stocks.</p><p>Finally, to further demonstrate BiLSTM’s application value in finance, this paper constructed a LightGBM-BiLSTM-based quantitative investment model. It selected and cleaned multiple factors from the entire A-share market data, employed LightGBM for factor selection, and used BiLSTM for factor combination. The paper then constructed a quantitative investment strategy based on the model and compared it against the CSI All Share Index using metrics such as cumulative return, annualized return, annualized volatility, and Sharpe ratio. The comparison showed that the LightGBM-BiLSTM quantitative investment model achieved better returns, indicating the effectiveness of using deep learning to build quantitative investment strategies.</p><h3 id=52-outlook>5.2 Outlook<a hidden class=anchor aria-hidden=true href=#52-outlook>#</a></h3><p>Although this paper compared the performance of LSTM, GRU, and BiLSTM models in predicting stock closing prices and achieved certain results with the LightGBM-BiLSTM quantitative investment strategy, there are still some shortcomings. Based on the research outcomes of this paper, the following areas can be further explored and improved:</p><ol><li><p><strong>Diverse Prediction Targets</strong>: This paper focuses on predicting stock closing prices, which, while intuitive, is challenging and less interpretable under the Random Walk Hypothesis (RWH) proposed by <a href=http://www.numdam.org/item/ASENS_1900_3_17__21_0/>Bachelier (1900)</a>$^{[26]}$, which posits that stock prices follow a random walk and are unpredictable. Although behavioral economists have shown that this hypothesis is not entirely correct, it indicates that simply predicting stock closing prices is difficult and less interpretable$^{[27][28]}$. Therefore, future research can explore predicting stock volatility, stock price movements (up or down), and stock returns.</p></li><li><p><strong>Diverse Model Comparisons</strong>: This paper compared LSTM, GRU, and BiLSTM models in predicting stock prices, demonstrating that BiLSTM achieves better accuracy. However, it lacks comparisons with other diverse models. Future research can delve into comparing single or hybrid models like ARIMA, Convolutional Neural Networks (CNN), Deep Neural Networks (DNN), CNN-LSTM, Transformer, and TimeGPT.</p></li><li><p><strong>Diverse Factor Selection</strong>: The factors used in constructing the quantitative investment strategy in this paper are primarily technical price and volume factors, with a limited variety. Future research can incorporate financial factors, sentiment factors, growth factors, and other types of factors to enhance the strategy’s performance. Additionally, incorporating timing strategies—such as increasing positions when the market is predicted to rise and decreasing positions when the market is predicted to fall—can capture beta ($\beta$) returns.</p></li><li><p><strong>Investment Portfolio Optimization</strong>: The factor combination process in this paper remains imperfect. Future research can utilize quadratic programming methods to optimize the investment portfolio.</p></li><li><p><strong>High-Frequency Trading Strategy Research</strong>: The quantitative investment strategy in this paper adopts a low-frequency trading approach. Future research can leverage tick data to explore high-frequency and ultra-high-frequency trading strategies.</p></li></ol><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><p>[1] White, H. <a href=https://pages.cs.wisc.edu/~dyer/cs540/handouts/deep-learning-nature2015.pdf>“Economic prediction using neural networks: The case of IBM daily stock returns.”</a> <em>Proc. of ICNN</em>. 1988, 2: 451-458.</p><p>[2] Kimoto, T., Asakawa, K., Yoda, M., et al. <a href=https://web.ist.utl.pt/adriano.simoes/tese/referencias/Papers%20-%20Adriano/NN.pdf>“Stock market prediction system with modular neural networks.”</a> <em>Proc. of 1990 IJCNN International Joint Conference on Neural Networks</em>. IEEE, 1990: 1-6.</p><p>[3] Zhang, G. P. <a href=https://dl.icdst.org/pdfs/files/2c442c738bd6bc178e715f400bec5d5f.pdf>“Time series forecasting using a hybrid ARIMA and neural network model.”</a> <em>Neurocomputing</em>. 2003, 50: 159-175.</p><p>[4] Akita, R., Yoshihara, A., Matsubara, T., et al. <a href=https://ieeexplore.ieee.org/document/7550882>“Deep learning for stock prediction using numerical and textual information.”</a> <em>Proc. of 2016 IEEE/ACIS 15th International Conference on Computer and Information Science (ICIS)</em>. IEEE, 2016: 1-6.</p><p>[5] 宮崎邦洋, 松尾豊. <a href=https://www.ai-gakkai.or.jp/jsai2017/webprogram/2017/pdf/1112.pdf>“Deep Learning を用いた株価予測の分析.”</a> <em>人工知能学会全国大会論文集 第31回全国大会</em>. 一般社団法人 人工知能学会, 2017: 2D3OS19a3-2D3OS19a3.</p><p>[6] Kim, T., Kim, H. Y. <a href="https://journals.plos.org/plosone/article/file?id=10.1371/journal.pone.0212320&amp;type=printable">“Forecasting stock prices with a feature fusion LSTM-CNN model using different representations of the same data.”</a> <em>PLoS ONE</em>. 2019, 14(2): e0212320.</p><p>[7] Hochreiter, S., Schmidhuber, J. <a href=https://www.bioinf.jku.at/publications/older/2604.pdf>“Long short-term memory.”</a> <em>Neural Computation</em>. 1997, 9(8): 1735-1780.</p><p>[8] Cho, K., Van Merriënboer, B., Gulcehre, C., et al. <a href=https://arxiv.org/abs/1406.1078>“Learning phrase representations using RNN encoder-decoder for statistical machine translation.”</a> <em>arXiv preprint arXiv:1406.1078</em>. 2014.</p><p>[9] Chung, J., Gulcehre, C., Cho, K. H., et al. <a href=https://arxiv.org/abs/1412.3555>“Empirical evaluation of gated recurrent neural networks on sequence modeling.”</a> <em>arXiv preprint arXiv:1412.3555</em>. 2014.</p><p>[10] Gruber, N., Jockisch, A. <a href=https://www.frontiersin.org/journals/artificial-intelligence/articles/10.3389/frai.2020.00040/full>“Are GRU cells more specific and LSTM cells more sensitive in motive classification of text?”</a> <em>Frontiers in Artificial Intelligence</em>. 2020, 3(40): 1-6.</p><p>[11] Markowitz, H. <a href=https://www.jstor.org/stable/2975974>“Portfolio Selection.”</a> <em>The Journal of Finance</em>. 1952, 7(1): 77-91. doi:10.2307/2975974.</p><p>[12] Merton, R. C. <a href=https://www.jstor.org/stable/2329621>“An analytic derivation of the efficient portfolio frontier.”</a> <em>Journal of Financial and Quantitative Analysis</em>. 1972: 1851-1872.</p><p>[13] Sharpe, W. F. <a href=https://www.jstor.org/stable/2977928>“Capital asset prices: A theory of market equilibrium under conditions of risk.”</a> <em>The Journal of Finance</em>. 1964, 19(3): 425-442.</p><p>[14] Lintner, J. <a href=https://www.jstor.org/stable/1924119>“The Valuation of Risk Assets and the Selection of Risky Investments in Stock Portfolios and Capital Budgets.”</a> <em>Review of Economics and Statistics</em>. 1965, 47(1): 13-37.</p><p>[15] Mossin, J. <a href=https://www.jstor.org/stable/1910098>“Equilibrium in a capital asset market.”</a> <em>Econometrica: Journal of the Econometric Society</em>. 1966: 768-783.</p><p>[16] Ross, S. A. <a href=https://www.top1000funds.com/wp-content/uploads/2014/05/The-Arbitrage-Theory-of-Capital-Asset-Pricing.pdf>“The arbitrage theory of capital asset pricing.”</a> <em>Journal of Economic Theory</em>. 1976, 13(3): 341-60.</p><p>[17] Fama, E. F., French, K. R. <a href=https://www.bauer.uh.edu/rsusmel/phd/Fama-French_JFE93.pdf>“Common risk factors in the returns on stocks and bonds.”</a> <em>Journal of Financial Economics</em>. 1993, 33(1): 3-56.</p><p>[18] Fama, E. F., French, K. R. <a href=https://tevgeniou.github.io/EquityRiskFactors/bibliography/FiveFactor.pdf>“A five-factor asset pricing model.”</a> <em>Journal of Financial Economics</em>. 2015, 116(1): 1-22.</p><p>[19] Kingma, D. P., Ba, J. <a href=https://arxiv.org/abs/1412.6980>“Adam: A method for stochastic optimization.”</a> <em>arXiv preprint arXiv:1412.6980</em>. 2014.</p><p>[20] Friedman, J. H. <a href=https://www.jstor.org/stable/2699986>“Greedy function approximation: A gradient boosting machine.”</a> <em>Annals of Statistics</em>. 2001: 1189-1232.</p><p>[21] Kopitar, L., Kocbek, P., Cilar, L., et al. <a href=https://www.nature.com/articles/s41598-020-68771-z>“Early detection of type 2 diabetes mellitus using machine learning-based prediction models.”</a> <em>Scientific Reports</em>. 2020, 10(1): 1-12.</p><p>[22] Ke, G., Meng, Q., Finley, T., et al. <a href=https://proceedings.neurips.cc/paper_files/paper/2017/file/6449f44a102fde848669bdd9eb6b76fa-Paper.pdf>“Lightgbm: A highly efficient gradient boosting decision tree.”</a> <em>Advances in Neural Information Processing Systems</em>. 2017, 30: 3146-3154.</p><p>[23] Bottou, L., Curtis, F. E., Nocedal, J. <a href=https://coral.ise.lehigh.edu/frankecurtis/files/papers/BottCurtNoce18.pdf>“Optimization methods for large-scale machine learning.”</a> <em>SIAM Review</em>. 2018, 60(2): 223-311.</p><p>[24] Sharpe, W. F. <a href=https://finance.martinsewell.com/fund-performance/Sharpe1966.pdf>“Mutual fund performance.”</a> <em>The Journal of Business</em>. 1966, 39(1): 119-138.</p><p>[25] Sharpe, W. F. <a href=https://web.stanford.edu/~wfsharpe/art/sr/sr.htm>“The sharpe ratio.”</a> <em>Journal of Portfolio Management</em>. 1994, 21(1): 49-58.</p><p>[26] Bachelier, L. <a href=http://www.numdam.org/item/ASENS_1900_3_17__21_0/>“Théorie de la spéculation.”</a> <em>Annales Scientifiques de l&rsquo;École Normale Supérieure</em>. 1900, 17: 21-86.</p><p>[27] Fromlet, H. <a href=https://www.jstor.org/stable/23488166>“Behavioral finance-theory and practical application: Systematic analysis of departures from the homo oeconomicus paradigm are essential for realistic financial research and analysis.”</a> <em>Business Economics</em>. 2001: 63-69.</p><p>[28] Lo, A. W. <a href=https://www.pm-research.com/content/iijpormgmt/30/5/15>“The adaptive markets hypothesis.”</a> <em>The Journal of Portfolio Management</em>. 2004, 30(5): 15-29.</p><h3 id=reference-blogs>Reference Blogs<a hidden class=anchor aria-hidden=true href=#reference-blogs>#</a></h3><ul><li>Colah&rsquo;s Blog. (2015, August 27). <a href=https://colah.github.io/posts/2015-08-Understanding-LSTMs/><em>Understanding LSTM Networks.</em></a></li></ul><h2 id=citation>Citation<a hidden class=anchor aria-hidden=true href=#citation>#</a></h2><blockquote><p><strong>Citation</strong>: If you wish to share or reference this content, please credit the original author and source.</p></blockquote><p><strong>Cited as:</strong></p><p>Yue Shui. (Apr 2021). Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning.<br><a href=https://syhya.github.io/posts/2021-04-21-deep-learning-stock-prediction/>https://syhya.github.io/posts/2021-04-21-deep-learning-stock-prediction/</a></p><p>Or</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bibtex data-lang=bibtex><span class=line><span class=cl><span class=nc>@article</span><span class=p>{</span><span class=nl>syhya2021stockprediction</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=na>title</span>   <span class=p>=</span> <span class=s>&#34;Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=na>author</span>  <span class=p>=</span> <span class=s>&#34;Yue Shui&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=na>journal</span> <span class=p>=</span> <span class=s>&#34;syhya.github.io&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=na>year</span>    <span class=p>=</span> <span class=s>&#34;2021&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=na>month</span>   <span class=p>=</span> <span class=s>&#34;Apr&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=na>url</span>     <span class=p>=</span> <span class=s>&#34;https://syhya.github.io/posts/2021-04-21-deep-learning-stock-prediction/&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://syhya.github.io/tags/deep-learning/>Deep Learning</a></li><li><a href=https://syhya.github.io/tags/ai/>AI</a></li><li><a href=https://syhya.github.io/tags/rnn/>RNN</a></li><li><a href=https://syhya.github.io/tags/lstm/>LSTM</a></li><li><a href=https://syhya.github.io/tags/bilstm/>BiLSTM</a></li><li><a href=https://syhya.github.io/tags/gru/>GRU</a></li><li><a href=https://syhya.github.io/tags/lightgbm/>LightGBM</a></li><li><a href=https://syhya.github.io/tags/neural-networks/>Neural Networks</a></li><li><a href=https://syhya.github.io/tags/stock-prediction/>Stock Prediction</a></li><li><a href=https://syhya.github.io/tags/financial-modeling/>Financial Modeling</a></li><li><a href=https://syhya.github.io/tags/machine-learning/>Machine Learning</a></li><li><a href=https://syhya.github.io/tags/quantitative-investment/>Quantitative Investment</a></li><li><a href=https://syhya.github.io/tags/portfolio-management/>Portfolio Management</a></li><li><a href=https://syhya.github.io/tags/financial-engineering/>Financial Engineering</a></li><li><a href=https://syhya.github.io/tags/algorithmic-trading/>Algorithmic Trading</a></li><li><a href=https://syhya.github.io/tags/time-series/>Time Series</a></li></ul><nav class=paginav><a class=prev href=https://syhya.github.io/posts/2024-12-21-build-gpu-server/><span class=title>« Prev</span><br><span>Building a Home Deep Learning Rig with Dual RTX 4090 GPUs</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning on x" href="https://x.com/intent/tweet/?text=Research%20on%20Stock%20Price%20Prediction%20and%20Quantitative%20Strategies%20Based%20on%20Deep%20Learning&amp;url=https%3a%2f%2fsyhya.github.io%2fposts%2f2021-04-21-deep-learning-stock-prediction%2f&amp;hashtags=Deeplearning%2cAI%2cRNN%2cLSTM%2cBiLSTM%2cGRU%2cLightGBM%2cNeuralNetworks%2cStockPrediction%2cFinancialModeling%2cMachineLearning%2cQuantitativeInvestment%2cPortfolioManagement%2cFinancialEngineering%2cAlgorithmicTrading%2cTimeSeries"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsyhya.github.io%2fposts%2f2021-04-21-deep-learning-stock-prediction%2f&amp;title=Research%20on%20Stock%20Price%20Prediction%20and%20Quantitative%20Strategies%20Based%20on%20Deep%20Learning&amp;summary=Research%20on%20Stock%20Price%20Prediction%20and%20Quantitative%20Strategies%20Based%20on%20Deep%20Learning&amp;source=https%3a%2f%2fsyhya.github.io%2fposts%2f2021-04-21-deep-learning-stock-prediction%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fsyhya.github.io%2fposts%2f2021-04-21-deep-learning-stock-prediction%2f&title=Research%20on%20Stock%20Price%20Prediction%20and%20Quantitative%20Strategies%20Based%20on%20Deep%20Learning"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsyhya.github.io%2fposts%2f2021-04-21-deep-learning-stock-prediction%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning on whatsapp" href="https://api.whatsapp.com/send?text=Research%20on%20Stock%20Price%20Prediction%20and%20Quantitative%20Strategies%20Based%20on%20Deep%20Learning%20-%20https%3a%2f%2fsyhya.github.io%2fposts%2f2021-04-21-deep-learning-stock-prediction%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning on telegram" href="https://telegram.me/share/url?text=Research%20on%20Stock%20Price%20Prediction%20and%20Quantitative%20Strategies%20Based%20on%20Deep%20Learning&amp;url=https%3a%2f%2fsyhya.github.io%2fposts%2f2021-04-21-deep-learning-stock-prediction%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Research on Stock Price Prediction and Quantitative Strategies Based on Deep Learning on ycombinator" href="https://news.ycombinator.com/submitlink?t=Research%20on%20Stock%20Price%20Prediction%20and%20Quantitative%20Strategies%20Based%20on%20Deep%20Learning&u=https%3a%2f%2fsyhya.github.io%2fposts%2f2021-04-21-deep-learning-stock-prediction%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://syhya.github.io/>Yue Shui Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>